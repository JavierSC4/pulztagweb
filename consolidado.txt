----- Inicio de migrations/alembic.ini -----
# A generic, single database configuration.

[alembic]
# template used to generate migration files
# file_template = %%(rev)s_%%(slug)s

# set to 'true' to run the environment during
# the 'revision' command, regardless of autogenerate
# revision_environment = false


# Logging configuration
[loggers]
keys = root,sqlalchemy,alembic,flask_migrate

[handlers]
keys = console

[formatters]
keys = generic

[logger_root]
level = WARN
handlers = console
qualname =

[logger_sqlalchemy]
level = WARN
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
level = INFO
handlers =
qualname = alembic

[logger_flask_migrate]
level = INFO
handlers =
qualname = flask_migrate

[handler_console]
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S


----- Fin de migrations/alembic.ini -----

----- Inicio de migrations/env.py -----
import logging
from logging.config import fileConfig

from flask import current_app

from alembic import context

# this is the Alembic Config object, which provides
# access to the values within the .ini file in use.
config = context.config

# Interpret the config file for Python logging.
# This line sets up loggers basically.
fileConfig(config.config_file_name)
logger = logging.getLogger('alembic.env')


def get_engine():
    try:
        # this works with Flask-SQLAlchemy<3 and Alchemical
        return current_app.extensions['migrate'].db.get_engine()
    except (TypeError, AttributeError):
        # this works with Flask-SQLAlchemy>=3
        return current_app.extensions['migrate'].db.engine


def get_engine_url():
    try:
        return get_engine().url.render_as_string(hide_password=False).replace(
            '%', '%%')
    except AttributeError:
        return str(get_engine().url).replace('%', '%%')


# add your model's MetaData object here
# for 'autogenerate' support
# from myapp import mymodel
# target_metadata = mymodel.Base.metadata
config.set_main_option('sqlalchemy.url', get_engine_url())
target_db = current_app.extensions['migrate'].db

# other values from the config, defined by the needs of env.py,
# can be acquired:
# my_important_option = config.get_main_option("my_important_option")
# ... etc.


def get_metadata():
    if hasattr(target_db, 'metadatas'):
        return target_db.metadatas[None]
    return target_db.metadata


def run_migrations_offline():
    """Run migrations in 'offline' mode.

    This configures the context with just a URL
    and not an Engine, though an Engine is acceptable
    here as well.  By skipping the Engine creation
    we don't even need a DBAPI to be available.

    Calls to context.execute() here emit the given string to the
    script output.

    """
    url = config.get_main_option("sqlalchemy.url")
    context.configure(
        url=url, target_metadata=get_metadata(), literal_binds=True
    )

    with context.begin_transaction():
        context.run_migrations()


def run_migrations_online():
    """Run migrations in 'online' mode.

    In this scenario we need to create an Engine
    and associate a connection with the context.

    """

    # this callback is used to prevent an auto-migration from being generated
    # when there are no changes to the schema
    # reference: http://alembic.zzzcomputing.com/en/latest/cookbook.html
    def process_revision_directives(context, revision, directives):
        if getattr(config.cmd_opts, 'autogenerate', False):
            script = directives[0]
            if script.upgrade_ops.is_empty():
                directives[:] = []
                logger.info('No changes in schema detected.')

    conf_args = current_app.extensions['migrate'].configure_args
    if conf_args.get("process_revision_directives") is None:
        conf_args["process_revision_directives"] = process_revision_directives

    connectable = get_engine()

    with connectable.connect() as connection:
        context.configure(
            connection=connection,
            target_metadata=get_metadata(),
            **conf_args
        )

        with context.begin_transaction():
            context.run_migrations()


if context.is_offline_mode():
    run_migrations_offline()
else:
    run_migrations_online()


----- Fin de migrations/env.py -----

----- Inicio de migrations/script.py.mako -----
"""${message}

Revision ID: ${up_revision}
Revises: ${down_revision | comma,n}
Create Date: ${create_date}

"""
from alembic import op
import sqlalchemy as sa
${imports if imports else ""}

# revision identifiers, used by Alembic.
revision = ${repr(up_revision)}
down_revision = ${repr(down_revision)}
branch_labels = ${repr(branch_labels)}
depends_on = ${repr(depends_on)}


def upgrade():
    ${upgrades if upgrades else "pass"}


def downgrade():
    ${downgrades if downgrades else "pass"}


----- Fin de migrations/script.py.mako -----

----- Inicio de static/css/style.css -----
/****************************************************************************/
/* 1. RESETEO / CONFIGURACIONES GLOBALES */
/****************************************************************************/
html, body {
    height: 100%;
    margin: 0;
    padding: 0;
}

/* Definición de fondo por defecto para dispositivos móviles */
body {
    background-image: url("/static/images/bg2.jpg");
    background-size: cover;
    background-attachment: scroll; /* Evita 'fixed' en móviles */
    background-position: center;
    font-family: 'Roboto', sans-serif; /* Fuente base */
}

/* Sobrescribe la imagen de fondo para pantallas más grandes (desktops y tablets) */
@media (min-width: 768px) {
    body {
        background-image: url("/static/images/bg2.jpg");
        background-attachment: fixed; /* Solo aplica 'fixed' en pantallas grandes */
        background-position: center;
    }
}

/****************************************************************************/
/* 2. TIPOGRAFÍAS Y ENCABEZADOS */
/****************************************************************************/
h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: 'Montserrat', sans-serif;
    color: #2F2C2C;
}

/* Títulos y subtítulos usados en secciones hero o jumbotron */
.title {
    font-size: 3.6rem;
    font-weight: bold;
    color: #ffffff;
    text-align: left;
    margin-bottom: 1rem;
}

.subtitle {
    font-size: 1.5rem;
    font-weight: 400;
    color: #ffffff;
    text-align: left;
    line-height: 1.5;
    margin-bottom: 2rem;
}

.titulo-seccion {
    font-size: 2.5em;
    font-weight: bold;
    color: #2c6682;
    text-align: center;
    margin-top: 25px;
    margin-bottom: 45px;
}

/* Solo para la página o sección de login */
.login-hero {
    min-height: 70vh; /* Ajusta este valor según desees */
    height: auto;     /* Para que crezca según contenido */
}

.login-row {
    min-height: auto;
    /* O si quieres darle un poco de margen vertical... */
    padding-top: 5rem;
    padding-bottom: 5rem;
}

/****************************************************************************/
/* 3. EFECTOS DE ZOOM, CARDS, SERVICIOS */
/****************************************************************************/
/* Efecto general de zoom */
.zoom-effect {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border-radius: 10px;
}
.zoom-effect:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

/* Tarjetas de servicio con efecto de zoom */
.service-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    border: none;
    border-radius: 10px;
    background-color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.service-card:hover {
    transform: scale(1.05);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

/* Tarjetas de aplicación */
.application-card {
    transition: transform 0.3s, box-shadow 0.3s;
    border: none;
    border-radius: 10px;
    background-color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.application-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}
.application-card .card-title {
    color: #03c0ff;
    font-weight: 600;
}
.application-card .card-text {
    color: #555555;
}

/* Zoom de iconos en tarjetas */
.service-card i {
    color: #03c0ff;
    transition: color 0.3s;
}
.service-card:hover i {
    color: #0290b8;
}

/****************************************************************************/
/* 4. NAVBAR */
/****************************************************************************/
.navbar {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.navbar-brand {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.8rem;
    display: flex;
    align-items: center;
}
.navbar-brand img {
    margin-right: 10px;
}

.nav-link {
    color: #555555 !important;
    transition: color 0.3s, transform 0.3s, background-color 0.3s;
    font-size: 1.1rem;
    padding: 0.5rem 1rem;
    border-radius: 8px;
    position: relative;
}
.nav-link::after {
    content: '';
    position: absolute;
    width: 0%;
    height: 1px;
    background-color: #797979;
    left: 0;
    bottom: 0;
    transition: width 0.3s;
}
.nav-link:hover::after {
    width: 100%;
}
.nav-link:hover {
    color: #03B8FF !important;
    transform: translateY(-2px);
    background-color: rgba(3, 192, 255, 0.1);
}
.nav-link.active {
    color: #03c0ff !important;
    font-weight: 600;
    background-color: rgba(3, 192, 255, 0.2);
    border-bottom: 3px solid #03c0ff;
}

/* Dropdown Menús */
.dropdown-menu {
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}
.dropdown-item {
    transition: background-color 0.3s, color 0.3s;
}
.dropdown-item:hover {
    background-color: #03c0ff;
    color: #ffffff;
}

/* Responsividad de la navbar */
@media (max-width: 992px) {
    .nav-link {
        font-size: 1rem;
        padding: 0.5rem;
    }
}

/* Ajustes navbar-light */
.navbar-light .navbar-nav .nav-link {
    color: #555555;
}
.navbar-light .navbar-nav .nav-link.active {
    color: #03c0ff;
}
.navbar-light .navbar-nav .nav-link:hover {
    color: #03c0ff;
}

/* Iconos en la navegación */
.nav-link i {
    font-size: 1.1rem;
    vertical-align: middle;
}

/****************************************************************************/
/* 5. FOOTER */
/****************************************************************************/
footer {
    background-color: #f1f1f1;
    color: #555555;
}
footer a {
    color: #03c0ff;
    text-decoration: none;
}
footer a:hover {
    text-decoration: underline;
}
footer .container {
    max-width: 1200px;
}
footer div {
    display: flex;
    align-items: center;
}

/****************************************************************************/
/* 6. BOTONES */
/****************************************************************************/
.btn-primary {
    background-color: #03B8FF;
    border-color: #0b396dbd;
}
.btn-primary:hover {
    background-color: #02a8d1;
    border-color: #03FFFB;
}

/* Botones personalizados */
.btn-custom-white {
    background: linear-gradient(to bottom, #9cd6fd, transparent);
    color: #ffffff;
    border: 2px solid #ffffff;
    transition: background 0.3s, color 0.3s;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 4px;
}
.btn-custom-white:hover {
    background-color: #fede9d;
    color: #ffffff;
    border-color: #93f66f;
}
.btn-icon {
    padding: 0.5rem;
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

/* Botones outline (Agregar Contacto, Compartir URL) */
.btn-outline-primary {
    border-color: #03c0ff;
    color: #03c0ff;
}
.btn-outline-primary:hover {
    background-color: #e0f7ff;
    color: #0290b8;
    border-color: #0290b8;
}
.btn-outline-secondary {
    border-color: #03c0ff;
    color: #03c0ff;
}
.btn-outline-secondary:hover {
    background-color: #e0f7ff;
    color: #0290b8;
    border-color: #0290b8;
}

/****************************************************************************/
/* 7. FORMULARIOS, ALERTAS Y MENSAJES */
/****************************************************************************/
.form-control {
    border-radius: 0.3rem;
    border: 1px solid #ced4da;
}
.form-control:focus {
    border-color: #03c0ff;
    box-shadow: none;
}
form .form-control {
    margin-bottom: 1.5rem;
}
form .form-check {
    margin-bottom: 1rem;
}
form .btn {
    padding: 0.5rem 1.5rem;
}
.form-title,
.form-subtitle {
    color: #03c0ff;
}
.form-check-label {
    margin-left: 0.5rem;
}

/* Botón de eliminación con ícono */
form button {
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0;
    padding: 0.25rem 0.75rem;
    background-color: #dc3545;
    color: white;
    border: none;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    cursor: pointer;
    transition: background-color 0.3s ease-in-out;
}
form button i {
    margin: 0;
    font-size: 1rem;
    color: white;
}
form button:hover {
    background-color: #c82333;
}

/* Alertas y mensajes flash */
.alert {
    margin-top: 20px;
}
.alert-success {
    background-color: #d4edda;
    color: #155724;
    border-color: #c3e6cb;
}
.alert-danger {
    background-color: #f8d7da;
    color: #721c24;
    border-color: #f5c6cb;
}
.text-danger {
    font-size: 0.9rem;
}
.text-muted {
    color: #a7a7a7 !important;
}

/****************************************************************************/
/* 8. JUMBOTRON, PRICE, SERVICE-BACKGROUND */
/****************************************************************************/
.jumbotron {
    background: linear-gradient(135deg, #ffffff 0%, #e6f7ff 100%);
    padding: 4rem 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}
.jumbotron h1 {
    color: #03c0ff;
}
.jumbotron p {
    color: #555555;
}

/* Fondo para secciones de servicio */
.service-background {
    background: linear-gradient(135deg, #ffffff 0%, #ffffff 100%);
    padding: 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    transition: background 0.3s ease;
}

/* Texto de precio */
.price {
    font-size: 1.5rem;
    font-weight: bold;
    color: #333333;
    transition: color 0.3s ease;
    text-align: center;
}
.price:hover {
    color: #555555;
}

/****************************************************************************/
/* 9. CARDS GENERALES */
/****************************************************************************/
.card {
    border: none;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s, box-shadow 0.3s;
    animation: fadeInUp 0.5s ease forwards;
}
.card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}
.card-title {
    color: #103141d3;
    font-family: 'Montserrat', sans-serif;
    font-size: 1.5rem;
}

/****************************************************************************/
/* 10. LINKS Y EFECTOS DE HOVER */
/****************************************************************************/
a {
    color: #03c0ff;
    transition: color 0.3s;
}
a:hover {
    color: #0290b8;
    text-decoration: none;
}

/****************************************************************************/
/* 11. LISTAS, ARCHIVOS Y VARIOS */
/****************************************************************************/
/* Para list-group en carga de archivos */
.list-group-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.list-group-item button {
    margin-left: 10px;
    background: none;
    border: none;
    color: #ff4d4d;
    cursor: pointer;
    text-decoration: underline;
    padding: 0;
    font-size: 0.9rem;
}
.list-group-item button:hover {
    color: #cc0000;
}

/****************************************************************************/
/* 12. SOLUCIONES PERSONALIZADAS, CTA, ABOUT */
/****************************************************************************/
.custom-solutions-section {
    background: linear-gradient(135deg, #03c0ff 0%, #03c0ff 100%);
    color: #fff;
    padding: 40px;
    border-radius: 15px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.custom-solutions-section h4 {
    font-size: 2.5rem;
    margin-bottom: 20px;
}
.solutions-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
}
.solution-item {
    flex: 1 1 220px;
    margin: 10px;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

/* Sección CTA */
.cta-section {
    background-image: linear-gradient(135deg, #2f212b00 0%, #0077ff98 100%);
    color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}
.cta-section h2 {
    font-size: 2.5rem;
    color: #ffffff;
}
.cta-section p {
    font-size: 1.25rem;
}
.cta-section .btn-light {
    color: #0b396dbd;
    background-color: #ffffff;
    border-color: #ffffff;
}
.cta-section .btn-light:hover {
    color: #ffffff;
    background-color: transparent;
    border-color: #ffffff;
}

/* About Section */
.about-section {
    background-color: #f9f9f9;
}
.about-section .card {
    transition: transform 0.3s, box-shadow 0.3s;
}
.about-section .card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}

/****************************************************************************/
/* 13. HERO SECTION (VIDEO, OVERLAY) */
/****************************************************************************/
.hero-section {
    position: relative;
    overflow: hidden;
    height: 85vh; /* Ajustar según necesidad */
}
.hero-section .video-container {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    overflow: hidden;
}
.hero-section video {
    object-fit: cover;
    width: 100%;
    height: 100%;
}
.hero-section .overlay {
    background: rgba(0, 0, 0, 0.303);
    background-size: cover;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
}
.overlay {
    background: rgba(18, 37, 51, 0.527); /* Color oscuro con opacidad */
    background-size: cover;
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 2;
}
.hero-section .container {
    position: relative;
    z-index: 3;
}
.hero-section .title {
    font-size: 3.6rem;
    font-weight: bold;
    color: #ffffff;
    text-align: left;
    margin-bottom: 1rem;
}
.hero-section .subtitle {
    font-size: 1.5rem;
    font-weight: 400;
    color: #ffffff;
    text-align: left;
    line-height: 1.5;
    margin-bottom: 2rem;
}

/****************************************************************************/
/* 14. MEDIA QUERIES PARA HERO Y OTROS AJUSTES */
/****************************************************************************/
/* Pantallas medianas */
@media (max-width: 992px) {
    .hero-section .title {
        font-size: 3rem;
        text-align: center;
    }
    .hero-section .subtitle {
        font-size: 1.3rem;
        text-align: center;
    }
}

/* Pantallas pequeñas (768px) */
@media (max-width: 768px) {
    .hero-section .title {
        font-size: 2.5rem;
    }
    .hero-section .subtitle {
        font-size: 2.1rem;
    }
    .hero-section {
        height: 80vh;
        padding: 0;
    }
    .hero-section .video-container {
        display: none; /* Ocultar video en móviles */
    }
    .overlay {
        background: rgba(18, 37, 51, 0.257);
    }

    /* Ajustes para formularios en móvil */
    form button {
        font-size: 0.8rem;
        padding: 0.2rem 0.6rem;
    }
    form button i {
        font-size: 0.9rem;
    }

    .row.justify-content-center {
        flex-direction: column;
    }
    #cantidad {
        max-width: 100%;
    }
    form h4 {
        font-size: 1.25rem;
    }
    img.rounded.shadow {
        width: 100%;
    }
}

/* Pantallas extra pequeñas (576px) */
@media (max-width: 576px) {
    .hero-section .title {
        font-size: 2rem;
    }
    .hero-section .subtitle {
        font-size: 1rem;
    }
    .btn-stack {
        flex-direction: column;
        gap: 15px;
        align-items: center;
    }
    .login-card, .register-card {
        width: 90%;
        padding: 0.3rem;
    }
    h1.display-2 {
        font-size: 2rem;
    }
    p.lead {
        font-size: 1rem;
    }
    .btn {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
    }
    .content-wrapper {
        padding-top: 30px;
        padding-bottom: 30px;
    }
    section {
        margin: 20px 0;
    }
}

/****************************************************************************/
/* 15. LOGIN-CARD / REGISTER-CARD Y CONTENT WRAPPER */
/****************************************************************************/
.login-card, .register-card {
    position: relative;
    z-index: 4;
    background-color: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(5px);
}
.content-wrapper {
    padding-top: 100px;
    padding-bottom: 100px;
}

/****************************************************************************/
/* 16. TABLAS PERSONALIZADAS */
/****************************************************************************/
.custom-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0;
    border: 1px solid #dddddd;
    font-size: 1rem;
    color: #333333;
    background-color: #ffffff;
    text-align: center;
}
.custom-table th,
.custom-table td {
    text-align: center;
    vertical-align: middle;
    padding: 10px;
    border-bottom: 1px solid #dddddd;
}
.custom-table th {
    background-color: #03c0ff;
    color: white;
    font-weight: 600;
    border-bottom: 2px solid #dddddd;
}
.custom-table tbody tr:hover {
    background-color: rgb(104, 245, 167);
    color: white;
}
.custom-table tbody tr:last-child td {
    border-bottom: none;
}
.custom-table td:last-child {
    width: 20%;
}
.custom-table button {
    font-size: 0.9rem;
    margin: 0 5px;
    transition: transform 0.2s ease-in-out;
}
.custom-table button:hover {
    transform: scale(1.1);
}

/****************************************************************************/
/* 17. ANIMACIONES */
/****************************************************************************/
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translate3d(0, 40px, 0);
    }
    to {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }
}

/****************************************************************************/
/* 18. SIDEBAR (WRAPPER) */
/****************************************************************************/
.wrapper {
    display: flex;
    min-height: calc(100vh - (altura_del_navbar + altura_del_footer));
}
#sidebar {
    width: 160px;
    min-height: 100%;
    margin-left: -50px;
    padding: 0;
    overflow-y: auto;
    position: sticky;
    top: altura_del_navbar; /* Ajusta según sea necesario */
    background-color: #ffffffd4;
    height: calc(100vh - 90px - 60px);
}
#sidebar.collapsed {
    width: 68px;
}
#sidebar.collapsed .user-fullname {
    display: none;
}
#sidebar.collapsed .text-label {
    display: none;
}
.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: start;
    padding: 10px;
    gap: 10px;
}
.sidebar-header .user-display {
    flex: 1;
}
.sidebar-header .btn {
    flex-shrink: 0;
}
#sidebar.collapsed .sidebar-header {
    justify-content: center;
}
#sidebar.collapsed .sidebar-header .btn {
    margin-left: 0;
    display: block;
}
#sidebar.collapsed .user-display {
    display: none;
}
#sidebar.collapsed .btn {
    margin-left: 0;
}
#sidebar.collapsed .nav-link.sidebar-link {
    justify-content: center;
    padding: 1rem 0;
    transition: padding 0.3s ease, justify-content 0.5s ease;
}
#sidebar.collapsed .nav-link.sidebar-link i {
    margin: 0;
    font-size: 1rem;
}
#sidebar.collapsed .sub-link {
    justify-content: center;
    padding: 0.3rem 0;
}
#sidebar.collapsed .sub-link i {
    margin: 0;
    font-size: 1rem;
}
#sidebar.collapsed .sub-link span {
    display: none;
}
#sidebar.collapsed .collapse.show .sub-link {
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 0.5rem 0;
}
.nav-link.sidebar-link {
    display: flex;
    align-items: center;
    color: #555;
    text-decoration: none;
    position: relative;
    font-size: 0.9rem;
    padding: 1.1rem 0.75rem;
    background-color: #9c9d9d36;
}
.nav-link.sidebar-link:hover {
    background-color: #78cafd4f;
    color: #78cafd;
}
.collapse.show .sub-link {
    background-color: #ffffff20;
}
.user-fullname {
    font-weight: bold;
    font-size: 1.1rem;
    color: #03c0ff;
}
.sub-link {
    margin: 2px;
    padding: 10px 15px;
    border-radius: 5px;
    transition: background-color 0.3s ease;
    font-size: 0.75rem;
}
.sub-link:hover {
    background-color: rgba(3, 192, 255, 0.1);
}

/****************************************************************************/
/* 19. TABLAS (CONTINÚA) */
/****************************************************************************/
.custom-table thead th {
    background-color: #78cafd4f;
    color: #404e57;
    text-align: left;
    vertical-align: middle;
}
.custom-table td,
.custom-table th {
    text-align: left;
    vertical-align: middle;
    padding: 7px;
}
.custom-table tbody tr:hover {
    background-color: #e6f7ff;
}

/****************************************************************************/
/* 20. ACTION-BAR PARA LISTAS MASIVAS (IMPORTAR, EXPORTAR) */
/****************************************************************************/
.action-bar-wrapper {
    display: flex;
    justify-content: flex-end;
    margin-bottom: 20px;
}
.action-bar {
    display: flex;
    gap: 10px;
    background-color: #767c822c;
    padding: 10px 15px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border: 1px solid #ddd;
    align-items: center;
}
.action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    padding: 8px 15px;
    font-size: 14px;
    font-weight: 500;
    color: #fff;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    box-shadow: 0 3px 5px rgba(0, 0, 0, 0.1);
}
.btn-import {
    background: linear-gradient(90deg, #849199, #849199);
}
.btn-export {
    background: linear-gradient(90deg, #849199, #849199);
}
.btn-delete {
    background: linear-gradient(90deg, #f63939, #f63939);
}
.action-btn:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    opacity: 0.9;
}
.action-btn:disabled {
    background-color: #f0f0f0 !important;
    color: #b0b0b0 !important;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    opacity: 0.7;
}

/****************************************************************************/
/* 21. IMÁGENES, CONTACT-ICONS, ETC. */
/****************************************************************************/
/* Ajustar imágenes fluidas */
img.img-fluid {
    max-width: 100%;
    height: auto;
}
.text-highlight {
    color: #ffd700;
}

/* Iconos de contacto */
.contact-icon {
    color: #3498db;
    font-size: 1.5rem;
    transition: color 0.3s, transform 0.3s;
    display: inline-block;
    text-decoration: none;
}
.contact-icon:hover {
    color: #2980b9;
    transform: scale(1.2);
}

/****************************************************************************/
/* 22. PERFIL Y OTROS DETALLES */
/****************************************************************************/
.profile-image {
    width: 150px;
    height: 150px;
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}
.profile-image:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
}
.text-primary,
.btn-outline-primary,
.btn-outline-secondary,
.text-primary.text-decoration-none {
    color: #03B8FF !important;
}
.text-primary:hover,
.btn-outline-primary:hover,
.btn-outline-secondary:hover {
    color: #2F2C2C !important;
}

/****************************************************************************/
/* 23. LOGIN-CARD, REGISTER-CARD, CONTENT-WRAPPER */
/****************************************************************************/
.login-card,
.register-card {
    position: relative;
    z-index: 4;
    background-color: rgba(255, 255, 255, 0.85);
    backdrop-filter: blur(5px);
}
.content-wrapper {
    padding-top: 100px;
    padding-bottom: 100px;
}

/****************************************************************************/
/* FIN DEL ARCHIVO */
/****************************************************************************/

----- Fin de static/css/style.css -----

----- Inicio de static/js/script.js -----
document.addEventListener('DOMContentLoaded', function () {
    const logoUpload = document.getElementById('logoUpload');
    const logoList = document.getElementById('logoList');
    const logoError = document.getElementById('logoError');
    const excelUpload = document.getElementById('excelUpload');
    const excelList = document.getElementById('excelList');
    const excelError = document.getElementById('excelError');
    const sidebar = document.getElementById('sidebar');
    const toggleBtn = document.getElementById('sidebarToggle');

    if (!logoUpload || !logoList || !logoError || !excelUpload || !excelList || !excelError || !sidebar || !toggleBtn) return;

    let selectedLogos = [];
    let selectedExcel = null;

    // Manejar la selección de logos
    logoUpload.addEventListener('change', function (e) {
        const files = Array.from(e.target.files);

        for (let file of files) {
            if (file.size > 5 * 1024 * 1024) {
                showMessage('El archivo es demasiado grande. El tamaño máximo permitido es 5MB', true);
                return;
            }
            if (selectedLogos.length >= 10) {
                showMessage('Solo puedes subir hasta 10 logos.', true);
                break;
            }
            if (['image/png', 'image/jpeg', 'image/jpg'].includes(file.type)) {
                selectedLogos.push(file);
                displayLogo(file);
            } else {
                showMessage('Formato de logo no permitido.', true);
            }
        }
    });

    function createListItem(text, removeAction) {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.textContent = text;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'btn btn-danger btn-sm';
        removeBtn.textContent = 'Eliminar';
        removeBtn.setAttribute('aria-label', 'Eliminar archivo');
        removeBtn.addEventListener('click', removeAction);

        li.appendChild(removeBtn);
        return li;
    }

    function displayLogo(file) {
        const li = createListItem(file.name, () => {
            selectedLogos = selectedLogos.filter((f) => f !== file);
            logoList.removeChild(li);
            logoError.style.display = 'none';
            updateLogoInput();
        });
        logoList.appendChild(li);
    }

    function updateLogoInput() {
        const dataTransfer = new DataTransfer();
        selectedLogos.forEach((file) => {
            dataTransfer.items.add(file);
        });
        logoUpload.files = dataTransfer.files;
    }

    // Manejar la selección de Excel
    excelUpload.addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (selectedExcel) {
            showMessage('Solo se permite subir un archivo Excel a la vez.', true);
            excelUpload.value = ''; // Restablecer el input
            return;
        }
        if (file.size > 5 * 1024 * 1024) {
            showMessage('El archivo es demasiado grande. El tamaño máximo permitido es 5MB', true);
            return;
        }
        if (file && ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(file.type)) {
            selectedExcel = file;
            displayExcel(file);
        } else {
            showMessage('Formato de archivo Excel no permitido.', true);
        }
    });

    function displayExcel(file) {
        const li = createListItem(file.name, () => {
            selectedExcel = null;
            excelList.removeChild(li);
            excelError.style.display = 'none';
            excelUpload.value = ''; // Restablecer el input
        });
        excelList.appendChild(li);
    }

    // ** SIDEBAR TOGGLE **
    toggleBtn.addEventListener('click', function () {
        sidebar.classList.toggle('collapsed');
        this.innerHTML = sidebar.classList.contains('collapsed') ? 
            '<i class="bi bi-chevron-right"></i>' : 
            '<i class="bi bi-chevron-left"></i>';
    });
});

function showMessage(message, isError = false) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `alert alert-${isError ? 'danger' : 'success'}`;
    messageDiv.textContent = message;
    const messageContainer = document.getElementById('messageContainer');
    if (messageContainer) {
        messageContainer.appendChild(messageDiv);
        setTimeout(() => messageDiv.remove(), 3000);
    }
}

// ** DATATABLES CONFIGURACIÓN **
$(document).ready(function () {
    $('.custom-datatable').DataTable({
        language: {
            url: "https://cdn.datatables.net/plug-ins/1.11.5/i18n/es-ES.json",
        },
        pageLength: 10,
        lengthChange: true,
        ordering: true,
        searching: true,
    }).on('error.dt', function(e, settings, techNote, message) {
        console.error('DataTables Error: ', message);
        showMessage('Hubo un error al cargar la tabla de datos.', true);
    });
});

----- Fin de static/js/script.js -----

----- Inicio de templates/pulzcard/card.html -----
<!-- templates/pulzcard/card.html -->

{% extends 'base.html' %}

{% block title %}Tu Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<style>
    /* Fondo personalizado solo para esta página */
    body {
        background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #333333;
    }

    /* Fondo y estilo para el encabezado "Tu Pulzcard" */
    .card-header {
        background: linear-gradient(135deg, #01b9f6 0%, #02a4da 100%);
    }

    .card-header h3 {
        color: #ffffff;
        font-family: 'Myriad Pro', sans-serif;
        font-size: 1.7rem;
        font-weight: 700;
    }

    /* Estilo de fuente independiente para el nombre completo */
    .card-title {
        font-family: 'Myriad Pro', sans-serif;
        font-size: 2.2rem;
        font-weight: 700;
        color: #03c0ff;
    }

    /* Estilo independiente para posición y organización */
    .card-subtitle {
        font-family: 'Myriad Pro', sans-serif;
        font-size: 1.2rem;
        font-weight: 500;
        color: #9f9f9f;
        margin-top: 0.5rem;
    }

    /* Imagen de perfil con sombra y ajuste de tamaño */
    .profile-image {
        width: 200px;
        height: 200px;
        border: 0px solid #ffffff;
        object-fit: cover;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .profile-image:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
    }

    /* Separador personalizado */
    hr {
        border-top: 2px solid #03c0ff;
        opacity: 0.8;
        width: 80%;
        margin: 1.5rem auto;
    }
</style>

<!-- Espaciado Superior -->
<div style="margin: 90px;"></div>

<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <div class="card shadow-lg border-0 rounded-lg">
                <!-- Encabezado con logo y botones -->
                <div class="card-header text-white d-flex justify-content-between align-items-center p-3">
                    <!-- Logo a la izquierda -->
                    <div>
                        <img src="{{ url_for('static', filename='images/logocardv2.png') }}" alt="Pulztag Logo" height="30">
                    </div>                    
                    <!-- Botones a la derecha -->
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('pulzcard_download_vcard', filename=card_id + '.vcf') }}" download="Pulzcard_{{ contact.full_name.replace(' ', '_') }}.vcf" class="btn btn-custom-white btn-icon" title="Descargar vCard">
                            <i class="fa-solid fa-circle-down" style="font-size: 1.0em;"></i>
                        </a>
                        <!-- Botón para copiar URL -->
                        <button class="btn btn-custom-white btn-icon" onclick="copyURL()" title="Copiar URL">
                            <i class="fa-solid fa-clone" style="font-size: 1.0em;"></i>
                        </button>
                        {% if current_user.is_authenticated %}
                        <!-- Botón Volver -->
                        <a href="{{ url_for('profile') }}" class="btn btn-custom-white btn-icon" title="Volver al Perfil">
                            <i class="fa-solid fa-angles-left" style="font-size: 1.0em;"></i>
                        </a>
                        {% endif %}
                        <input type="hidden" id="cardURL" value="{{ request.url }}">
                    </div>
                </div>
                <div style="margin: 10px;"></div>
                <div class="card-body text-center p-2">
                    <!-- Imagen de Perfil -->
                    <div class="mb-4">
                        <img src="{{ url_for('uploaded_file', filename=contact['image_file']) }}" alt="Imagen de Perfil" class="rounded-circle profile-image shadow-lg">
                    </div>

                    <h1 class="card-title font-weight-bold mb-3">{{ contact.full_name }}</h1>
                    <p class="card-subtitle">{{ contact.position }}, {{ contact.organization }}</p>
                    
                    <!-- Separador -->
                    <hr class="my-3">
                    
                    <!-- Información de Contacto -->
                    <div class="mt-4">
                        <p class="card-text">
                            <strong>Teléfono:</strong>
                            <a href="tel:{{ contact.phone }}" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-mobile-screen-button"></i>{{ contact.phone }}
                            </a>
                        </p>
                        <p class="card-text">
                            <strong>Email:</strong>
                            <a href="mailto:{{ contact.email }}" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-envelope"></i>{{ contact.email }}
                            </a>
                        </p>
                        <p class="card-text">
                            <strong>Página Web:</strong>
                            <a href="{{ contact.website }}" target="_blank" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-globe"></i>{{ contact.website }}
                            </a>
                        </p>
                        <p class="card-text">
                            <i class="fa-solid fa-map-location"></i>
                            <strong>Dirección:</strong> {{ contact.address }}
                        </p>
                    </div>
                    
                    <!-- Instrucciones para Agregar Contacto -->
                    <div class="mt-4">
                        <h5 class="form-subtitle mb-3">Instrucciones:</h5>
                        <ul class="list-unstyled text-muted">
                            <li><i class="fa-brands fa-android"></i><strong>Android:</strong> Descarga y abre con la app de contactos.</li>
                            <li><i class="fa-brands fa-apple"></i><strong>iOS:</strong> Descarga y selecciona "Agregar a contactos".</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para copiar URL al portapapeles -->
<script>
    function copyURL() {
        const url = document.getElementById('cardURL').value;
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }
</script>
{% endblock %}

----- Fin de templates/pulzcard/card.html -----

----- Inicio de templates/pulzcard/index.html -----
<!-- templates/pulzcard/index.html -->

{% extends 'base.html' %}

{% block title %}Crear Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Crear Tu Tarjeta de Contacto NFC</h2>

<!-- Notificación de Error para URL Inválida -->
{% if form.website.errors %}
    <div class="notification error">
        Formato de URL para la página web es incorrecto.
    </div>
{% endif %}

<!-- Actualización: Añadir enctype para permitir la subida de archivos -->
<form method="POST" id="pulzcardForm" enctype="multipart/form-data" class="container">
    {{ form.hidden_tag() }}

    <!-- Mostrar errores globales del formulario, excluyendo 'website' -->
    {% if form.errors and not form.website.errors %}
        <div class="alert alert-danger">
            <ul class="mb-0">
                {% for field, errors in form.errors.items() %}
                    {% if field != 'website' %}
                        {% for error in errors %}
                            <li><strong>{{ field.replace('_', ' ').capitalize() }}:</strong> {{ error }}</li>
                        {% endfor %}
                    {% endif %}
                {% endfor %}
            </ul>
        </div>
    {% endif %}

    <!-- Datos Personales -->
    <h4 class="form-subtitle mb-3">Datos Personales</h4>
    <div class="row mb-3">
        <div class="col-md-6">
            {{ form.first_name.label(class="form-label") }}
            {{ form.first_name(class="form-control", placeholder="Nombre") }}
        </div>
        <div class="col-md-6">
            {{ form.last_name.label(class="form-label") }}
            {{ form.last_name(class="form-control", placeholder="Apellido") }}
        </div>
    </div>

    <div class="row mb-3">
        <div class="col-md-6">
            {{ form.phone.label(class="form-label") }}
            {{ form.phone(class="form-control", placeholder="Número Telefónico") }}
        </div>
        <div class="col-md-6">
            {{ form.email.label(class="form-label") }}
            {{ form.email(class="form-control", placeholder="Correo Electrónico") }}
        </div>
    </div>

    <!-- Información de la Empresa -->
    <h4 class="form-subtitle mb-3">Información de la Empresa</h4>
    <div class="row mb-3">
        <div class="col-md-6">
            {{ form.organization.label(class="form-label") }}
            {{ form.organization(class="form-control", placeholder="Nombre Organización") }}
        </div>
        <div class="col-md-6">
            {{ form.position.label(class="form-label") }}
            {{ form.position(class="form-control", placeholder="Cargo") }}
        </div>
    </div>

    <!-- Otros Detalles -->
    <h4 class="form-subtitle mb-3"">Otros Detalles</h4>
    <div class="row mb-3">
        <div class="col-md-6">
            {{ form.website.label(class="form-label") }}
            {{ form.website(class="form-control", placeholder="https://www.ejemplo.com", type="url", id="website") }}
            <span id="website-error" class="error-message"></span>
        </div>
        <div class="col-md-6">
            {{ form.address.label(class="form-label") }}
            {{ form.address(class="form-control", placeholder="Dirección") }}
        </div>
    </div>

    <!-- Foto de Perfil -->
    <h4 class="form-subtitle mb-3">Foto de Perfil</h4>
    <div class="form-group mb-4">
        {{ form.image_file.label(class="form-label") }}
        {{ form.image_file(class="form-control") }}
        {% for error in form.image_file.errors %}
            <div class="text-danger">{{ error }}</div>
        {% endfor %}
    </div>

    <!-- Nombre de la Tarjeta -->
    <h4 class="form-subtitle mb-3">Nombre de la Tarjeta</h4>
    <div class="form-group mb-4">
        {{ form.card_name.label(class="form-label") }}
        {{ form.card_name(class="form-control", placeholder="Nombre de Tarjeta") }}
    </div>

        <!-- Añadir esta sección donde corresponda en el formulario -->
    <h4 class="form-subtitle mb-3">Selecciona una Plantilla</h4>
    <div class="mb-3">
        {{ form.template.label(class="form-label") }}
        {{ form.template(class="form-control") }}
    </div>

    <!-- Botón de Envío -->
    <div class="form-group text-center">
        {{ form.submit(class="btn btn-primary") }}
        <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancelar</a>
    </div>
</form>

<!-- Validación en tiempo real para URL -->
<script>
    document.getElementById('website').addEventListener('input', function() {
        const websiteInput = this;
        const errorSpan = document.getElementById('website-error');
        const urlPattern = /^(https?:\/\/)?([\w\-])+\.{1}([a-zA-Z]{2,63})([\/\w\-.?=&%]*)*\/?$/;

        if (websiteInput.value && !urlPattern.test(websiteInput.value)) {
            errorSpan.textContent = "Formato de URL de página web es incorrecto. Ej: https://www.ejemplo.com";
            errorSpan.style.color = "#721c24";
        } else {
            errorSpan.textContent = "";
        }
    });
</script>
{% endblock %}

----- Fin de templates/pulzcard/index.html -----

----- Inicio de templates/about.html -----
<!-- templates/about.html -->

{% extends 'base.html' %}

{% block title %}Acerca de - Pulztag{% endblock %}

{% block head %}
    {{ super() }}
    <!-- Meta para responsividad -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
      .titulo-seccion {
          font-size: 2.3em;
          font-weight: bold;
          text-align: center;
          margin-top: 50px;
          margin-bottom: 40px;
      }
      .introduction-section .zoom-effect:hover {
          transform: scale(1.02);
          transition: transform 0.3s ease-in-out;
      }
      .service-card {
          transition: transform 0.3s ease, box-shadow 0.3s ease;
      }
      .service-card:hover {
          transform: translateY(-5px);
          box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
      }
    </style>
{% endblock %}

{% block content %}
<div class="container my-5">

    <!-- Sección de Encabezado -->
    <div class="text-center mb-5">
        <h2 class="titulo-seccion">Acerca de Pulztag</h2>
        <p class="lead">Reinventando la interacción entre empresas y clientes con <strong>soluciones NFC innovadoras</strong>.</p>
    </div>

    <!-- Sección de Introducción -->
    <section class="introduction-section mb-5">
        <div class="row align-items-center">
            <!-- Texto a la Izquierda -->
            <div class="col-md-6 order-md-1">
                <h3>Innovación y Tecnología a tu Servicio</h3>
                <p>
                    En <strong>Pulztag</strong>, reinventamos la interacción entre empresas y clientes con <strong>soluciones NFC personalizadas</strong>.
                    Nos especializamos en <strong>optimizar procesos</strong>, crear conexiones significativas y llevar a nuestros clientes
                    hacia la <strong>transformación digital</strong>.
                </p>
                <p>
                    Nuestra pasión por la <strong>innovación tecnológica</strong> nos posiciona como tu socio estratégico en el
                    mundo digital actual, garantizando un crecimiento continuo y adaptándonos a las últimas tendencias.
                </p>
                <a href="{{ url_for('contact') }}" class="btn btn-primary btn-lg mt-3" title="Contáctanos">
                    Contáctanos
                </a>
            </div>
            <!-- Imagen a la Derecha -->
            <div class="col-md-6 order-md-2 mt-4 mt-md-0">
                <img src="{{ url_for('static', filename='images/acerca_de.jpeg') }}" 
                     alt="Pulztag Innovación NFC"
                     class="img-fluid rounded shadow-sm zoom-effect"
                     loading="lazy">
            </div>
        </div>
    </section>

    <!-- Línea de Separación -->
    <hr class="my-5">

    <!-- Sección Misión y Visión -->
    <section class="services-section mb-5">
        <h3 class="text-center mb-4">Nuestra Misión y Visión</h3>
        <div class="row">
            <!-- Misión -->
            <div class="col-md-6 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body text-center">
                        <i class="bi bi-flag fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Misión</h5>
                        <p class="card-text">
                            <strong>Transformar</strong> la experiencia de interacción entre empresas y clientes
                            mediante <strong>soluciones NFC personalizadas</strong>  
                            que <strong>optimicen procesos</strong>, generen <strong>conexiones significativas</strong>
                            y mejoren la <strong>eficiencia operativa</strong>.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Visión -->
            <div class="col-md-6 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body text-center">
                        <i class="bi bi-eye fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Visión</h5>
                        <p class="card-text">
                            Ser la <strong>empresa líder</strong> en <strong>soluciones NFC innovadoras</strong> en <strong>Latinoamérica</strong>,
                            facilitando la <strong>transformación digital</strong> y creando un mundo más <strong>interactivo, eficiente y conectado</strong>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Línea de Separación -->
    <hr class="my-5">

    <!-- Nuestros Valores -->
    <section class="mt-5">
        <h3 class="text-center mb-4">Nuestros Valores</h3>
        <div class="row">
            <!-- Innovación -->
            <div class="col-md-4 mb-4">
                <div class="card text-center service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body">
                        <i class="bi bi-lightbulb fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Innovación</h5>
                        <p class="card-text">
                            Nos mantenemos a la <strong>vanguardia tecnológica</strong>, entregando
                            <strong>soluciones únicas</strong> y efectivas.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Calidad -->
            <div class="col-md-4 mb-4">
                <div class="card text-center service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body">
                        <i class="bi bi-award fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Calidad</h5>
                        <p class="card-text">
                            Cada proyecto se ejecuta con <strong>altos estándares</strong>, asegurando la
                            <strong>satisfacción</strong> de nuestros clientes.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Colaboración -->
            <div class="col-md-4 mb-4">
                <div class="card text-center service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body">
                        <i class="bi bi-people-fill fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Colaboración</h5>
                        <p class="card-text">
                            Trabajamos en <strong>estrecha colaboración</strong> con nuestros clientes para
                            <strong>superar sus expectativas</strong>.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Línea de Separación -->
    <hr class="my-5">

    <!-- Call to Action -->
    <section class="text-center mt-5">
        <h2>¿Listo para Transformar tu Negocio?</h2>
        <p class="lead">
            Contáctanos y descubre cómo nuestras <strong>soluciones NFC personalizadas</strong> pueden
            <strong>impulsar tu empresa</strong>.
        </p>
        <a class="btn btn-primary btn-lg" href="{{ url_for('contact') }}" role="button"
           title="Contáctanos y emprende la transformación digital">
           Contáctanos
        </a>
    </section>
</div>

{% endblock %}

{% block scripts %}
<!-- AOS JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    AOS.init({
        duration: 800,
        easing: 'slide',
        once: true
    });
});
</script>
{% endblock %}

----- Fin de templates/about.html -----

----- Inicio de templates/account.html -----
<!-- templates/account.html -->

{% extends 'base.html' %}

{% block title %}Perfil de Usuario - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Perfil de Usuario</h2>
<div class="row justify-content-center">
    <div class="col-md-6">
        <form method="POST" action="{{ url_for('main.account') }}">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.username.label(class="form-label") }}
                {{ form.username(class="form-control", placeholder="Nombre de Usuario") }}
                {% for error in form.username.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <div class="mb-3">
                <label class="form-label">Correo Electrónico</label>
                <p class="form-control-plaintext">{{ current_user.email }}</p>
            </div>
            <hr>
            <h5>Verificación de Seguridad</h5>
            <p>Por favor, ingresa tu contraseña actual para confirmar que eres el dueño de la cuenta.</p>
            <div class="mb-3">
                {{ form.current_password.label(class="form-label") }}
                {{ form.current_password(class="form-control", placeholder="Contraseña Actual") }}
                {% for error in form.current_password.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <hr>
            <h5>Cambiar Contraseña (Opcional)</h5>
            <div class="mb-3">
                {{ form.password.label(class="form-label") }}
                {{ form.password(class="form-control", placeholder="Nueva Contraseña") }}
                {% for error in form.password.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <div class="mb-3">
                {{ form.confirm_password.label(class="form-label") }}
                {{ form.confirm_password(class="form-control", placeholder="Confirmar Nueva Contraseña") }}
                {% for error in form.confirm_password.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-primary">{{ form.submit.label.text }}</button>
        </form>
    </div>
</div>
{% endblock %}

----- Fin de templates/account.html -----

----- Inicio de templates/base.html -----
<!-- templates/base.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <!-- Script para efecto de desplazamiento en el fondo -->
    <script>
        document.addEventListener('scroll', () => {
            const scrollPosition = window.scrollY;
            document.body.style.backgroundPosition = `center ${50 + scrollPosition * 0.05}%`;
        });
    </script>

    <!-- Google Tag Manager -->
    <script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;
    j.src='https://www.googletagmanager.com/gtm.js?id=GTM-NC88XS28'+dl;
    f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NC88XS28');
    </script>
    <!-- End Google Tag Manager -->

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Pulztag{% endblock %}</title>

    <!-- Open Graph -->
    <meta property="og:title" content="Pulztag - Tecnología NFC y más">
    <meta property="og:description" content="Descubre soluciones innovadoras con dispositivos NFC personalizados para marketing, logística y más.">
    <meta property="og:image" content="{{ url_for('static', filename='images/logochain1.png', _external=True) }}">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:type" content="website">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" 
          integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" 
          crossorigin="anonymous" referrerpolicy="no-referrer" />

    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

    <!-- CSS Personalizado con Parámetro de Versión para Evitar Caché -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=1.0">

    {% block head %}{% endblock %}
</head>

<body class="d-flex flex-column min-vh-100">
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NC88XS28"
                height="0" width="0" 
                style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Barra Superior -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand text-primary fw-bold d-flex align-items-center" href="/">
                <img src="{{ url_for('static', filename='images/logochaintextblack.png') }}"
                     alt="Pulztag Logo" height="45" class="me-2">
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNav" aria-controls="navbarNav" 
                    aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarNav">
                <!-- Links de navegación -->
                <ul class="navbar-nav mx-auto">
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/' %} active{% endif %}" href="/">Inicio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/services' %} active{% endif %}"
                           href="{{ url_for('services') }}">Servicios</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/products' %} active{% endif %}"
                           href="{{ url_for('products') }}">Productos</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path.startswith('/create_item') %} active{% endif %}"
                           href="{{ url_for('create_item') }}">Crear Item</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/order' %} active{% endif %}"
                           href="/order">Pedido</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/about' %} active{% endif %}"
                           href="/about">Acerca de</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link{% if request.path == '/contact' %} active{% endif %}"
                           href="/contact">Contacto</a>
                    </li>
                </ul>

                <!-- Menu de usuario -->
                <ul class="navbar-nav ms-auto">
                    {% if current_user.is_authenticated %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown"
                           role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            {{ current_user.username }}
                            <i class="bi bi-person-circle ms-1"></i>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                            <li>
                                <a class="dropdown-item" href="{{ url_for('profile') }}">Perfil</a>
                            </li>
                            <li><hr class="dropdown-divider"></li>
                            <li>
                                <a class="dropdown-item" href="{{ url_for('main.logout') }}">Cerrar Sesión</a>
                            </li>
                        </ul>
                    </li>
                    {% else %}
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="authDropdown"
                           role="button" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="fa-solid fa-right-to-bracket me-2"></i> Iniciar Sesión
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="authDropdown">
                            <li>
                                <a class="dropdown-item" href="{{ url_for('main.login') }}">Iniciar Sesión</a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="{{ url_for('main.register') }}">Crear Cuenta</a>
                            </li>
                        </ul>
                    </li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </nav>

    <!-- Mensajes Flash -->
    <div id="flash-messages"
         style="position: fixed; top: 90px; left: 0; right: 0; z-index: 1000;">
        <div class="container mt-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                <div class="row justify-content-center">
                    <div class="col-md-8">
                        {% for category, message in messages %}
                        <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                            {{ message }}
                            <button type="button" class="btn-close"
                                    data-bs-dismiss="alert" aria-label="Cerrar"></button>
                        </div>
                        {% endfor %}
                    </div>
                </div>
            {% endif %}
            {% endwith %}
        </div>
    </div>

    <!-- Bloque para la sección Hero o VideoHero -->
    {% block hero %}
    {# 
      Ejemplo: si quieres usar video de fondo, en tu index.html
      podrías hacer:
      
      {% block hero %}
      <section class="hero-section position-relative overflow-hidden" style="margin-top:50px;">
          <div class="video-container">
              <video id="hero-video" autoplay muted loop playsinline preload="auto">
                  <source src="{{ url_for('static', filename='videos/longvideo.mp4') }}" type="video/mp4">
              </video>
          </div>
          <div class="overlay"></div>
          <div class="container position-relative z-index-2 px-0 min-vh-100">
              <!-- Contenido hero -->
          </div>
      </section>
      {% endblock %}
      
      Si NO quieres video, omite el hero o usa una sección estática. 
    #}
    {% endblock %}

    <!-- Contenido Principal -->
    <main class="flex-grow-1" style="margin-top: 70px;">
        <div class="container mt-4">
            {% block content %}{% endblock %}
        </div>
    </main>

    <!-- Footer -->
    {% include 'footer.html' %}

    <!-- Bootstrap JS y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS Personalizado -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>

    <!-- Reproducción de videos (opcional) -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
        const videoElement = document.getElementById('hero-video');
        if (!videoElement) return;

        // Ejemplo de cargar un array de videos
        const videos = ["{{ url_for('static', filename='videos/longvideo.mp4') }}"];
        let videoIndex = 0;

        const sourceElement = videoElement.querySelector('source');
        function playNextVideo() {
            if (sourceElement) {
                sourceElement.src = videos[videoIndex];
                videoElement.load();
                videoElement.play();
                videoIndex = (videoIndex + 1) % videos.length;
            }
        }

        videoElement.addEventListener('ended', playNextVideo);
    });
    </script>

    <!-- Ajustes responsive para ocultar video y mostrar imagen en móvil -->
    <style>
    @media (max-width: 768px) {
        .video-container {
            display: none; /* Oculte el video en pantallas pequeñas */
        }
        .hero-section {
            background: url("{{ url_for('static', filename='images/bg_m.jpg') }}") center center no-repeat;
            background-size: cover;
        }
    }
    </style>

    {% block scripts %}{% endblock %}
</body>
</html>

----- Fin de templates/base.html -----

----- Inicio de templates/contact.html -----
<!-- templates/contact.html -->

{% extends 'base.html' %}

{% block title %}Contacto - PulztagWeb{% endblock %}

{% block content %}

<h2 class="titulo-seccion">Contáctanos</h2>
<p class="text-center mb-5">Estamos aquí para ayudarte. Completa el formulario a continuación y nos pondremos en contacto contigo lo antes posible.</p>

<div class="row justify-content-center">
    <div class="col-md-8">
        <form method="POST" action="{{ url_for('contact') }}">
            {{ form.hidden_tag() }}  <!-- Esto incluye el CSRF token -->
            <div class="mb-3">
                <label for="nombre" class="form-label">Nombre</label>
                {{ form.nombre(class="form-control", placeholder="Tu nombre", required=True) }}
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Correo Electrónico</label>
                {{ form.email(class="form-control", placeholder="nombre@ejemplo.com", required=True) }}
            </div>
            <div class="mb-3">
                <label for="mensaje" class="form-label">Mensaje</label>
                {{ form.mensaje(class="form-control", rows="5", placeholder="Tu mensaje", required=True) }}
            </div>
            <button type="submit" class="btn btn-primary">Enviar</button>
        </form>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<!-- Información de Contacto Section -->
<section class="cta-section bg-info text-white py-5 mt-4">
    <div class="container text-center">
        <h2 class="text-white">Información de Contacto</h2>
        <p class="lead mb-4">Para más información, no dudes en ponerte en contacto con nosotros a través de los siguientes medios:</p>
        <ul class="list-unstyled">
            <li><strong>Correo Electrónico:</strong> <a href="mailto:contacto@pulztag.com" class="text-white">contacto@pulztag.com</a></li>
            <li><strong>Teléfono:</strong> <a href="tel:+56962411963" class="text-white">+56962411963</a></li>
            <li><strong>Instagram:</strong> <a href="https://www.instagram.com/pulztag" target="_blank" class="text-white">@pulztag</a></li>
        </ul>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<style>
    .titulo-seccion {
        margin-top: 50px; /* Añade espacio superior */
    }
</style>
{% endblock %}

----- Fin de templates/contact.html -----

----- Inicio de templates/edit_pulzcard.html -----
<!-- templates/edit_pulzcard.html -->

{% extends 'base.html' %}

{% block title %}Editar Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Editar Pulzcard</h2>

<div class="row justify-content-center">
    <div class="col-md-8">
        <!-- Actualización: Añadir enctype para permitir la subida de archivos -->
        <form method="POST" action="{{ url_for('edit_pulzcard', card_id=pulzcard.card_id) }}" enctype="multipart/form-data">
            {{ form.hidden_tag() }}

            <!-- Sección: Datos Personales -->
            <h4 class="form-subtitle mb-3">Datos Personales</h4>
            <div class="row mb-3">
                <div class="col-md-6">
                    {{ form.first_name.label(class="form-label") }}
                    {{ form.first_name(class="form-control", placeholder="Nombre") }}
                    {% for error in form.first_name.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    {{ form.last_name.label(class="form-label") }}
                    {{ form.last_name(class="form-control", placeholder="Apellido") }}
                    {% for error in form.last_name.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
            </div>

            <div class="row mb-3">
                <div class="col-md-6">
                    {{ form.phone.label(class="form-label") }}
                    {{ form.phone(class="form-control", placeholder="Número Telefónico") }}
                    {% for error in form.phone.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    {{ form.email.label(class="form-label") }}
                    {{ form.email(class="form-control", placeholder="Correo Electrónico") }}
                    {% for error in form.email.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
            </div>

            <!-- Sección: Información de la Empresa -->
            <h4 class="form-subtitle mb-3">Información de la Empresa</h4>
            <div class="row mb-3">
                <div class="col-md-6">
                    {{ form.organization.label(class="form-label") }}
                    {{ form.organization(class="form-control", placeholder="Nombre Organización") }}
                    {% for error in form.organization.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    {{ form.position.label(class="form-label") }}
                    {{ form.position(class="form-control", placeholder="Cargo") }}
                    {% for error in form.position.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
            </div>

            <!-- Sección: Otros Detalles -->
            <h4 class="form-subtitle mb-3"">Otros Detalles</h4>
            <div class="row mb-3">
                <div class="col-md-6">
                    {{ form.website.label(class="form-label") }}
                    {{ form.website(class="form-control", placeholder="https://www.ejemplo.com", type="url", id="website") }}
                    <span id="website-error" class="error-message"></span>
                    {% for error in form.website.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="col-md-6">
                    {{ form.address.label(class="form-label") }}
                    {{ form.address(class="form-control", placeholder="Dirección") }}
                    {% for error in form.address.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
            </div>

            <!-- Sección: Foto de Perfil -->
            <h4 class="form-subtitle mb-3"">Foto de Perfil</h4>
            <div class="mb-3">
                {{ form.image_file.label(class="form-label") }}
                {{ form.image_file(class="form-control") }}
                {% for error in form.image_file.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Sección: Nombre de la Tarjeta -->
            <h4 class="form-subtitle mb-3">Nombre de la Tarjeta</h4>
            <div class="mb-3">
                {{ form.card_name.label(class="form-label") }}
                {{ form.card_name(class="form-control", placeholder="Nombre de Tarjeta") }}
                {% for error in form.card_name.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Añadir esta sección donde corresponda en el formulario -->
            <h4 class="form-subtitle mb-3">Selecciona una Plantilla</h4>
            <div class="mb-3">
                {{ form.template.label(class="form-label") }}
                {{ form.template(class="form-control") }}
            </div>

            <!-- Botones de Acción -->
            <div class="text-center mt-4">
                {{ form.submit(class="btn btn-primary") }}
                <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancelar</a>
            </div>
        </form>
    </div>
</div>

<!-- Validación en tiempo real para URL -->
<script>
    document.getElementById('website').addEventListener('input', function() {
        const websiteInput = this;
        const errorSpan = document.getElementById('website-error');
        const urlPattern = /^(https?:\/\/)?([\w\-])+\.{1}([a-zA-Z]{2,63})([\/\w\-.?=&%]*)*\/?$/;

        if (websiteInput.value && !urlPattern.test(websiteInput.value)) {
            errorSpan.textContent = "Formato de URL de página web es incorrecto. Ej: https://www.ejemplo.com";
            errorSpan.style.color = "#721c24";
        } else {
            errorSpan.textContent = "";
        }
    });
</script>
{% endblock %}

----- Fin de templates/edit_pulzcard.html -----

----- Inicio de templates/index.html -----
<!-- templates/index.html -->

{% extends 'base.html' %}

{% block head %}
    {{ super() }}
    <!-- Meta para asegurar responsividad -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- AOS CSS para animaciones -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css" rel="stylesheet">
    
    <style>
      /* Se recomienda mover estos estilos a un archivo CSS externo para mejor mantenibilidad */
      .hero-section {
        position: relative;
        overflow: hidden;
      }
      .video-container {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
      .overlay {
        background-color: rgba(0, 0, 0, 0.5);
      }
      .titulo-seccion {
        font-size: 2em;
        font-weight: bold;
        text-align: center;
        margin-top: 40px;
        margin-bottom: 30px;
      }
      @media (max-width: 768px) {
        .hero-section {
          /* Ajustes responsivos en caso de necesitar ocultar el video o reducir la altura */
        }
      }
    </style>
{% endblock %}

{% block title %}Inicio - PulztagWeb{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section position-relative overflow-hidden">
    <!-- Video de Fondo (carga condicional para dispositivos > 768px) -->
    <div class="video-container d-none d-md-block"> 
        <video id="hero-video" autoplay muted loop playsinline preload="auto" class="w-100 h-100 object-fit-cover">
            <source src="{{ url_for('static', filename='videos/longvideo.mp4') }}" type="video/mp4">
            Tu navegador no soporta videos HTML5. Por favor, actualiza a un navegador moderno.
        </video>
    </div>
    <!-- Overlay -->
    <div class="overlay position-absolute top-0 start-0 w-100 h-100"></div>

    <!-- Contenido del Hero -->
    <div class="container position-relative z-3">
        <div class="row align-items-center min-vh-100 text-center text-lg-start">
            <div class="col-lg-6 col-md-10 offset-lg-1 px-3">
                <h1 class="title display-4 fw-bold mb-2">
                    Eleva la Experiencia de tus Clientes
                    <span class="text-highlight d-block">con Tecnología Interactiva</span>
                </h1>
                <p class="subtitle lead text-white mb-4">
                    Gestiona, optimiza y personaliza todas las interacciones con tus clientes en una única plataforma integral.
                </p>
                <div class="btn-stack d-flex justify-content-center justify-content-lg-start flex-wrap gap-2">
                    <a href="{{ url_for('create_item') }}" 
                       class="btn btn-lg fw-bold text-dark" 
                       style="background-color: #ffd700;"
                       title="Crea tu primer Item NFC y comienza gratis">
                       Comienza ahora Gratis
                    </a>
                    <a href="{{ url_for('contact') }}" 
                       class="btn btn-outline-light btn-lg fw-bold"
                       title="Contáctanos para más información">
                       Contáctanos
                    </a>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Sección Propuesta de Valor -->
<section id="propuesta-valor" class="my-4 py-5" style="background-color: #ffffffbf; text-align: center;">
    <div class="container" style="max-width: 800px;">
        <h2 class="titulo-seccion">Una Herramienta Única para Experiencias Interactivas</h2>
        <p class="mb-4" style="font-size: 1.2em; color: #555; line-height: 1.6;">
            Fusionamos tecnologías innovadoras como <strong>NFC, códigos QR, RFID y biometría</strong> 
            en una sola plataforma, creando soluciones personalizadas que conectan a las personas 
            con experiencias únicas y resultados medibles.
        </p>
        <div class="d-flex justify-content-center flex-wrap gap-4">
            <!-- Beneficio 1 -->
            <div style="min-width: 220px; max-width: 250px;">
                <i class="fa-solid fa-network-wired" style="font-size: 3rem; color: #ff5957; margin-bottom: 15px;"></i>
                <h3 style="font-size: 1.15em; color: #333; margin-bottom: 10px;">Tecnología Avanzada</h3>
                <p style="font-size: 0.95em; color: #777; line-height: 1.4;">
                    Integración fluida de NFC, QR y más, con el respaldo de IA y AIDC.
                </p>
            </div>
            <!-- Beneficio 2 -->
            <div style="min-width: 220px; max-width: 250px;">
                <i class="fa-solid fa-face-smile-wink" style="font-size: 3rem; color: #41db30; margin-bottom: 15px;"></i>
                <h3 style="font-size: 1.15em; color: #333; margin-bottom: 10px;">Personalización Real</h3>
                <p style="font-size: 0.95em; color: #777; line-height: 1.4;">
                    Experiencias interactivas adaptadas a cada cliente, sector y necesidad.
                </p>
            </div>
            <!-- Beneficio 3 -->
            <div style="min-width: 220px; max-width: 250px;">
                <i class="fa-solid fa-chart-line" style="font-size: 3rem; color: #57a0ff; margin-bottom: 15px;"></i>
                <h3 style="font-size: 1.15em; color: #333; margin-bottom: 10px;">Resultados Medibles</h3>
                <p style="font-size: 0.95em; color: #777; line-height: 1.4;">
                    Optimiza procesos y obtén métricas claras para decisiones estratégicas.
                </p>
            </div>
        </div>
        <div class="mt-4">
            <a href="{{ url_for('services') }}"
               class="btn btn-primary btn-lg"
               title="Descubre más sobre nuestros servicios">
               Descubre cómo funciona
            </a>
        </div>
    </div>
</section>

<!-- Sección CEM -->
<section id="CEM" class="my-4 py-5" style="background-color: #ffffffbf; text-align: center;">
    <div class="container">
        <h2 class="titulo-seccion">¿Qué es la Plataforma CEM?</h2>
        <p class="lead text-center mb-5">
            Nuestra Plataforma Integral de Gestión de la Experiencia del Cliente (CEM) centraliza todas las herramientas necesarias para gestionar y mejorar cada interacción con tus clientes.
        </p>
        <div class="row">
            <!-- Card 1: URLs -->
            <div class="col-md-4 mb-4" data-aos-delay="100">
                <div class="card h-100 shadow-sm border-0">
                    <img src="{{ url_for('static', filename='images/administracion_urls.png') }}" 
                         class="card-img-top" 
                         alt="Administración de URLs"
                         style="object-fit: cover; height: 200px; width: 100%;"
                         loading="lazy">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">Administración de URLs</h5>
                        <p class="card-text">
                            Gestiona URLs dedicadas para atención al cliente, acceso a productos y evaluación de servicios.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Card 2: Pulzcards -->
            <div class="col-md-4 mb-4" data-aos-delay="200">
                <div class="card h-100 shadow-sm border-0">
                    <img src="{{ url_for('static', filename='images/pulzcard_dashboard.png') }}" 
                         class="card-img-top" 
                         alt="Gestión de Pulzcards" 
                         style="object-fit: cover; height: 200px; width: 100%;"
                         loading="lazy">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">Gestión de Tarjetas de Contacto Inteligentes (Pulzcards)</h5>
                        <p class="card-text">
                            Crea y administra tarjetas virtuales con información de contacto y códigos QR personalizados.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Card 3: Etiquetas -->
            <div class="col-md-4 mb-4" data-aos-delay="300">
                <div class="card h-100 shadow-sm border-0">
                    <img src="{{ url_for('static', filename='images/apps_index.jpg') }}" 
                         class="card-img-top" 
                         alt="Gestión de Etiquetas NFC"
                         style="object-fit: cover; height: 200px; width: 100%;"
                         loading="lazy">
                    <div class="card-body d-flex flex-column">
                        <h5 class="card-title">Etiquetas NFC Interactivas (Tags)</h5>
                        <p class="card-text">
                            Administra etiquetas NFC y códigos QR personalizados, con importación y exportación avanzadas.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Ventajas de CEM -->
<section class="my-4 py-5 bg-light text-center">
    <div class="container">
        <h2 class="titulo-seccion">Ventajas de Nuestra Plataforma CEM</h2>
        <div class="row">
            <!-- Ventaja 1: Centralización de la Información -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-database fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Centralización de la Información</h5>
                        <p>
                            Consolidamos todos los datos e interacciones con tus clientes en una única plataforma, facilitando el acceso y la gestión eficiente.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Ventaja 2: Personalización y Omnicanalidad -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-magic fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Personalización y Omnicanalidad</h5>
                        <p>
                            Ofrece experiencias personalizadas a través de múltiples canales de comunicación, asegurando coherencia en cada punto de contacto.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Ventaja 3: Mejora de la Satisfacción y Fidelidad del Cliente -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-smile fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Mejora de la Satisfacción y Fidelidad del Cliente</h5>
                        <p>
                            Optimiza cada interacción y responde de manera eficiente a las necesidades de tus clientes, incrementando su satisfacción y lealtad.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Ventaja 4: Eficiencia Operativa -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-cogs fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Eficiencia Operativa</h5>
                        <p>
                            Automatiza procesos y gestiona recursos de manera eficiente, reduciendo costos y tiempo operativo.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Ventaja 5: Toma de Decisiones Informadas -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-chart-line fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Toma de Decisiones Informadas</h5>
                        <p>
                            Utiliza herramientas de análisis avanzado para identificar tendencias, prever comportamientos y tomar decisiones estratégicas basadas en datos reales.
                        </p>
                    </div>
                </div>
            </div>
            <!-- Ventaja 6: Seguridad y Protección de Datos -->
            <div class="col-md-6 mb-4">
                <div class="d-flex">
                    <i class="fas fa-shield-alt fa-3x text-primary me-3"></i>
                    <div>
                        <h5>Seguridad y Protección de Datos</h5>
                        <p>
                            Protegemos la información de tus clientes con estándares de seguridad avanzados, garantizando la privacidad y la integridad de tus datos.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CTA Final -->
<section class="cta-section bg-info text-white py-5 mt-4">
    <div class="container text-center">
        <h2 class="mb-4">¿Listo para Transformar la Experiencia de tus Clientes?</h2>
        <p class="lead mb-4">
            Únete a las empresas que ya están optimizando sus interacciones con clientes gracias a nuestra Plataforma CEM.
        </p>
        <a href="{{ url_for('contact') }}" class="btn btn-light btn-lg" title="Contáctanos ahora">Contáctanos</a>
    </div>
</section>

<!-- Script para controlar el video en pantallas > 768px -->
<script>
document.addEventListener("DOMContentLoaded", function() {
    if (window.innerWidth > 768) {
        const heroVideo = document.getElementById('hero-video');
        if (heroVideo) heroVideo.play();
    }
});
</script>

<!-- AOS JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    AOS.init({
        duration: 800,
        easing: 'slide',
        once: true
    });
});
</script>
{% endblock %}

----- Fin de templates/index.html -----

----- Inicio de templates/login.html -----
<!-- templates/login.html -->

{% extends 'video_base.html' %}

{% block title %}Iniciar Sesión - PulztagWeb{% endblock %}

{% block content %}
<div class="col-lg-6 offset-lg-3 col-md-8 text-center">
<div class="card login-card p-4 shadow-lg" style="background: rgba(0, 187, 255, 0); backdrop-filter: blur(5px); border-radius: 1rem; width: 100%; max-width: 400px; margin: auto;">
        <h2 class="text-center mb-4 text-white">Inciar Sesión</h2>
        <form method="POST" action="{{ url_for('main.login') }}">
            {{ form.hidden_tag() }}
            <!-- Campo oculto para el parámetro 'next' -->
            <input type="hidden" name="next" value="{{ request.args.get('next') }}">
            
            <!-- Correo Electrónico -->
            <div class="form-floating mb-3">
                {{ form.email(class="form-control", id="email", placeholder="Correo Electrónico") }}
                <label for="email">Correo Electrónico</label>
                {% for error in form.email.errors %}
                    <div class="form-text text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            
            <!-- Contraseña -->
            <div class="form-floating mb-3">
                {{ form.password(class="form-control", id="password", placeholder="Contraseña") }}
                <label for="password">Contraseña</label>
                {% for error in form.password.errors %}
                    <div class="form-text text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            
            <!-- Recordarme -->
            <div class="form-check mb-3 text-white">
                {{ form.remember(class="form-check-input", id="remember") }}
                <label class="form-check-label" for="remember">{{ form.remember.label.text }}</label>
            </div>
            
            <!-- Botón de Envío -->
            <div class="d-grid">
                <button type="submit" class="btn btn-info btn-lg">
                    {{ form.submit.label.text }}
                </button>
            </div>
        </form>
        
        <!-- Enlaces Adicionales -->
        <p class="mt-3 text-center">
            <a href="{{ url_for('main.reset_request') }}">¿Olvidaste tu contraseña?</a>
        </p>
        <p class="text-center text-white">
            ¿No tienes una cuenta? <a href="{{ url_for('main.register') }}">Regístrate</a>
        </p>
    </div>
</div>
{% endblock %}

{% block styles %}
<style>
    /* Estilos específicos para el formulario de inicio de sesión */
    .login-card {
        background-color: rgba(255, 255, 255, 0.85); /* Semi-transparente */
        backdrop-filter: blur(5px); /* Efecto de desenfoque */
    }

    /* Responsividad para pantallas pequeñas */
    @media (max-width: 576px) {
        .login-card {
            width: 90%;
            padding: 1.5rem;
        }
    }
</style>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const videos = [
            "{{ url_for('static', filename='videos/longvideo.mp4') }}"
        ];
        let videoIndex = 0;
        const videoElement = document.getElementById('hero-video');
        const sourceElement = videoElement.getElementsByTagName('source')[0];

        function playNextVideo() {
            sourceElement.src = videos[videoIndex];
            videoElement.load(); // Recargar el video con la nueva fuente
            videoElement.play(); // Intentar reproducir el video
            videoIndex = (videoIndex + 1) % videos.length;
        }

        videoElement.addEventListener('ended', function () {
            playNextVideo();
        });
    });
</script>
{% endblock %}

----- Fin de templates/login.html -----

----- Inicio de templates/order.html -----
<!-- templates/order.html -->

{% extends 'base.html' %}

{% block title %}Pedido - PulztagWeb{% endblock %}

{% block content %}
    
<!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-NC88XS28');</script>
<!-- End Google Tag Manager -->

<h2 class="titulo-seccion">Realiza tu Pedido</h2>
<p class="text-center mb-5">Completa el formulario a continuación para realizar tu pedido de dispositivos NFC personalizados.</p>

<div class="row justify-content-center">
    <div class="col-md-8 mb-4">
        <form method="POST" action="{{ url_for('order') }}" enctype="multipart/form-data" id="orderForm">
            {{ form.hidden_tag() }} <!-- CSRF token -->

            <!-- Campo Nombre -->
            <div class="mb-3">
                {{ form.nombre.label(class="form-label") }}
                {{ form.nombre(class="form-control", placeholder="Tu nombre") }}
                {% for error in form.nombre.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Campo Correo Electrónico -->
            <div class="mb-3">
                {{ form.email.label(class="form-label") }}
                {{ form.email(class="form-control", placeholder="nombre@ejemplo.com") }}
                {% for error in form.email.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Campo Selección de Dispositivo -->
            <div class="mb-3">
                {{ form.dispositivo.label(class="form-label") }}
                {{ form.dispositivo(class="form-select") }}
                {% for error in form.dispositivo.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Campo Mensaje -->
            <div class="mb-3">
                {{ form.mensaje.label(class="form-label") }}
                {{ form.mensaje(class="form-control", rows="3", placeholder="Escribe tu mensaje aquí") }}
                {% for error in form.mensaje.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>

            <!-- Sección para subir Logos -->
            <div class="mb-4">
                <label class="form-label">Subir Logos (png, jpeg, jpg) - Máximo 10 (*)</label>
                <input type="file" class="form-control" id="logoUpload" name="logos" accept=".png,.jpeg,.jpg" multiple>
                <ul class="list-group mt-2" id="logoList"></ul>
                <div id="logoError" class="text-danger mt-2" style="display: none;">Has alcanzado el máximo de 10 logos.</div>
                <p class="text-muted mt-2">(*) Sube aquí las imágenes que deseas imprimir en tus dispositivos personalizados. Nuestro equipo se encargará de ayudarte con la implementación y asegurará que tus diseños se vean espectaculares!</p>
            </div>

            <!-- Sección para subir Archivo Excel -->
            <div class="mb-4">
                <label class="form-label">Subir Archivo Excel (xlsx, xls) - Máximo 1 (*)</label>
                <input type="file" class="form-control" id="excelUpload" name="excel" accept=".xlsx,.xls">
                <ul class="list-group mt-2" id="excelList"></ul>
                <div id="excelError" class="text-danger mt-2" style="display: none;">Solo puedes subir un archivo Excel.</div>
                <p class="text-muted mt-2">(*) Cada dispositivo puede tener una configuración única. Para pedidos de gran volumen, por favor proporciona los detalles en un archivo Excel.</p>
            </div>

            <!-- Botón de Envío -->
            {{ form.submit(class="btn btn-primary") }}
        </form>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<!-- Información Bancaria Section -->
<div class="row justify-content-center mt-5">
    <div class="col-md-8">
        <div class="custom-solutions-section text-center p-5">
            <h4 class="text-white">Datos para Transferencia</h4>
            <ul class="list-unstyled">
                <li><strong>Banco:</strong> Banco de Chile</li>
                <li><strong>Tipo de Cuenta:</strong> Cuenta Corriente</li>
                <li><strong>Nombre:</strong> Pulztag SpA</li>
                <li><strong>Número de Cuenta:</strong> 00-888-08888-08</li>
                <li><strong>RUT:</strong> 88.888.888-8</li>
                <li><strong>Correo:</strong> <a href="mailto:contacto@pulztag.com" class="text-white">contacto@pulztag.com</a></li>
                <li><strong>Teléfono:</strong> <a href="tel:+56962411963" class="text-white">+56962411963</a></li>
            </ul>
        </div>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>

<script>
    $(document).ready(function () {
        // Configuración de DataTables (si es necesario)
        $('.custom-table').DataTable({
            "language": {
                "url": "https://cdn.datatables.net/plug-ins/1.11.5/i18n/es-ES.json"
            }
        });

        // Función para mostrar la sección basada en el ID (si aplicable)
        function showSection(section) {
            const sections = ['miPerfilSection', 'pulzcardsSection', 'etiquetasSection', 'bodegasSection'];
            sections.forEach(sec => {
                document.getElementById(sec).style.display = (sec === section) ? 'block' : 'none';
            });
        }

        // Función para manejar el hash y mostrar la sección correspondiente (si aplicable)
        function handleHash() {
            const hash = window.location.hash.substring(1); // Eliminar el '#'
            if (hash) {
                showSection(hash);
            } else {
                showSection('miPerfilSection'); // Sección predeterminada
            }
        }

        // Mostrar la sección correcta al cargar la página (si aplicable)
        window.addEventListener('load', handleHash, false);

        // Escuchar cambios en el hash (si aplicable)
        window.addEventListener('hashchange', handleHash, false);

        // Actualizar el hash al hacer clic en enlaces internos (si aplicable)
        document.querySelectorAll('a.nav-link.sub-link').forEach(function(link) {
            const href = link.getAttribute('href');
            if (href.startsWith('#')) { // Solo interceptar enlaces internos
                link.addEventListener('click', function(e) {
                    e.preventDefault(); // Evita el comportamiento predeterminado del enlace
                    const hash = this.getAttribute('href').substring(1); // Obtener el hash sin '#'
                    window.location.hash = hash; // Actualizar el hash en la URL
                    showSection(hash);
                });
            }
            // Si no empieza con '#', dejar que el navegador maneje la navegación
        });

        // Función para copiar la URL al portapapeles
        window.copyURL = function(url) {
            navigator.clipboard.writeText(url).then(() => {
                alert('URL copiada al portapapeles!');
            }).catch(err => {
                alert('Error al copiar la URL: ' + err);
            });
        }

        // Sidebar Toggle (si aplicable)
        const sidebar = document.getElementById('sidebar');
        const toggleBtn = document.getElementById('sidebarToggle');

        toggleBtn.addEventListener('click', function () {
            sidebar.classList.toggle('collapsed'); // Alterna la clase 'collapsed'
            if (sidebar.classList.contains('collapsed')) {
                this.innerHTML = '<i class="bi bi-chevron-right"></i>'; // Cambia el ícono al colapsar
            } else {
                this.innerHTML = '<i class="bi bi-chevron-left"></i>'; // Cambia el ícono al expandir
            }
        });

        // Manejar el checkbox "Seleccionar Todo" (si aplicable)
        $('#select_all').click(function(){
            $('input[name="selected_tags"]').prop('checked', this.checked);
        });

        // Manejar el botón de confirmación de eliminación masiva (si aplicable)
        $('#confirmDeleteBulkBtn').click(function(){
            $('#bulkDeleteForm').submit();
        });
    });
</script>
<style>
    .titulo-seccion {
        margin-top: 50px; /* Añade espacio superior */
    }
</style>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.forEach(function (tooltipTriggerEl) {
            new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
</script>
{% endblock %}

----- Fin de templates/order.html -----

----- Inicio de templates/products.html -----
<!-- templates/products.html -->

{% extends 'base.html' %}

{% block title %}Nuestros Productos - PulztagWeb{% endblock %}
{% block content %}
<div class="text-center mb-5">
        <h2 class="titulo-seccion">
            Una Herramienta Única para Experiencias Interactivas
        </h2>
    <p class="lead mb-5">
            Con nuestras Etiquetas NFC, actualiza la información de tus campañas sin necesidad de reimprimir materiales, ahorrando tiempo y recursos.
        </p>

        <!-- Grid de Productos -->
        <div class="row" style="padding: 60px 20px; background-color: #ffffffbf; text-align: center;">
            <!-- Producto 1 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Etiqueta de Sticker de RR.SS. NFC Antimetal.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/etiqueta_redes_sociales_nfc.png') }}" class="card-img-top" alt="Etiqueta Redes Sociales NFC" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse1">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: Diámetro 20/25/30/35 mm, etc.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: PVC/PET/Holograma + capa de Epoxy + capa Antimetal</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Compartir información de URL y redes sociales, tarjeta de presentación digital, etc.</li>
                            </ul>
                        </div>                        

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse1" aria-expanded="false" aria-controls="collapse1">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Producto 2 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Tarjetas PVC Inteligentes NFC.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/tarjetas_pvc_inteligentes_nfc.png') }}" class="card-img-top" alt="Tarjetas PVC Inteligentes NFC" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse2">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 85.60 * 54.00 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: PVC/PET/Madera/ABS/Metal/Papel, etc.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Compartir URL & conexión a redes sociales, identificación, pago sin efectivo, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse2" aria-expanded="false" aria-controls="collapse2">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Producto 3 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Soporte de Menú de Acrílico con QR Code y NFC.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/soporte_menu_qr_nfc.png') }}" class="card-img-top" alt="Soporte de Menú QR NFC" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse3">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 105 * 70 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: Acrílico plástico + inserto NFC</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: URL de menú NFC, guía de la ciudad, promoción en redes sociales, pago sin efectivo, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$5.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse3" aria-expanded="false" aria-controls="collapse3">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Producto 4 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Pulseras Tejidas NFC Personalizables.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/pulseras_tejidas_nfc.jpg') }}" class="card-img-top" alt="Pulseras Tejidas RFID" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse4">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 15 * 350 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: Tela/tejido/madera ecológica</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Festivales, eventos, conciertos, fiestas, conferencias, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$4.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse4" aria-expanded="false" aria-controls="collapse4">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Producto 5 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Pulsera NFC de silicona ecológica.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/pulsera_silicona.png') }}" class="card-img-top" alt="Tarjeta PVC NTAG216" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse5">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56 MHz.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 240*15*3 mm, 8 agujeros.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: Silicona ecológica.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Compartir en redes sociales, parques acuáticos, pueblos vacacionales, carnavales, gimnasios, bares, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse5" aria-expanded="false" aria-controls="collapse5">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>   
            <!-- Producto 6 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Etiqueta NFC de Redes Sociales Epoxy.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/etiqueta_nfc_redes_sociales.png') }}" class="card-img-top" alt="Etiqueta NFC Redes Sociales" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse6">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: Diámetro 20/25/30/35 mm, etc.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: Epoxy recubierto/Papel/PVC/PET/Holograma</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Compartir información de URL & redes sociales, pago sin efectivo, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse6" aria-expanded="false" aria-controls="collapse6">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Producto 7 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Tarjetas de Madera NFC Empresariales Personalizables.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/tarjetas_madera_nfc.png') }}" class="card-img-top" alt="Tarjetas de Madera NFC" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse7">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 85.60 * 54.00 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: PVC/PET/Madera/Papel, etc.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Tarjeta de presentación, compartir en redes sociales, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$5.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse7" aria-expanded="false" aria-controls="collapse7">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div> 
            <!-- Producto 8 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Tarjeta PVC Reescribible Blanca o Negra Personalizable.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/tarjeta_pvc.jpg') }}" class="card-img-top" alt="Tarjeta PVC NTAG216" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse8">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: 85.60 * 54.00 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: PVC/PET/Madera/Papel, etc.</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Tarjeta de presentación, compartir en redes sociales, etc.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse8" aria-expanded="false" aria-controls="collapse8">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>        
            <!-- Producto 9 -->
            <div class="col-lg-4">
                <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;">
                    <h4 class="card-title text-primary">Tarjetas Redondas NFC de PVC Duro NTAG personalizables.</h4>
                    <div style="margin: 10px;"></div>
                    <img src="{{ url_for('static', filename='images/productos/tarjeta_redonda_pvc_nfc.png') }}" class="card-img-top" alt="Tarjeta Redonda PVC NFC" style="object-fit: cover; height: 200px;">
                    <div class="card-body d-flex flex-column">
                        <!-- Sección Colapsable -->
                        <div class="collapse text-start" id="collapse9">
                            <ul class="list-unstyled mb-4">
                                <h6 class="card-title text-primary mb-4 mt-2 product-description">
                                    Detalle técnico
                                </h6>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Soporte: OEM/ODM</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Frecuencia: 13.56MHz</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Opciones de Tamaño: Diámetro 25 mm o personalizado</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Materiales: PVC duro</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>MOQ (Cantidad Mínima de Pedido): 100 unidades</li>
                                <li><i class="fas fa-check-circle text-info me-2"></i>Aplicaciones: Juegos, tarjeta de presentación digital, URL & conexión a redes sociales, identificación.</li>
                            </ul>
                        </div>

                        <div class="mt-auto d-flex justify-content-between align-items-center">
                            <a href="{{ url_for('order') }}" class="btn btn-outline-primary">
                                Desde <span class="fw-bold">$2.990</span> (IVA inc.)
                            </a>
                            <button class="btn btn-link p-0 text-decoration-none toggle-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse9" aria-expanded="false" aria-controls="collapse9">
                                <i class="fa-regular fa-square-caret-down square-caret-down-icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <style>
        .titulo-seccion {
            margin-top: 50px; /* Añade espacio superior */
        }
    </style>
    <!-- Estilos CSS para el Chevron -->
    <style>
        /* Estilo para hacer el chevron más grande y celeste */
        .square-caret-down-icon {
            font-size: 1.5rem; /* Aumenta el tamaño del ícono */
            color: #03c0ff; /* Color celeste (Bootstrap's text-info) */
            transition: transform 0.3s ease;
        }
    </style>
{% endblock %}

----- Fin de templates/products.html -----

----- Inicio de templates/profile.html -----
<!-- templates/profile.html -->

{% extends 'base.html' %}

{% block title %}Perfil de Usuario - PulztagWeb (Escala 1-10 NPS){% endblock %}

{% block head %}
<link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/dataTables.bootstrap5.min.css">

<style>
body {
  background-image: url("/static/images/background.jpg") !important;
  background-size: cover;
  background-attachment: fixed;
  background-position: center;
}

.d-flex {
  display: flex !important;
}
.h-100 {
  height: 100% !important;
}

#sidebar {
  height: calc(100vh - 90px - 75px); 
  overflow-y: auto;
}

/* Sidebar styles for larger screens */
@media (min-width: 768px) {
  #sidebar {
    display: block;
  }
}

/* Off-canvas sidebar styles for small screens */
@media (max-width: 767.98px) {
  #sidebar {
    display: none;
  }

  /* Asegurar que el off-canvas ocupe el 100% del ancho en móviles */
  .offcanvas-start {
    width: 250px;
  }

  /* Ajustar el padding del contenido principal en pantallas pequeñas */
  #mainContent {
    padding: 10px;
  }

  /* Ajustar el tamaño del botón del navbar en móviles */
  .navbar .btn {
    padding: 0.3rem 0.6rem;
  }
}

/* Adjust main content when sidebar is collapsed */
.collapsed {
  width: 80px !important;
}

.sidebar-transition {
  transition: all 0.3s;
}

/* Ajustes para off-canvas */
.offcanvas-custom {
  width: 250px;
}

/* Ajustes adicionales para mejorar la responsividad */
@media (max-width: 767.98px) {
  .offcanvas-custom {
    width: 100%;
  }
}
</style>
{% endblock %}

{% block content %}
<!-- NAVBAR superior con botón para abrir off-canvas en pantallas pequeñas -->
<nav class="navbar navbar-expand-md navbar-light bg-white border-bottom d-md-none">
  <div class="container-fluid">
    <button class="btn btn-outline-secondary me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasSidebar" aria-controls="offcanvasSidebar">
      <i class="bi bi-list"></i>
    </button>
  </div>
</nav>

<div class="d-md-flex h-100">
  <!-- SIDEBAR como Sidebar Fijo para Pantallas Grandes -->
  <div class="d-none d-md-flex flex-column border-end sidebar-transition" id="sidebar" style="flex-shrink: 0;">
    <div class="sidebar-header d-flex align-items-center p-3 border-bottom">
      <div class="user-display">
        <span class="user-fullname">{{ current_user.username }}</span>
      </div>
      <button id="sidebarToggle" class="btn btn-light btn-sm ms-auto" title="Expandir/Contraer Sidebar">
        <i class="bi bi-chevron-left"></i>
      </button>
    </div>

    <ul class="nav flex-column pt-2" id="sidebarMenu">
      <!-- Pulzcards -->
      <li class="nav-item mt-2">
        <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse"
           data-bs-target="#pulzcardSubmenu" aria-expanded="false" title="Pulzcards">
          <i class="bi bi-person-badge-fill"></i><span class="text-label ms-2">Pulzcards</span>
        </a>
        <ul class="collapse list-unstyled ps-0" id="pulzcardSubmenu">
          <li>
            <a href="{{ url_for('pulzcard') }}" class="nav-link sub-link">
              <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nuevo</span>
            </a>
          </li>
          <li>
            <a href="#pulzcardsSection" class="nav-link sub-link">
              <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todos</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Etiquetas -->
      <li class="nav-item mt-2">
        <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse"
           data-bs-target="#etiquetasSubmenu" aria-expanded="false" title="Etiquetas">
          <i class="bi bi-tags-fill"></i><span class="text-label ms-2">Etiquetas</span>
        </a>
        <ul class="collapse list-unstyled ps-0" id="etiquetasSubmenu">
          <li>
            <a href="#" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal"
               class="nav-link sub-link">
              <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nuevo</span>
            </a>
          </li>
          <li>
            <a href="#" data-bs-toggle="modal" data-bs-target="#importTagsModal" class="nav-link sub-link" title="Importar Etiquetas">
              <i class="bi bi-file-arrow-up-fill"></i><span class="text-label ms-1">Importar</span>
            </a>
          </li>
          <li>
            <a href="#etiquetasSection" class="nav-link sub-link">
              <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todos</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Bodegas -->
      <li class="nav-item mt-2">
        <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse" data-bs-target="#bodegasSubmenu"
           aria-expanded="false" title="Bodegas">
          <i class="bi bi-box-fill"></i><span class="text-label ms-2">Bodegas</span>
        </a>
        <ul class="collapse list-unstyled ps-0" id="bodegasSubmenu">
          <li>
            <a href="#" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal"
               class="nav-link sub-link">
              <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nueva</span>
            </a>
          </li>
          <li>
            <a href="#bodegasSection" class="nav-link sub-link">
              <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todas</span>
            </a>
          </li>
        </ul>
      </li>

      <!-- Dashboard -->
      <li class="nav-item mt-2">
        <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse" data-bs-target="#dashboardSubmenu"
           aria-expanded="false" aria-controls="dashboardSubmenu" title="Dashboard">
          <i class="fa-regular fa-chart-bar"></i><span class="text-label ms-2">Dashboard</span>
        </a>
        <ul class="collapse list-unstyled ps-0" id="dashboardSubmenu">
          <li>
            <a href="#" class="nav-link sub-link" data-bs-toggle="modal" data-bs-target="#agregarItemModal">
              <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Agregar Item</span>
            </a>
          </li>
          <div id="dashboardItemsContainer">
            {% if dashboard_items %}
              {% for item in dashboard_items %}
              <li>
                <a href="#dashboardItemDetailSection"
                   class="nav-link sub-link dashboard-item-link"
                   data-item-id="{{ item.uuid }}"
                   data-item-name="{{ item.name }}"
                   data-item-type="{{ item.item_type }}">
                  <i class="fa-solid fa-angles-right"></i><span class="text-label ms-1">{{ item.name }}</span>
                </a>
              </li>
              {% endfor %}
            {% else %}
              <li>
                <span class="text-muted ms-3">Sin items disponibles</span>
              </li>
            {% endif %}
          </div>
        </ul>
      </li>

      <hr class="my-10">

      <!-- Mi Perfil -->
      <li class="nav-item mt-2">
        <a href="#miPerfilSection" class="nav-link sidebar-link" title="Mi Perfil">
          <i class="bi bi-person-lines-fill"></i><span class="text-label ms-2">Mi Perfil</span>
        </a>
      </li>
    </ul>
  </div>

  <!-- Off-canvas Sidebar para Pantallas Pequeñas -->
  <div class="offcanvas offcanvas-start d-md-none" tabindex="-1" id="offcanvasSidebar" aria-labelledby="offcanvasSidebarLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="offcanvasSidebarLabel">{{ current_user.username }}</h5>
      <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Cerrar"></button>
    </div>
    <div class="offcanvas-body p-0">
      <ul class="nav flex-column pt-2" id="offcanvasSidebarMenu">
        <!-- Pulzcards -->
        <li class="nav-item mt-2">
          <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse"
             data-bs-target="#pulzcardSubmenuOffcanvas" aria-expanded="false" title="Pulzcards">
            <i class="bi bi-person-badge-fill"></i><span class="text-label ms-2">Pulzcards</span>
          </a>
          <ul class="collapse list-unstyled ps-0" id="pulzcardSubmenuOffcanvas">
            <li>
              <a href="{{ url_for('pulzcard') }}" class="nav-link sub-link">
                <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nuevo</span>
              </a>
            </li>
            <li>
              <a href="#pulzcardsSection" class="nav-link sub-link">
                <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todos</span>
              </a>
            </li>
          </ul>
        </li>

        <!-- Etiquetas -->
        <li class="nav-item mt-2">
          <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse"
             data-bs-target="#etiquetasSubmenuOffcanvas" aria-expanded="false" title="Etiquetas">
            <i class="bi bi-tags-fill"></i><span class="text-label ms-2">Etiquetas</span>
          </a>
          <ul class="collapse list-unstyled ps-0" id="etiquetasSubmenuOffcanvas">
            <li>
              <a href="#" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal"
                 class="nav-link sub-link">
                <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nuevo</span>
              </a>
            </li>
            <li>
              <a href="#" data-bs-toggle="modal" data-bs-target="#importTagsModal" class="nav-link sub-link" title="Importar Etiquetas">
                <i class="bi bi-file-arrow-up-fill"></i><span class="text-label ms-1">Importar</span>
              </a>
            </li>
            <li>
              <a href="#etiquetasSection" class="nav-link sub-link">
                <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todos</span>
              </a>
            </li>
          </ul>
        </li>

        <!-- Bodegas -->
        <li class="nav-item mt-2">
          <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse" data-bs-target="#bodegasSubmenuOffcanvas"
             aria-expanded="false" title="Bodegas">
            <i class="bi bi-box-fill"></i><span class="text-label ms-2">Bodegas</span>
          </a>
          <ul class="collapse list-unstyled ps-0" id="bodegasSubmenuOffcanvas">
            <li>
              <a href="#" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal"
                 class="nav-link sub-link">
                <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Crear Nueva</span>
              </a>
            </li>
            <li>
              <a href="#bodegasSection" class="nav-link sub-link">
                <i class="bi bi-eye-fill"></i><span class="text-label ms-1">Ver Todas</span>
              </a>
            </li>
          </ul>
        </li>

        <!-- Dashboard -->
        <li class="nav-item mt-2">
          <a href="#" class="nav-link sidebar-link" data-bs-toggle="collapse" data-bs-target="#dashboardSubmenuOffcanvas"
             aria-expanded="false" aria-controls="dashboardSubmenuOffcanvas" title="Dashboard">
            <i class="fa-regular fa-chart-bar"></i><span class="text-label ms-2">Dashboard</span>
          </a>
          <ul class="collapse list-unstyled ps-0" id="dashboardSubmenuOffcanvas">
            <li>
              <a href="#" class="nav-link sub-link" data-bs-toggle="modal" data-bs-target="#agregarItemModal">
                <i class="bi bi-plus-circle-fill"></i><span class="text-label ms-1">Agregar Item</span>
              </a>
            </li>
            <div id="dashboardItemsContainerOffcanvas">
              {% if dashboard_items %}
                {% for item in dashboard_items %}
                <li>
                  <a href="#dashboardItemDetailSection"
                     class="nav-link sub-link dashboard-item-link"
                     data-item-id="{{ item.uuid }}"
                     data-item-name="{{ item.name }}"
                     data-item-type="{{ item.item_type }}">
                    <i class="fa-solid fa-angles-right"></i><span class="text-label ms-1">{{ item.name }}</span>
                  </a>
                </li>
                {% endfor %}
              {% else %}
                <li>
                  <span class="text-muted ms-3">Sin items disponibles</span>
                </li>
              {% endif %}
            </div>
          </ul>
        </li>

        <hr class="my-10">

        <!-- Mi Perfil -->
        <li class="nav-item mt-2">
          <a href="#miPerfilSection" class="nav-link sidebar-link" title="Mi Perfil">
            <i class="bi bi-person-lines-fill"></i><span class="text-label ms-2">Mi Perfil</span>
          </a>
        </li>
      </ul>
    </div>
  </div>

  <!-- CONTENIDO PRINCIPAL -->
  <div class="flex-grow-1" id="mainContent" style="padding:20px; overflow-y: auto;">
    <!-- Seccion Perfil -->
    <div id="miPerfilSection">
      <h2 class="text-center mb-4">Mi Perfil</h2>
      <div class="container-fluid mb-5">
        <div class="row">
          <div class="col-md-6">
            <h4>Información Personal</h4>
            <p><strong>Nombre de Usuario:</strong> {{ current_user.username }}</p>
            <p><strong>Correo Electrónico:</strong> {{ current_user.email }}</p>
          </div>
          <div class="col-md-6 text-end">
            <a href="{{ url_for('main.account') }}" class="btn btn-primary">Editar Perfil</a>
          </div>
        </div>
      </div>
      <hr class="my-5">
    </div>

    <!-- Seccion Pulzcards -->
    <div id="pulzcardsSection" style="display:none;">
      <h4>Tus Pulzcards</h4>
      {% if pulzcards %}
      <form method="POST" action="{{ url_for('delete_bulk_pulzcards') }}" id="bulkDeletePulzcardForm">
        {{ bulk_delete_pulzcard_form.hidden_tag() }}

        <div class="action-bar-wrapper">
          <div class="action-bar">
            <button type="button"
                    class="action-btn btn-import"
                    data-bs-toggle="modal"
                    data-bs-target="#importPulzcardModal"
                    title="Importar Pulzcards desde un archivo Excel">
              <i class="bi bi-upload"></i>
            </button>
            <button type="button"
                    class="action-btn btn-export"
                    onclick="exportSelectedPulzcards()"
                    title="Exportar Pulzcards seleccionadas">
              <i class="bi bi-download"></i>
            </button>
            <button type="button"
                    class="action-btn btn-delete"
                    data-bs-toggle="modal"
                    data-bs-target="#confirmDeleteBulkPulzcardsModal"
                    title="Eliminar Pulzcards seleccionadas">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>
        <hr class="my-10">

        <div class="table-responsive">
          <table class="table table-hover custom-table">
            <thead>
              <tr>
                <th><input type="checkbox" id="select_all_pulzcards" form="bulkDeletePulzcardForm"></th>
                <th>Nombre Tarjeta</th>
                <th>Nombre Usuario</th>
                <th>Organización</th>
                <th>Email</th>
                <th>Fecha Creación</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              {% for card in pulzcards %}
              <tr>
                <td>
                  <input type="checkbox" name="selected_pulzcards" value="{{ card.card_id }}" form="bulkDeletePulzcardForm">
                </td>
                <td>{{ card.card_name }}</td>
                <td>{{ card.first_name }} {{ card.last_name }}</td>
                <td>{{ card.organization }}</td>
                <td>{{ card.email }}</td>
                <td>{{ card.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
                <td>
                  <div class="d-none d-md-flex gap-2">
                    <a href="{{ url_for('pulzcard_card', card_id=card.card_id) }}"
                       class="btn btn-outline-secondary btn-sm" target="_blank">
                      Ver
                    </a>
                    <a href="{{ url_for('edit_pulzcard', card_id=card.card_id, next='pulzcardsSection') }}"
                       class="btn btn-outline-secondary btn-sm">
                      Editar
                    </a>
                    <a href="{{ url_for('pulzcard_qrcode', card_id=card.card_id) }}"
                       class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                      <i class="fas fa-qrcode"></i>
                    </a>
                    <form action="{{ url_for('delete_pulzcard', card_id=card.card_id) }}" method="POST" style="display:inline;">
                      {{ delete_forms[card.id].hidden_tag() }}
                      <button type="submit"
                              onclick="return confirm('¿Estás seguro de que deseas eliminar esta Pulzcard?')"
                              style="background:none; border:none; padding:0; cursor:pointer;">
                        <i class="fa-solid fa-delete-left fa-rotate-by"
                           style="color: #ff5957; --fa-rotate-angle: 0deg; font-size: 1.8em"></i>
                      </button>
                    </form>
                  </div>
                  <div class="d-md-none">
                    <div class="dropdown">
                      <button class="btn btn-outline-secondary btn-sm dropdown-toggle"
                              type="button"
                              id="dropdownMenuButtonPulz{{ card.card_id }}"
                              data-bs-toggle="dropdown" aria-expanded="false">
                        Acciones
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonPulz{{ card.card_id }}">
                        <li>
                          <a class="dropdown-item"
                             href="{{ url_for('pulzcard_card', card_id=card.card_id) }}"
                             target="_blank">
                            <i class="fas fa-eye me-2"></i>Ver
                          </a>
                        </li>
                        <li>
                          <a class="dropdown-item"
                             href="{{ url_for('edit_pulzcard', card_id=card.card_id, next='pulzcardsSection') }}">
                            <i class="fas fa-edit me-2"></i>Editar
                          </a>
                        </li>
                        <li>
                          <a class="dropdown-item"
                             href="{{ url_for('pulzcard_qrcode', card_id=card.card_id) }}"
                             title="Ver Código QR">
                            <i class="fas fa-qrcode me-2"></i>Ver QR
                          </a>
                        </li>
                        <li>
                          <form action="{{ url_for('delete_pulzcard', card_id=card.card_id) }}" method="POST" style="display:inline;">
                            {{ delete_forms[card.id].hidden_tag() }}
                            <button type="submit"
                                    onclick="return confirm('¿Estás seguro de que deseas eliminar esta Pulzcard?')"
                                    class="dropdown-item bg-danger text-white">
                              <i class="fa-regular fa-eraser me-2"></i>Eliminar
                            </button>
                          </form>
                        </li>
                      </ul>
                    </div>
                  </div>
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </form>

      <div class="modal fade" id="confirmDeleteBulkPulzcardsModal" tabindex="-1" aria-labelledby="confirmDeleteBulkPulzcardsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="confirmDeleteBulkPulzcardsModalLabel">Confirmar Eliminación</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
              <p>¿Estás seguro de que deseas eliminar las Pulzcards seleccionadas? Esta acción no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <button type="button" class="btn btn-danger" id="confirmDeleteBulkPulzcardsBtn">Eliminar</button>
            </div>
          </div>
        </div>
      </div>
      {% else %}
      <p>No has creado ninguna Pulzcard aún. <a href="{{ url_for('pulzcard') }}">Crear una Pulzcard</a>.</p>
      {% endif %}
      <div class="mt-3">
        <a href="{{ url_for('pulzcard') }}" class="btn btn-secondary">
          <i class="fas fa-user-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i> Añadir
        </a>
      </div>
      <hr class="my-5">
    </div>

    <!-- Etiquetas -->
    <div id="etiquetasSection" style="display:none;">
      <h4>Tus Etiquetas y QR Code</h4>
      {% if tags %}
      <form method="POST" action="{{ url_for('delete_bulk_tags') }}" id="bulkDeleteForm">
        {{ bulk_delete_tag_form.hidden_tag() }}
        <div class="action-bar-wrapper">
          <div class="action-bar">
            <button type="button"
                    class="action-btn btn-import"
                    data-bs-toggle="modal"
                    data-bs-target="#importTagsModal"
                    title="Importar etiquetas desde un archivo">
              <i class="bi bi-upload"></i>
            </button>
            <button type="button"
                    class="action-btn btn-export"
                    onclick="exportSelectedTags()"
                    title="Exportar etiquetas seleccionadas">
              <i class="bi bi-download"></i>
            </button>
            <button type="button"
                    class="action-btn btn-delete"
                    data-bs-toggle="modal"
                    data-bs-target="#confirmDeleteBulkModal"
                    title="Eliminar etiquetas seleccionadas">
              <i class="bi bi-trash"></i>
            </button>
          </div>
        </div>
      </form>

      <div class="modal fade" id="confirmDeleteBulkModal" tabindex="-1" aria-labelledby="confirmDeleteBulkModalLabel" aria-hidden="true">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="confirmDeleteBulkModalLabel">Confirmar Eliminación</h5>
              <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
            </div>
            <div class="modal-body">
              <p>¿Estás seguro de que deseas eliminar la(s) etiqueta(s) seleccionada(s)? Esta acción no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
              <button type="button" class="btn btn-danger" id="confirmDeleteBulkBtn">Eliminar</button>
            </div>
          </div>
        </div>
      </div>

      <hr class="my-10">

      <div class="table-responsive">
        <table class="table table-hover custom-table">
          <thead>
            <tr>
              <th><input type="checkbox" id="select_all" form="bulkDeleteForm"></th>
              <th>Nombre Etiqueta</th>
              <th>URL destino</th>
              <th>URL enlace</th>
              <th>Vistas</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for tag in tags %}
            <tr>
              <td>
                <input type="checkbox" name="selected_tags" value="{{ tag.tag_id }}" form="bulkDeleteForm">
              </td>
              <td>{{ tag.tag_name }}</td>
              <td>
                <a href="{{ tag.redirect_url }}" target="_blank">
                {% if tag.redirect_url|length > 30 %}
                  {{ tag.redirect_url|slice(0,30) }}...
                {% else %}
                  {{ tag.redirect_url }}
                {% endif %}
                </a>
              </td>
              <td>
                {% set generated_url = url_for('redirect_tag', tag_id=tag.tag_id, _external=True) %}
                {% if generated_url|length > 30 %}
                  <a href="{{ generated_url }}" target="_blank">{{ generated_url|slice(0,30) }}...</a>
                {% else %}
                  <a href="{{ generated_url }}" target="_blank">{{ generated_url }}</a>
                {% endif %}
              </td>
              <td>{{ tag.vistas }}</td>
              <td>
                <div class="d-none d-md-flex gap-2">
                  <button type="button" class="btn btn-outline-secondary btn-sm" onclick="copyURL('{{ generated_url }}')">Copiar</button>
                  <a href="{{ url_for('edit_tag', tag_id=tag.tag_id, next='etiquetasSection') }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                  <a href="{{ url_for('tag_qrcode', tag_id=tag.tag_id) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                    <i class="fas fa-qrcode"></i>
                  </a>
                  <form action="{{ url_for('delete_tag', tag_id=tag.tag_id) }}" method="POST" style="display:inline;">
                    {{ delete_tag_forms[tag.id].hidden_tag() }}
                    <button type="submit"
                            onclick="return confirm('¿Estás seguro de que deseas eliminar esta etiqueta?')"
                            style="background:none; border:none; padding:0; cursor:pointer;">
                      <i class="fa-solid fa-delete-left fa-rotate-by" style="color: #ff5957; --fa-rotate-angle: 0deg; font-size: 1.8em"></i>
                    </button>
                  </form>
                </div>
                <div class="d-md-none">
                  <div class="dropdown">
                    <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButtonTag{{ tag.tag_id }}" data-bs-toggle="dropdown" aria-expanded="false">
                      Acciones
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonTag{{ tag.tag_id }}">
                      <li>
                        <a href="#" class="dropdown-item"
                           onclick="copyURL('{{ generated_url }}'); return false;">
                          <i class="fas fa-copy me-2"></i>Copiar URL
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="{{ url_for('edit_tag', tag_id=tag.tag_id, next='etiquetasSection') }}">
                          <i class="fas fa-edit me-2"></i>Editar
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="{{ url_for('tag_qrcode', tag_id=tag.tag_id) }}" title="Ver Código QR">
                          <i class="fas fa-qrcode me-2"></i>Ver QR
                        </a>
                      </li>
                      <li>
                        <form action="{{ url_for('delete_tag', tag_id=tag.tag_id) }}" method="POST" style="display:inline;">
                          {{ delete_tag_forms[tag.id].hidden_tag() }}
                          <button type="submit"
                                  onclick="return confirm('¿Estás seguro de que deseas eliminar esta etiqueta?')"
                                  class="dropdown-item bg-danger text-white">
                            <i class="fa-regular fa-eraser me-2"></i>Eliminar
                          </button>
                        </form>
                      </li>
                    </ul>
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p>No has creado ninguna etiqueta aún.
        <a href="#" class="text-decoration-underline" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal">Crear una Etiqueta</a>.
      </p>
      {% endif %}
      <div class="mt-3">
        <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal">
          <i class="fa-regular fa-square-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i> Añadir
        </button>
      </div>
      <hr class="my-5">
    </div>

    <!-- BODEGAS -->
    <div id="bodegasSection" style="display:none;">
      <h4>Bodegas</h4>
      {% if bodegas %}
      <div class="table-responsive">
        <table class="table table-hover custom-table">
          <thead>
            <tr>
              <th>ID Bodega</th>
              <th>Nombre</th>
              <th>Fecha de Creación</th>
              <th>Acciones</th>
            </tr>
          </thead>
          <tbody>
            {% for bodega in bodegas %}
            <tr>
              <td>
                <a href="{{ url_for('view_bodega', uuid_bodega=bodega.uuid) }}">
                  {{ bodega.id_bodega }}
                </a>
              </td>
              <td>{{ bodega.nombre }}</td>
              <td>{{ bodega.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</td>
              <td>
                <div class="d-none d-md-flex gap-2">
                  <a href="{{ url_for('bodega_qrcode', uuid_bodega=bodega.uuid) }}"
                     class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                    <i class="fas fa-qrcode"></i>
                  </a>
                  <a href="{{ url_for('edit_bodega', uuid_bodega=bodega.uuid, next='bodegasSection') }}"
                     class="btn btn-outline-secondary btn-sm">Editar</a>
                  <form action="{{ url_for('delete_bodega', uuid_bodega=bodega.uuid) }}"
                        method="POST" style="display:inline;">
                    {{ delete_bodega_forms[bodega.uuid].hidden_tag() }}
                    <button type="submit"
                            onclick="return confirm('¿Estás seguro de que deseas eliminar esta bodega?')"
                            style="background:none; border:none; padding:0; cursor:pointer;">
                      <i class="fa-solid fa-delete-left fa-rotate-by" style="color: #ff5957; --fa-rotate-angle: 0deg; font-size: 1.8em"></i>
                    </button>
                  </form>
                </div>
                <div class="d-md-none">
                  <div class="dropdown">
                    <button class="btn btn-outline-secondary btn-sm dropdown-toggle"
                            type="button" id="dropdownMenuButtonBodega{{ bodega.uuid }}"
                            data-bs-toggle="dropdown" aria-expanded="false">
                      Acciones
                    </button>
                    <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonBodega{{ bodega.uuid }}">
                      <li>
                        <a href="{{ url_for('bodega_qrcode', uuid_bodega=bodega.uuid) }}" class="dropdown-item" title="Ver Código QR">
                          <i class="fas fa-qrcode me-2"></i>Ver QR
                        </a>
                      </li>
                      <li>
                        <a class="dropdown-item" href="{{ url_for('edit_bodega', uuid_bodega=bodega.uuid, next='bodegasSection') }}">
                          <i class="fas fa-edit me-2"></i>Editar
                        </a>
                      </li>
                      <li>
                        <form action="{{ url_for('delete_bodega', uuid_bodega=bodega.uuid) }}" method="POST" style="display:inline;">
                          {{ delete_bodega_forms[bodega.uuid].hidden_tag() }}
                          <button type="submit"
                                  onclick="return confirm('¿Estás seguro de que deseas eliminar esta bodega?')"
                                  class="dropdown-item bg-danger text-white">
                            <i class="fa-regular fa-eraser me-2"></i>Eliminar
                          </button>
                        </form>
                      </li>
                    </ul>
                  </div>
                </div>
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p>No has creado ninguna bodega aún.
        <a href="#" class="text-decoration-underline" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal">Crear una Bodega</a>.
      </p>
      {% endif %}
      <div class="mt-3">
        <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal">
          <i class="fa-regular fa-square-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i> Añadir
        </button>
      </div>
    </div>

    <!-- Sección DETALLE de Ítem de Dashboard -->
    <div id="dashboardItemDetailSection" style="display:none;">
      <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="d-flex flex-column">
          <h2 class="mb-0" id="dashboardItemName"></h2>
          <small class="text-muted" id="dashboardItemType"></small>
        </div>
        <div class="d-flex align-items-center gap-3" id="dashboardItemActions">
          <a href="#" id="surveyLink" target="_blank" class="btn btn-sm btn-primary" style="display:none;">
            <i class="bi bi-check2-circle me-1"></i>Responder
          </a>
          <button class="btn btn-sm btn-secondary" id="copySurveyBtn" style="display:none;">
            <i class="bi bi-clipboard me-1"></i>Copiar URL
          </button>
          <button class="btn btn-sm btn-outline-success" id="showSurveyQRBtn" style="display:none;">
            <i class="fas fa-qrcode"></i> QR
          </button>
          <button class="btn btn-sm btn-danger" id="eliminarItemBtn">
            <i class="bi bi-trash-fill"></i> Eliminar
          </button>
        </div>
      </div>
      <hr class="my-4">

      <div id="dashboardItemStats" style="display:none;">
        <h4 class="mb-3">Estadísticas de Valoraciones (últimos 10 días)</h4>
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div class="d-flex align-items-center gap-2">
            <button id="showTableBtn" class="btn btn-outline-primary btn-sm">Ver Tabla</button>
            <button id="showChartBtn" class="btn btn-outline-secondary btn-sm">Ver Gráfico</button>
          </div>
          <div>
            <select id="chartIndicatorSelect" class="form-select form-select-sm" style="width: 220px;">
              <option value="count" selected>Cantidad de Evaluaciones</option>
              <option value="average">Promedio de Puntajes</option>
              <option value="nps">NPS Ponderado</option>
              <option value="promoters">Clientes Promotores (%)</option>
              <option value="passives">Clientes Neutros (%)</option>
              <option value="detractors">Clientes Detractores (%)</option>
              <option value="stacked">Gráfico Barras Apiladas</option>
            </select>
          </div>
        </div>

        <div id="tableContainer">
          <table class="table table-bordered text-center" id="ratingsTable">
            <thead>
              <tr id="ratingsHeader">
                <th>Valoración</th>
              </tr>
            </thead>
            <tbody>
              <tr id="rating10Row"><th>10</th></tr>
              <tr id="rating9Row"><th>9</th></tr>
              <tr id="rating8Row"><th>8</th></tr>
              <tr id="rating7Row"><th>7</th></tr>
              <tr id="rating6Row"><th>6</th></tr>
              <tr id="rating5Row"><th>5</th></tr>
              <tr id="rating4Row"><th>4</th></tr>
              <tr id="rating3Row"><th>3</th></tr>
              <tr id="rating2Row"><th>2</th></tr>
              <tr id="rating1Row"><th>1</th></tr>
              <tr id="totalRow"><th>Total</th></tr>
            </tbody>
          </table>
        </div>

        <div id="chartContainer" style="display:none;">
          <canvas id="myChart"></canvas>
        </div>

        <div id="dayDetailsContainer" style="display:none; margin-top: 20px;">
          <h5 id="detailsTitle"></h5>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>Evaluación (1 a 10)</th>
                <th>Comentario</th>
              </tr>
            </thead>
            <tbody id="dayDetailsBody"></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- MODALES para Pulzcards, Etiquetas, Bodegas, Dashboard Items -->
<!-- Modal Importar Pulzcards -->
<div class="modal fade" id="importPulzcardModal" tabindex="-1" aria-labelledby="importPulzcardModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('import_pulzcards') }}" enctype="multipart/form-data">
        {{ import_pulzcards_form.hidden_tag() }}
        <div class="modal-header">
          <h5 class="modal-title" id="importPulzcardModalLabel">Importar Pulzcards desde Excel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p><strong>Cómo Importar:</strong></p>
          <p>Asegúrate de que tu archivo Excel tenga al menos las columnas:</p>
          <table class="table table-bordered">
            <thead>
              <tr>
                {% for field in pulzcard_fields %}
                <th>{{ field }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              <tr>
                {% for _ in pulzcard_fields %}
                <td>Ejemplo</td>
                {% endfor %}
              </tr>
            </tbody>
          </table>
          <div class="mb-3">
            <label for="excelFilePulzcards" class="form-label">Selecciona tu archivo Excel</label>
            {{ import_pulzcards_form.excelFile(class="form-control", id="excelFilePulzcards", required=True) }}
            {% for error in import_pulzcards_form.excelFile.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          {{ import_pulzcards_form.submit(class="btn btn-primary") }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Agregar Etiqueta -->
<div class="modal fade" id="agregarEtiquetaModal" tabindex="-1" aria-labelledby="agregarEtiquetaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('create_tag') }}">
        {{ tag_form.hidden_tag() }}
        <div class="modal-header">
          <h5 class="modal-title" id="agregarEtiquetaModalLabel">Agregar Nueva Etiqueta</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            {{ tag_form.tag_name.label(class="form-label") }}
            {{ tag_form.tag_name(class="form-control", placeholder="Nombre de la Etiqueta") }}
            {% for error in tag_form.tag_name.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="mb-3">
            {{ tag_form.redirect_url.label(class="form-label") }}
            {{ tag_form.redirect_url(class="form-control", placeholder="URL de Redirección") }}
            {% for error in tag_form.redirect_url.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          {{ tag_form.submit(class="btn btn-success") }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Importar Etiquetas -->
<div class="modal fade" id="importTagsModal" tabindex="-1" aria-labelledby="importTagsModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('import_tags') }}" enctype="multipart/form-data">
        {{ import_tags_form.hidden_tag() }}
        <div class="modal-header">
          <h5 class="modal-title" id="importTagsModalLabel">Importar Etiquetas desde Excel</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p><strong>Cómo Importar:</strong></p>
          <p>Asegúrate de que tu archivo Excel tenga las columnas:</p>
          <table class="table table-bordered">
            <thead>
              <tr>
                {% for field in tag_fields %}
                <th>{{ field }}</th>
                {% endfor %}
              </tr>
            </thead>
            <tbody>
              <tr>
                {% for _ in tag_fields %}
                <td>Ejemplo de dato</td>
                {% endfor %}
              </tr>
            </tbody>
          </table>
          <div class="mb-3">
            <label for="excelFile" class="form-label">Selecciona tu archivo Excel</label>
            {{ import_tags_form.excelFile(class="form-control", id="excelFile", required=True) }}
            {% for error in import_tags_form.excelFile.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          {{ import_tags_form.submit(class="btn btn-primary") }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Agregar Bodega -->
<div class="modal fade" id="agregarBodegaModal" tabindex="-1" aria-labelledby="agregarBodegaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('create_bodega') }}">
        {{ bodega_form.hidden_tag() }}
        <div class="modal-header">
          <h5 class="modal-title" id="agregarBodegaModalLabel">Agregar Nueva Bodega</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            {{ bodega_form.nombre.label(class="form-label") }}
            {{ bodega_form.nombre(class="form-control", placeholder="Nombre de la Bodega") }}
            {% for error in bodega_form.nombre.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="mb-3">
            {{ bodega_form.ubicacion.label(class="form-label") }}
            {{ bodega_form.ubicacion(class="form-control", placeholder="Ubicación") }}
            {% for error in bodega_form.ubicacion.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
          <div class="mb-3">
            {{ bodega_form.notas.label(class="form-label") }}
            {{ bodega_form.notas(class="form-control", placeholder="Notas") }}
            {% for error in bodega_form.notas.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          {{ bodega_form.submit(class="btn btn-success") }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Agregar Item Dashboard -->
<div class="modal fade" id="agregarItemModal" tabindex="-1" aria-labelledby="agregarItemModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="agregarItemForm">
        <div class="modal-header">
          <h5 class="modal-title" id="agregarItemModalLabel">Agregar Nuevo Item al Dashboard</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="itemNameInput" class="form-label">Nombre del Item</label>
            <input type="text" class="form-control" id="itemNameInput" name="name" required>
          </div>
          <div class="mb-3">
            <label for="itemTypeSelect" class="form-label">Tipo de Item</label>
            <select class="form-select" id="itemTypeSelect" name="item_type" required>
              <option value="" selected disabled>Selecciona un tipo</option>
              <option value="Evaluación de Clientes">Evaluación de Clientes (NPS 1-10)</option>
              <option value="Evaluación de Semáforo">Evaluación de Semáforo (1-3)</option>
              <option value="Visualizaciones diarias">Visualizaciones Diarias</option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-success">Agregar</button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Modal Eliminar Item Dashboard -->
<div class="modal fade" id="confirmDeleteDashboardItemModal" tabindex="-1" aria-labelledby="confirmDeleteDashboardItemModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form id="deleteDashboardItemForm">
        <div class="modal-header">
          <h5 class="modal-title" id="confirmDeleteDashboardItemModalLabel">Confirmar Eliminación</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p>¿Estás seguro de que deseas eliminar este ítem del Dashboard? Esta acción no se puede deshacer.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
          <button type="submit" class="btn btn-danger">Eliminar</button>
        </div>
      </form>
    </div>
  </div>
</div>

{% if bodega_form.errors %}
<script>
var agregarBodegaModal = new bootstrap.Modal(document.getElementById('agregarBodegaModal'));
agregarBodegaModal.show();
</script>
{% endif %}

{% if tag_form.errors %}
<script>
var agregarEtiquetaModal = new bootstrap.Modal(document.getElementById('agregarEtiquetaModal'));
agregarEtiquetaModal.show();
</script>
{% endif %}
{% endblock %}

{% block scripts %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// ----------------------------------------------------------------------------------
// Al cargar DOM
$(document).ready(function() {
  // 1) Inicializa DataTables
  $('.custom-table').DataTable({
    language: {
      url: "https://cdn.datatables.net/plug-ins/1.11.5/i18n/es-ES.json"
    }
  });

  // 2) Control de secciones con hash
  function showSection(section) {
    var sections = [
      'miPerfilSection',
      'pulzcardsSection',
      'etiquetasSection',
      'bodegasSection',
      'dashboardItemDetailSection'
    ];
    sections.forEach(function(sec) {
      var el = document.getElementById(sec);
      if (el) {
        el.style.display = (sec === section) ? 'block' : 'none';
      }
    });
  }
  function handleHash() {
    var hash = window.location.hash.substring(1);
    if (hash) {
      showSection(hash);
    } else {
      showSection('miPerfilSection');
    }
  }
  window.addEventListener('load', handleHash, false);
  window.addEventListener('hashchange', handleHash, false);
  
  // Función común para manejar clics en los items del Dashboard
  function handleDashboardItemClick(e, element){
    e.preventDefault();
    var name = $(element).data('item-name');
    var type = $(element).data('item-type');
    var itemId = $(element).data('item-id');

    // Mostrar en el DOM
    $('#dashboardItemName').text(name);
    $('#dashboardItemType').text(type);
    $('#eliminarItemBtn').data('item-id', itemId);

    // Si es un tipo que admite encuesta
    if (type === "Evaluación de Clientes" || type === "Evaluación de Semáforo") {
        // Construye la URL de la encuesta (reemplaza ITEMUUID con itemId)
        var surveyUrl = "{{ url_for('survey', item_uuid='ITEMUUID', _external=True) }}".replace('ITEMUUID', itemId);

        // Mostrar/actualizar link de "Responder Encuesta"
        $('#surveyLink')
            .attr('href', surveyUrl)
            .show();

        // Botón para copiar la URL
        $('#copySurveyBtn')
            .off('click')
            .on('click', function() {
                navigator.clipboard.writeText(surveyUrl)
                .then(function() {
                    alert('URL copiada al portapapeles!');
                })
                .catch(function(err) {
                    alert('Error al copiar la URL: ' + err);
                });
            })
            .show();

        // Botón para ver el QR de la encuesta
        $('#showSurveyQRBtn')
            .off('click')
            .on('click', function() {
                // Abrimos la ruta /survey_qrcode/<itemId> en otra pestaña
                window.open('/survey_qrcode/' + itemId, '_blank');
            })
            .show();

        // Mostrar contenedor de estadísticas y renderizar la tabla
        $('#dashboardItemStats').show();
        renderLast10DaysTable(itemId, type);

    } else {
        // Ocultar si no es un ítem que admita encuesta
        $('#surveyLink').hide();
        $('#copySurveyBtn').hide();
        $('#showSurveyQRBtn').hide();
        $('#dashboardItemStats').hide();
    }

    // Cambiar sección a "Detalle de Ítem"
    showSection('dashboardItemDetailSection');
  }

  // Event handler para dashboard items en el sidebar fijo
  $('#dashboardItemsContainer').on('click', '.dashboard-item-link', function(e) {
      handleDashboardItemClick(e, this);
      // Cerrar offcanvas si está abierto (solo para pantallas pequeñas)
      var offcanvasElement = document.getElementById('offcanvasSidebar');
      if (offcanvasElement) {
        var offcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);
        if (offcanvas) {
          offcanvas.hide();
        }
      }
  });

  // Event handler para dashboard items en el offcanvas sidebar
  $('#dashboardItemsContainerOffcanvas').on('click', '.dashboard-item-link', function(e) {
      handleDashboardItemClick(e, this);
      // Cerrar offcanvas
      var offcanvasElement = document.getElementById('offcanvasSidebar');
      if (offcanvasElement) {
        var offcanvas = bootstrap.Offcanvas.getInstance(offcanvasElement);
        if (offcanvas) {
          offcanvas.hide();
        }
      }
  });

  // 3) Copiar URL al portapapeles
  window.copyURL = function(url) {
    navigator.clipboard.writeText(url).then(function(){
      alert('URL copiada al portapapeles!');
    }).catch(function(err){
      alert('Error al copiar la URL: ' + err);
    });
  };

  // 4) Toggle sidebar (collapse on large screens)
  var sidebar = document.getElementById('sidebar');
  var toggleBtn = document.getElementById('sidebarToggle');
  if (sidebar && toggleBtn) {
    toggleBtn.addEventListener('click', function() {
      sidebar.classList.toggle('collapsed');
      if (sidebar.classList.contains('collapsed')) {
        this.innerHTML = '<i class="bi bi-chevron-right"></i>';
      } else {
        this.innerHTML = '<i class="bi bi-chevron-left"></i>';
      }
    });
  }

  // 5) Selección en masa de Etiquetas
  var selectAllTagsCheckbox = document.getElementById('select_all');
  if (selectAllTagsCheckbox) {
    selectAllTagsCheckbox.addEventListener('click', function() {
      var checkboxes = document.querySelectorAll('input[name="selected_tags"]');
      checkboxes.forEach(function(ch) {
        ch.checked = selectAllTagsCheckbox.checked;
      });
    });
  }
  var confirmDeleteBulkBtn = document.getElementById('confirmDeleteBulkBtn');
  if (confirmDeleteBulkBtn) {
    confirmDeleteBulkBtn.addEventListener('click', function(){
      document.getElementById('bulkDeleteForm').submit();
    });
  }

  // 6) Exportar Etiquetas
  window.exportSelectedTags = function() {
    var selectedTags = document.querySelectorAll('input[name="selected_tags"]:checked');
    if (selectedTags.length === 0) {
      alert('Por favor, selecciona al menos una etiqueta para exportar.');
      return;
    }
    var tagIds = Array.from(selectedTags).map(function(tag){ return tag.value; });
    fetch('{{ url_for("export_tags") }}', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': '{{ csrf_token() }}'
      },
      body: JSON.stringify({ tag_ids: tagIds })
    })
    .then(function(response){
      if (!response.ok) {
        return response.json().then(function(data){ throw new Error(data.error); });
      }
      return response.blob();
    })
    .then(function(blob){
      var url = window.URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.style.display='none';
      a.href=url;
      a.download='tags_export.xlsx';
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    })
    .catch(function(error){
      console.error('Error:', error);
      alert('Hubo un error al exportar las etiquetas: ' + error.message);
    });
  };

  // 7) Selección en masa Pulzcards
  var selectAllPulzcardsCheckbox = document.getElementById('select_all_pulzcards');
  if (selectAllPulzcardsCheckbox) {
    selectAllPulzcardsCheckbox.addEventListener('click', function(){
      var checkboxes = document.querySelectorAll('input[name="selected_pulzcards"]');
      checkboxes.forEach(function(ch){ ch.checked = selectAllPulzcardsCheckbox.checked; });
    });
  }
  var confirmDeleteBulkPulzcardsBtn = document.getElementById('confirmDeleteBulkPulzcardsBtn');
  if (confirmDeleteBulkPulzcardsBtn) {
    confirmDeleteBulkPulzcardsBtn.addEventListener('click', function(){
      document.getElementById('bulkDeletePulzcardForm').submit();
    });
  }

  // 8) Exportar Pulzcards
  window.exportSelectedPulzcards = function() {
    var selected = document.querySelectorAll('input[name="selected_pulzcards"]:checked');
    if (selected.length === 0) {
      alert('Por favor, selecciona al menos una Pulzcard para exportar.');
      return;
    }
    var pulz_ids = Array.from(selected).map(function(el){ return el.value; });
    fetch('{{ url_for("export_pulzcards") }}', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-CSRFToken': '{{ csrf_token() }}'
      },
      body: JSON.stringify({ pulz_ids: pulz_ids })
    })
    .then(function(response){
      if (!response.ok) {
        return response.json().then(function(data){ throw new Error(data.error); });
      }
      return response.blob();
    })
    .then(function(blob){
      var url = window.URL.createObjectURL(blob);
      var a = document.createElement('a');
      a.style.display='none';
      a.href=url;
      a.download='pulzcards_export.xlsx';
      document.body.appendChild(a);
      a.click();
      window.URL.revokeObjectURL(url);
      document.body.removeChild(a);
    })
    .catch(function(error){
      console.error('Error:', error);
      alert('Hubo un error al exportar las Pulzcards: ' + error.message);
    });
  };

  // 9) Dashboard Items (mostrar detalles)
  // Ya manejado con los eventos separados arriba

  // Crear Item (Ajax)
  $('#agregarItemForm').submit(function(e){
    e.preventDefault();
    var itemName = $('#itemNameInput').val().trim();
    var itemType = $('#itemTypeSelect').val();

    if (!itemName || !itemType) {
      alert('Por favor, completa todos los campos antes de continuar.');
      return;
    }
    $.ajax({
      url: "{{ url_for('create_dashboard_item') }}",
      method: 'POST',
      contentType: 'application/json',
      data: JSON.stringify({ name: itemName, item_type: itemType }),
      headers: {
        'X-CSRFToken': '{{ csrf_token() }}'
      },
      success: function(response){
        var newItem = '<li>'+
          '<a href="#dashboardItemDetailSection" '+
             'class="nav-link sub-link dashboard-item-link" '+
             'data-item-id="'+response.uuid+'" '+
             'data-item-name="'+itemName+'" '+
             'data-item-type="'+itemType+'">'+
             '<i class="bi bi-dot"></i><span class="text-label ms-1">'+itemName+'</span>'+
          '</a></li>';
        $('#dashboardItemsContainer').append(newItem);
        $('#dashboardItemsContainerOffcanvas').append(newItem);
        $('#agregarItemModal').modal('hide');
        $('#itemNameInput').val('');
        $('#itemTypeSelect').val('');
      },
      error: function(){
        alert('Hubo un error al crear el ítem, intenta nuevamente.');
      }
    });
  });

  // Eliminar Item (Ajax)
  $('#eliminarItemBtn').on('click', function(){
    var itemId = $(this).data('item-id');
    if(!itemId){
      console.error('No se encontró item-id');
      return;
    }
    var confirmDeleteModal = new bootstrap.Modal(document.getElementById('confirmDeleteDashboardItemModal'));
    confirmDeleteModal.show();

    $('#deleteDashboardItemForm').off('submit').on('submit', function(e){
      e.preventDefault();
      $.ajax({
        url: "{{ url_for('delete_dashboard_item') }}",
        method: 'POST',
        contentType: 'application/json',
        data: JSON.stringify({ uuid: itemId }),
        headers: {
          'X-CSRFToken': '{{ csrf_token() }}'
        },
        success: function(response){
          // Remover del sidebar fijo
          $('.dashboard-item-link[data-item-id="'+itemId+'"]').parent().remove();
          // Remover del offcanvas sidebar
          $('.offcanvas #dashboardItemsContainerOffcanvas .dashboard-item-link[data-item-id="'+itemId+'"]').parent().remove();
          showSection('miPerfilSection');
          confirmDeleteModal.hide();
          alert('Ítem eliminado exitosamente.');
        },
        error: function(){
          alert('Error al eliminar el ítem.');
        }
      });
    });
  });

  // 10) Renderizar tabla y gráfico
  var globalRatingsData=null, globalDates=null, globalDetails=null;

  function renderLast10DaysTable(itemUUID, itemType){
    var ratingsHeader = document.getElementById('ratingsHeader');
    Array.from(ratingsHeader.querySelectorAll('th:not(:first-child)')).forEach(function(th){
      th.remove();
    });
    var rowIds=[
      'rating10Row','rating9Row','rating8Row','rating7Row','rating6Row',
      'rating5Row','rating4Row','rating3Row','rating2Row','rating1Row',
      'totalRow'
    ];
    rowIds.forEach(function(rowId){
      var row=document.getElementById(rowId);
      while(row.children.length>1){
        row.removeChild(row.lastChild);
      }
    });

    $.ajax({
      url: '{{ url_for("get_ratings_data") }}',
      type:'GET',
      data:{ item_uuid:itemUUID },
      success:function(response){
        if(response.error){
          console.error("Error:", response.error);
          return;
        }
        globalRatingsData=response.ratings;
        globalDates=response.dates;
        globalDetails=response.details;
        globalDates.forEach(function(dateStr){
          var th=document.createElement('th');
          th.textContent=dateStr;
          ratingsHeader.appendChild(th);
        });
        fillTableWithCounts(globalRatingsData);
        renderChart(globalRatingsData, globalDates, globalDetails, itemType, 'count');
      },
      error:function(xhr,status,error){
        console.error('Error al obtener datos:', error);
      }
    });
  }

  function fillTableWithCounts(ratingsData){
    for(var val=10; val>=1; val--){
      var row=document.getElementById('rating'+val+'Row');
      var countArray=ratingsData[val.toString()]||[];
      countArray.forEach(function(cnt){
        var td=document.createElement('td');
        td.textContent=cnt;
        row.appendChild(td);
      });
    }
    var totalRow=document.getElementById('totalRow');
    var length=(ratingsData["1"]||[]).length;
    var dayTotals=new Array(length).fill(0);
    for(var rating=1; rating<=10; rating++){
      var arr=ratingsData[rating.toString()]||[];
      arr.forEach(function(cnt, i){
        dayTotals[i]+=cnt;
      });
    }
    dayTotals.forEach(function(t){
      var td=document.createElement('td');
      td.textContent=t;
      totalRow.appendChild(td);
    });
  }

  function computeDataByIndicator(ratingsData, dates, indicator){
    var length=dates.length;
    var resultArray=new Array(length).fill(0);
    for(var i=0; i<length; i++){
      var total=0, sumRatings=0, promoters=0, passives=0, detractors=0;
      for(var rating=1; rating<=10; rating++){
        var counts=ratingsData[rating.toString()]||[];
        var c=counts[i]||0;
        total+=c;
        sumRatings+=(rating*c);
        if(rating>=9) promoters+=c;
        else if(rating>=7) passives+=c;
        else detractors+=c;
      }
      if(indicator==="count"){
        resultArray[i]=total;
      } else if(indicator==="average"){
        if(total>0) resultArray[i]=sumRatings/total; else resultArray[i]=0;
      } else if(indicator==="nps"){
        if(total>0) resultArray[i]=((promoters-detractors)/total)*100; else resultArray[i]=0;
      } else if(indicator==="promoters"){
        if(total>0) resultArray[i]=(promoters/total)*100; else resultArray[i]=0;
      } else if(indicator==="passives"){
        if(total>0) resultArray[i]=(passives/total)*100; else resultArray[i]=0;
      } else if(indicator==="detractors"){
        if(total>0) resultArray[i]=(detractors/total)*100; else resultArray[i]=0;
      }
    }
    return resultArray;
  }

  function computeStackedData(ratingsData, dates){
    var length=dates.length;
    var promotersArray=new Array(length).fill(0);
    var passivesArray=new Array(length).fill(0);
    var detractorsArray=new Array(length).fill(0);
    for(var i=0; i<length; i++){
      var total=0, pro=0, pas=0, det=0;
      for(var rating=1; rating<=10; rating++){
        var arr=ratingsData[rating.toString()]||[];
        var count=arr[i]||0;
        total+=count;
        if(rating>=9) pro+=count;
        else if(rating>=7) pas+=count;
        else det+=count;
      }
      if(total>0){
        promotersArray[i]=(pro/total)*100;
        passivesArray[i]=(pas/total)*100;
        detractorsArray[i]=(det/total)*100;
      }
    }
    return {
      promotersArray:promotersArray,
      passivesArray:passivesArray,
      detractorsArray:detractorsArray
    };
  }

  function renderChart(ratingsData, dates, detailsByDay, itemType, indicator){
    if(indicator==="stacked"){
      renderStackedChart(ratingsData, dates);
      return;
    }
    var dataArray=computeDataByIndicator(ratingsData, dates, indicator);
    var labelMap={
      count:"Cantidad de Evaluaciones",
      average:"Promedio de Puntajes",
      nps:"NPS",
      promoters:"% Promotores",
      passives:"% Neutros",
      detractors:"% Detractores"
    };
    var datasetLabel=labelMap[indicator]||"Indicador";
    var data={
      labels:dates,
      datasets:[{
        label:datasetLabel,
        data:dataArray,
        borderColor:'rgba(75,192,192,1)',
        backgroundColor:'rgba(75,192,192,0.2)',
        fill:true
      }]
    };
    var config={
      type:'line',
      data:data,
      options:{
        responsive:true,
        plugins:{
          title:{
            display:true,
            text:"Indicador: "+datasetLabel
          }
        },
        onClick:function(evt,elements){
          if(elements && elements.length){
            var idx=elements[0].index;
            var selectedDate=dates[idx];
            var dayResponses=detailsByDay[selectedDate]||[];
            showResponsesForDay(selectedDate, dayResponses);
          }
        },
        scales:{
          y:{beginAtZero:true}
        }
      }
    };
    var ctx=document.getElementById('myChart').getContext('2d');
    if(window.myChartInstance) {
      window.myChartInstance.destroy();
    }
    window.myChartInstance=new Chart(ctx,config);
  }

  function renderStackedChart(ratingsData, dates){
    var computed=computeStackedData(ratingsData, dates);
    var data={
      labels:dates,
      datasets:[
        {
          label:"Promotores (%)",
          data:computed.promotersArray,
          backgroundColor:"rgba(75,192,192,0.8)"
        },
        {
          label:"Neutros (%)",
          data:computed.passivesArray,
          backgroundColor:"rgba(255,206,86,0.8)"
        },
        {
          label:"Detractores (%)",
          data:computed.detractorsArray,
          backgroundColor:"rgba(255,99,132,0.8)"
        }
      ]
    };
    var config={
      type:'bar',
      data:data,
      options:{
        responsive:true,
        plugins:{
          title:{
            display:true,
            text:"Barras Apiladas (Promotores/Neutros/Detractores)"
          }
        },
        scales:{
          x:{stacked:true},
          y:{stacked:true,beginAtZero:true,max:100}
        }
      }
    };
    var ctx=document.getElementById('myChart').getContext('2d');
    if(window.myChartInstance){
      window.myChartInstance.destroy();
    }
    window.myChartInstance=new Chart(ctx, config);
  }

  function showResponsesForDay(dateStr, responses){
    var detailsTitle=document.getElementById('detailsTitle');
    detailsTitle.textContent="Detalles del día: "+dateStr;
    var tbody=document.getElementById('dayDetailsBody');
    tbody.innerHTML="";
    if(!responses.length){
      var row=document.createElement('tr');
      var cell=document.createElement('td');
      cell.colSpan=2;
      cell.textContent="No hay respuestas para este día.";
      row.appendChild(cell);
      tbody.appendChild(row);
    } else {
      responses.forEach(function(resp){
        var row=document.createElement('tr');
        var tdRating=document.createElement('td');
        tdRating.textContent=resp.rating;
        var tdComment=document.createElement('td');
        tdComment.textContent=resp.comment||"Sin Comentario";
        row.appendChild(tdRating);
        row.appendChild(tdComment);
        tbody.appendChild(row);
      });
    }
    document.getElementById('dayDetailsContainer').style.display='block';
  }

  // Evento para <select id="chartIndicatorSelect">
  var chartIndicatorSelect=document.getElementById('chartIndicatorSelect');
  if(chartIndicatorSelect){
    chartIndicatorSelect.addEventListener('change',function(){
      if(!globalRatingsData || !globalDates || !globalDetails) return;
      var indicator=this.value;
      renderChart(globalRatingsData, globalDates, globalDetails, "Evaluación de Clientes", indicator);
    });
  }

  // Botones Tabla vs Gráfico
  var showTableBtn=document.getElementById('showTableBtn');
  var showChartBtn=document.getElementById('showChartBtn');
  var tableContainer=document.getElementById('tableContainer');
  var chartContainer=document.getElementById('chartContainer');
  if(showTableBtn && showChartBtn && tableContainer && chartContainer){
    showTableBtn.addEventListener('click', function(){
      tableContainer.style.display='block';
      chartContainer.style.display='none';
    });
    showChartBtn.addEventListener('click', function(){
      tableContainer.style.display='none';
      chartContainer.style.display='block';
    });
  }

});
</script>
{% endblock %}

----- Fin de templates/profile.html -----

----- Inicio de templates/register.html -----
<!-- templates/register.html -->

{% extends 'video_base.html' %}

{% block title %}Registrar - PulztagWeb{% endblock %}

{% block content %}
<section class="hero-section position-relative overflow-hidden min-vh-100" style="margin-top:0;">
    <!-- Contenedor para el video -->
    <div class="video-container">
        <video id="hero-video" autoplay muted loop playsinline preload="auto" class="hero-video-bg">
            <source src="{{ url_for('static', filename='videos/longvideo.mp4') }}" type="video/mp4">
            Tu navegador no soporta videos HTML5. Por favor, actualiza a un navegador moderno.
        </video>
    </div>
    <!-- Overlay -->
    <div class="overlay"></div>

    <!-- Contenido Principal -->
    <div class="container-fluid position-relative z-index-2 px-0 min-vh-100">
        <div class="row justify-content-center align-items-center min-vh-100 mx-0">
            <div class="col-lg-6 col-md-8 text-center">
                <div class="card register-card p-4 shadow-lg"
                     style="background: rgba(0, 187, 255, 0);
                            backdrop-filter: blur(5px);
                            border-radius: 1rem;
                            width: 100%;
                            max-width: 400px;
                            margin: auto;">
                    <h2 class="text-center mb-4 text-white">Crear Cuenta</h2>
                    <form method="POST" action="{{ url_for('main.register') }}">
                        {{ form.hidden_tag() }}

                        <!-- Nombre de Usuario -->
                        <div class="form-floating mb-3">
                            {{ form.username(class="form-control", id="username", placeholder="Nombre de Usuario") }}
                            <label for="username">Nombre de Usuario</label>
                            {% for error in form.username.errors %}
                                <div class="form-text text-danger">{{ error }}</div>
                            {% endfor %}
                        </div>

                        <!-- Correo Electrónico -->
                        <div class="form-floating mb-4">
                            {{ form.email(class="form-control", id="email", placeholder="Correo Electrónico") }}
                            <label for="email">Correo Electrónico</label>
                            {% for error in form.email.errors %}
                                <div class="form-text text-danger">{{ error }}</div>
                            {% endfor %}
                        </div>

                        <!-- Botón de Envío -->
                        <div class="d-grid">
                            <button type="submit" class="btn btn-info btn-lg">
                                {{ form.submit.label.text }}
                            </button>
                        </div>
                    </form>
                    
                    <!-- Enlace a Iniciar Sesión -->
                    <p class="mt-3 text-center text-white">
                        ¿Ya tienes una cuenta? 
                        <a href="{{ url_for('main.login') }}">Inicia Sesión</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block styles %}
<style>
    /* Estilos específicos para el formulario de registro */
    .register-card {
        background-color: rgba(255, 255, 255, 0.85); /* Semi-transparente */
        backdrop-filter: blur(5px); /* Efecto de desenfoque */
    }

    /* Responsividad para pantallas pequeñas */
    @media (max-width: 576px) {
        .register-card {
            width: 90%;
            padding: 1.5rem;
        }
    }
</style>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function () {
    const videos = ["{{ url_for('static', filename='videos/longvideo.mp4') }}"];
    let videoIndex = 0;
    const videoElement = document.getElementById('hero-video');
    if (!videoElement) return;
    const sourceElement = videoElement.querySelector('source');

    function playNextVideo() {
        sourceElement.src = videos[videoIndex];
        videoElement.load();
        videoElement.play();
        videoIndex = (videoIndex + 1) % videos.length;
    }

    videoElement.addEventListener('ended', playNextVideo);
});
</script>
{% endblock %}

----- Fin de templates/register.html -----

----- Inicio de templates/reset_request.html -----
<!-- templates/reset_request.html -->

{% extends 'base.html' %}

{% block title %}Recuperar Contraseña - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Recuperar Contraseña</h2>
<div class="row justify-content-center">
    <div class="col-md-6">
        <form method="POST" action="{{ url_for('main.reset_request') }}">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.email.label(class="form-label") }}
                {{ form.email(class="form-control", placeholder="Correo Electrónico") }}
                {% for error in form.email.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-primary">{{ form.submit.label.text }}</button>
        </form>
        <p class="mt-3">¿Recuerdas tu contraseña? <a href="{{ url_for('main.login') }}">Inicia Sesión</a></p>
    </div>
</div>
{% endblock %}

----- Fin de templates/reset_request.html -----

----- Inicio de templates/reset_token.html -----
<!-- templates/reset_token.html -->

{% extends 'base.html' %}

{% block title %}Restablecer Contraseña - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Restablecer Contraseña</h2>
<div class="row justify-content-center">
    <div class="col-md-6">
        <form method="POST" action="{{ url_for('main.reset_token', token=token) }}">
            {{ form.hidden_tag() }}
            <div class="mb-3">
                {{ form.password.label(class="form-label") }}
                {{ form.password(class="form-control", placeholder="Nueva Contraseña") }}
                {% for error in form.password.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <div class="mb-3">
                {{ form.confirm_password.label(class="form-label") }}
                {{ form.confirm_password(class="form-control", placeholder="Confirmar Nueva Contraseña") }}
                {% for error in form.confirm_password.errors %}
                    <div class="text-danger">{{ error }}</div>
                {% endfor %}
            </div>
            <button type="submit" class="btn btn-primary">{{ form.submit.label.text }}</button>
        </form>
    </div>
</div>
{% endblock %}

----- Fin de templates/reset_token.html -----

----- Inicio de templates/tags.html -----
<!-- templates/tags.html -->

{% extends 'base.html' %}

{% block title %}Tags - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center">Tags</h2>
<p>Esta sección está vacía por el momento.</p>
{% endblock %}

----- Fin de templates/tags.html -----

----- Inicio de .gitignore -----
# Entorno virtual
virtualenv/

# Archivos de Python
__pycache__/
*.pyc
*.pyo
*.pyd

# Archivos de bases de datos
*.sqlite3
*.db
.pgdata/
pg_log/

# Directorios de subida
uploads/
vcards/

# Archivos de configuración local
*.env
.env.*

# Archivos de respaldo
respaldo.txt
site_backup.db

# Archivos de logs
*.log

# Otros archivos sin seguimiento
*.txt

# Archivos específicos a ignorar
concatenar_archivos.py

# Archivos generados por el sistema operativo
.DS_Store
Thumbs.db
ehthumbs.db
Desktop.ini

# Directorios de entornos de desarrollo
.vscode/
.idea/

# Archivos de base de datos específicos
instance/site_new.db

# Archivos de configuración específicos
script_crear_admin.py
script_reset_database.py
script_corregir_admins.py

# Reportes de pruebas
.coverage
.cache/
htmlcov/
pytest_cache/

# Archivos de Docker
docker-compose.yml
Dockerfile

----- Fin de .gitignore -----

----- Inicio de app.py -----
# app.py

# ============================================
# Importaciones estándar de la biblioteca
# ============================================

import os
import uuid
from io import BytesIO
from random import randint
from urllib.parse import urlparse
from datetime import datetime, timedelta, timezone

# ============================================
# Importaciones de terceros
# ============================================

from flask import (
    Flask, render_template, request, flash, redirect, url_for,
    send_from_directory, send_file, jsonify, make_response, abort
)
from flask_sqlalchemy import SQLAlchemy
from sqlalchemy.exc import IntegrityError
from sqlalchemy import exists
from sqlalchemy.orm import joinedload
from flask_bcrypt import Bcrypt
from flask_mail import Mail, Message
from flask_wtf.csrf import CSRFProtect
from flask_login import login_required, current_user, login_user, logout_user, LoginManager
from flask_admin import Admin
from flask_admin.contrib.sqla import ModelView
from itsdangerous import URLSafeTimedSerializer, SignatureExpired
from werkzeug.utils import secure_filename
from werkzeug.security import generate_password_hash
import pandas as pd
import qrcode
from dotenv import load_dotenv
import logging

# ============================================
# Importaciones locales
# ============================================

from extensions import mail, db, migrate, bcrypt, login_manager, oauth
from models import User, Pulzcard, Tag, Bodega, Caja, Producto, SecureModelView, DashboardItem, SurveyResponse
from forms import (
    RegistrationForm, LoginForm, UpdateAccountForm,
    RequestResetForm, ResetPasswordForm,
    PulzcardForm, EditPulzcardForm, DeletePulzcardForm,
    ContactForm, OrderForm, TagForm, EditTagForm, DeleteTagForm,
    BodegaForm, EditBodegaForm, DeleteBodegaForm,
    CajaForm, EditCajaForm, DeleteCajaForm, ProductoForm, EditProductoForm, DeleteProductoForm,
    ImportTagsForm, BulkDeleteTagForm, DeleteDashboardItemForm,
    ImportPulzcardForm, BulkDeletePulzcardForm, DeleteCajaForm, DeleteProductoForm
)

# ============================================
# Configuración de la aplicación Flask
# ============================================

from routes.auth_routes import main_bp #importación de tu blueprint de autenticación

load_dotenv()  # Carga las variables de entorno desde el archivo .env es

app = Flask(__name__, instance_relative_config=True)
app.secret_key = os.getenv('SECRET_KEY', 'test_secret_key')

# Configuración de la Base de Datos
app.config['SQLALCHEMY_DATABASE_URI'] = os.getenv('DATABASE_URL')
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

app.config["SQLALCHEMY_ENGINE_OPTIONS"] = {
    "pool_pre_ping": True,
    "pool_recycle": 1800,  # Recycle connections every 30 minutes
    "pool_size": 5,
    "max_overflow": 10,
    "pool_timeout": 30,
}

# Directorio para guardar las vCards
VCARD_FOLDER = os.path.join(app.instance_path, 'vcards')
os.makedirs(VCARD_FOLDER, exist_ok=True)

# Directorio para guardar las subidas
UPLOAD_FOLDER = os.path.join(app.instance_path, 'uploads')
os.makedirs(UPLOAD_FOLDER, exist_ok=True)
app.config['UPLOAD_FOLDER'] = UPLOAD_FOLDER

# Extensiones permitidas
ALLOWED_LOGO_EXTENSIONS = {'png', 'jpeg', 'jpg'}
ALLOWED_EXCEL_EXTENSIONS = {'xlsx', 'xls'}

db.init_app(app)
migrate.init_app(app, db)
bcrypt.init_app(app)
login_manager.init_app(app)
oauth.init_app(app)  # Inicializar `oauth` con la instancia de `app`

# Inicializar CSRFProtect
csrf = CSRFProtect(app)

# Configuración de Flask-Login
login_manager.login_view = 'main.login'
login_manager.login_message_category = 'warning'

@login_manager.user_loader
def load_user(user_id):
    return db.session.get(User, int(user_id))

# Configuración de Flask-Mail
app.config['MAIL_SERVER'] = 'smtp.gmail.com'
app.config['MAIL_PORT'] = 465
app.config['MAIL_USE_TLS'] = False
app.config['MAIL_USE_SSL'] = True
app.config['MAIL_USERNAME'] = os.getenv('MAIL_USERNAME')
app.config['MAIL_PASSWORD'] = os.getenv('MAIL_PASSWORD')
app.config['MAIL_DEFAULT_SENDER'] = os.getenv('MAIL_USERNAME')

mail.init_app(app)  # Inicializar mail después de configurar

# Registrar el cliente de Google OAuth
google = oauth.register(
    name='google',
    client_id=os.getenv('GOOGLE_CLIENT_ID'),
    client_secret=os.getenv('GOOGLE_CLIENT_SECRET'),
    access_token_url='https://accounts.google.com/o/oauth2/token',
    authorize_url='https://accounts.google.com/o/oauth2/auth',
    api_base_url='https://www.googleapis.com/oauth2/v1/',
    userinfo_endpoint='https://www.googleapis.com/oauth2/v1/userinfo',  # Cambiado para mayor claridad
    client_kwargs={'scope': 'openid email profile'},
)

app.register_blueprint(main_bp)

# Inicializar Flask-Admin
admin = Admin(app, name='Panel de Administración', template_mode='bootstrap4')

# Agregar vistas con la clase SecureModelView al panel de administración
admin.add_view(SecureModelView(User, db.session))
admin.add_view(SecureModelView(Pulzcard, db.session))
admin.add_view(SecureModelView(Tag, db.session))  # Asegúrate de incluir Tag
admin.add_view(SecureModelView(Bodega, db.session))
admin.add_view(SecureModelView(Caja, db.session))
admin.add_view(SecureModelView(Producto, db.session))  # Si deseas ver Productos en admin

# Configurar el serializador
s = URLSafeTimedSerializer(app.secret_key)

tag_fields = ['tag_name', 'redirect_url']

# ============================================
# Funciones auxiliares
# ============================================

def allowed_file(filename, allowed_extensions):
    return '.' in filename and \
           filename.rsplit('.', 1)[1].lower() in allowed_extensions

# Función para generar el ID de Bodega
def generar_id_bodega():
    # Obtener la última bodega creada
    ultima_bodega = Bodega.query.order_by(Bodega.id.desc()).first()
    if ultima_bodega:
        ultimo_numero = int(ultima_bodega.id_bodega[3:])  # Asumiendo formato 'BOD001'
        nuevo_numero = ultimo_numero + 1
    else:
        nuevo_numero = 1  # Primera bodega

    # Generar el nuevo ID con prefijo y ceros a la izquierda
    nuevo_id = f"BOD{str(nuevo_numero).zfill(3)}"
    return nuevo_id


def generar_id_caja():
    # Obtener la última caja creada
    ultima_caja = Caja.query.order_by(Caja.id.desc()).first()
    if ultima_caja:
        ultimo_numero = int(ultima_caja.id_caja[3:])  # Asumiendo formato 'CAJ001'
        nuevo_numero = ultimo_numero + 1
    else:
        nuevo_numero = 1  # Primera caja

    # Generar el nuevo ID con prefijo y ceros a la izquierda
    nuevo_id = f"CAJ{str(nuevo_numero).zfill(3)}"
    return nuevo_id

def redirect_back(default='profile'):
    next_page = request.args.get('next')
    if next_page:
        return redirect(url_for(next_page))
    elif request.referrer:
        return redirect(request.referrer)
    else:
        return redirect(url_for(default))

# Rutas Existentes
@app.route('/')
def home():
    return render_template('index.html')


@app.route('/about')
def about():
    return render_template('about.html')


@app.route('/contact', methods=['GET', 'POST'])
def contact():
    form = ContactForm()
    prefilled_message = request.args.get('message')
    if prefilled_message and not form.mensaje.data:
        form.mensaje.data = prefilled_message

    if form.validate_on_submit():
        nombre = form.nombre.data
        email = form.email.data
        mensaje = form.mensaje.data

        try:
            msg = Message(
                subject=f"Nuevo mensaje de {nombre}",
                recipients=['contacto@pulztag.com'],
                body=f"Nombre: {nombre}\nCorreo Electrónico: {email}\n\nMensaje:\n{mensaje}"
            )
            mail.send(msg)
            flash('¡Tu mensaje ha sido enviado exitosamente!', 'success')
            return redirect(url_for('contact'))
        except Exception as e:
            print(e)
            flash('Hubo un error al enviar tu mensaje. Por favor, inténtalo de nuevo más tarde.', 'danger')
            return redirect(url_for('contact'))

    return render_template('contact.html', form=form)


@app.route('/products')
def products():
    return render_template('products.html')


@app.route('/services')
def services():
    return render_template('services.html')


@app.route('/order', methods=['GET', 'POST'])
@login_required
def order():
    form = OrderForm()
    if form.validate_on_submit():
        nombre = form.nombre.data
        email = form.email.data
        dispositivo = form.dispositivo.data
        mensaje = form.mensaje.data

        # Manejar los logos
        logos = request.files.getlist('logos')
        valid_logos = [logo for logo in logos if logo.filename != '']
        if len(valid_logos) > 10:
            flash('Puedes subir un máximo de 10 logos.', 'danger')
            return redirect(url_for('order'))

        saved_logos = []
        for logo in valid_logos:
            filename = logo.filename.strip()
            if allowed_file(filename, ALLOWED_LOGO_EXTENSIONS):
                try:
                    secure_name = secure_filename(filename)
                    unique_filename = f"{uuid.uuid4().hex}_{secure_name}"
                    logo_path = os.path.join(app.config['UPLOAD_FOLDER'], unique_filename)
                    logo.save(logo_path)
                    if os.path.exists(logo_path):
                        saved_logos.append((filename, logo_path))
                        print(f"Logo guardado: {logo_path}")
                    else:
                        flash(f"Error al guardar el logo {filename}.", 'danger')
                        return redirect(url_for('order'))
                except Exception as e:
                    print(f"Error al guardar el logo {filename}: {e}")
                    flash(f"Hubo un error al guardar el logo {filename}.", 'danger')
                    return redirect(url_for('order'))
            else:
                flash(f"Formato de logo no permitido: {filename}", 'danger')
                return redirect(url_for('order'))

        # Manejar el archivo Excel
        excel = request.files.get('excel')
        if excel and excel.filename != '':
            filename = excel.filename.strip()
            if allowed_file(filename, ALLOWED_EXCEL_EXTENSIONS):
                try:
                    secure_name = secure_filename(filename)
                    unique_filename = f"{uuid.uuid4().hex}_{secure_name}"
                    excel_path = os.path.join(app.config['UPLOAD_FOLDER'], unique_filename)
                    excel.save(excel_path)
                    if os.path.exists(excel_path):
                        print(f"Archivo Excel guardado: {excel_path}")
                    else:
                        flash(f"Error al guardar el archivo Excel {filename}.", 'danger')
                        return redirect(url_for('order'))
                except Exception as e:
                    print(f"Error al guardar el archivo Excel {filename}: {e}")
                    flash(f"Hubo un error al guardar el archivo Excel {filename}.", 'danger')
                    return redirect(url_for('order'))
            else:
                flash('Formato de archivo Excel no permitido.', 'danger')
                return redirect(url_for('order'))
        else:
            excel_path = None

        # Crear un DataFrame con los datos del pedido
        data = {
            'Nombre': [nombre],
            'Correo Electrónico': [email],
            'Selección de Dispositivo': [dispositivo],
            'Mensaje': [mensaje]
        }
        df = pd.DataFrame(data)

        # Guardar el DataFrame en un archivo Excel
        pedido_excel_path = os.path.join(app.config['UPLOAD_FOLDER'], f"pedido_{uuid.uuid4().hex}.xlsx")
        try:
            df.to_excel(pedido_excel_path, index=False)
            if os.path.exists(pedido_excel_path):
                print(f"Pedido guardado en: {pedido_excel_path}")
            else:
                flash("Error al guardar los detalles del pedido.", 'danger')
                return redirect(url_for('order'))
        except Exception as e:
            print(f"Error al guardar el pedido en Excel: {e}")
            flash("Hubo un error al procesar los detalles del pedido.", 'danger')
            return redirect(url_for('order'))

        # Enviar el correo con los archivos adjuntos
        try:
            msg = Message(
                subject="Nuevo Pedido de PulztagWeb",
                recipients=['contacto@pulztag.com']
            )
            msg.body = f"Nombre: {nombre}\nCorreo Electrónico: {email}\nSelección de Dispositivo: {dispositivo}\n\nMensaje:\n{mensaje}"

            # Adjuntar el archivo Excel del pedido
            with open(pedido_excel_path, 'rb') as fp:
                msg.attach(
                    "pedido.xlsx",
                    "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                    fp.read()
                )

            # Adjuntar los logos
            for original_filename, logo_path in saved_logos:
                try:
                    with open(logo_path, 'rb') as fp:
                        ext = original_filename.rsplit('.', 1)[1].lower()
                        mime_type = f"image/{'jpeg' if ext in ['jpg', 'jpeg'] else ext}"
                        msg.attach(
                            original_filename,
                            mime_type,
                            fp.read()
                        )
                        print(f"Adjuntado logo: {original_filename}")
                except Exception as e:
                    print(f"Error adjuntando el logo {original_filename}: {e}")
                    flash(f"Error adjuntando el logo {original_filename}.", 'danger')
                    return redirect(url_for('order'))

            # Adjuntar el archivo Excel si existe
            if excel_path:
                try:
                    with open(excel_path, 'rb') as fp:
                        msg.attach(
                            os.path.basename(excel_path),
                            "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",
                            fp.read()
                        )
                        print(f"Adjuntado archivo Excel: {excel_path}")
                except Exception as e:
                    print(f"Error adjuntando el archivo Excel {excel_path}: {e}")
                    flash(f"Error adjuntando el archivo Excel {excel_path}.", 'danger')
                    return redirect(url_for('order'))

            mail.send(msg)
            print("Correo enviado exitosamente.")

            # Eliminar archivos temporales
            try:
                os.remove(pedido_excel_path)
                for _, logo_path in saved_logos:
                    os.remove(logo_path)
                if excel_path:
                    os.remove(excel_path)
                print("Archivos temporales eliminados.")
            except Exception as e:
                print(f"Error al eliminar archivos temporales: {e}")

            flash('Su solicitud fue enviada exitosamente. ¡Pronto nos pondremos en contacto contigo!', 'success')
            return redirect(url_for('order'))

        except Exception as e:
            print(f"Error al enviar el correo: {e}")
            flash('Hubo un error al procesar tu solicitud. Por favor, inténtalo de nuevo más tarde.', 'danger')
            return redirect(url_for('order'))

    return render_template('order.html', form=form)


@app.route('/create_item')
def create_item():
    return render_template('create_item.html')

# Rutas de Pulzcard
@app.route('/pulzcard', methods=['GET', 'POST'])
@login_required
def pulzcard():
    form = PulzcardForm()
    if form.validate_on_submit():
        # Handle the image file if provided
        if form.image_file.data:
            # Save the uploaded image file
            image_file = form.image_file.data
            filename = secure_filename(image_file.filename)
            unique_filename = f"{uuid.uuid4().hex}_{filename}"
            image_path = os.path.join(app.config['UPLOAD_FOLDER'], unique_filename)
            image_file.save(image_path)
            print(f"Image saved at: {image_path}")
        else:
            unique_filename = 'default.jpg'

        # Crear la Pulzcard con el campo de plantilla
        pulzcard = Pulzcard(
            card_name=form.card_name.data,
            first_name=form.first_name.data,
            last_name=form.last_name.data,
            organization=form.organization.data,
            position=form.position.data,
            phone=form.phone.data,
            email=form.email.data,
            website=form.website.data,
            address=form.address.data,
            image_file=unique_filename,
            user_id=current_user.id,
            template=form.template.data
        )

        # Añadir a la sesión y hacer flush para obtener card_id
        db.session.add(pulzcard)
        try:
            db.session.flush()  # Asigna card_id sin commit
            print(f"Pulzcard creada con card_id: {pulzcard.card_id}")
        except Exception as e:
            db.session.rollback()
            print(f"Error al hacer flush de Pulzcard: {e}")
            flash('Hubo un error al crear tu Pulzcard. Por favor, inténtalo de nuevo.', 'danger')
            return redirect(url_for('pulzcard'))

        # Crear y guardar la vCard
        vcard = f"""BEGIN:VCARD
VERSION:3.0
FN:{pulzcard.first_name} {pulzcard.last_name}
ORG:{pulzcard.organization}
TITLE:{pulzcard.position}
TEL;TYPE=WORK,VOICE:{pulzcard.phone}
EMAIL:{pulzcard.email}
URL:{pulzcard.website}
ADR;TYPE=WORK:;;{pulzcard.address}
END:VCARD"""
        vcard_path = os.path.join(VCARD_FOLDER, f'{pulzcard.card_id}.vcf')
        print(f"Intentando guardar vCard en: {vcard_path}")

        try:
            with open(vcard_path, 'w') as f:
                f.write(vcard)
            print(f"vCard guardada exitosamente en: {vcard_path}")
        except Exception as e:
            db.session.rollback()
            print(f"Error al guardar la vCard: {e}")
            flash('Hubo un error al guardar la Pulzcard.', 'danger')
            return redirect(url_for('pulzcard'))

        # Commit de la Pulzcard y finalización
        try:
            db.session.commit()
            print("Pulzcard añadida a la base de datos correctamente.")
        except Exception as e:
            db.session.rollback()
            print(f"Error al crear Pulzcard en la base de datos: {e}")
            flash('Hubo un error al crear tu Pulzcard. Por favor, inténtalo de nuevo.', 'danger')
            return redirect(url_for('pulzcard'))

        # Redirigir usando card_id en lugar de id
        return redirect(url_for('pulzcard_card', card_id=pulzcard.card_id))
    else:
        print("Formulario no validado. Errores:", form.errors)

    return render_template('pulzcard/index.html', form=form)


@app.route('/pulzcard/card/<card_id>')
def pulzcard_card(card_id):
    pulzcard = Pulzcard.query.filter_by(card_id=card_id).first()
    if not pulzcard:
        flash('Tarjeta no encontrada.', 'danger')
        return redirect(url_for('main.home'))

    # Obtener el template desde los parámetros de la URL
    selected_template = request.args.get('template')
    valid_templates = ['template1', 'template2', 'template3']

    # Validar el template seleccionado
    if selected_template and selected_template in valid_templates:
        template_name = f"pulzcard/{selected_template}.html"
    else:
        # Usar el template predeterminado de la Pulzcard o 'template1' si no está definido
        template_name = f"pulzcard/{pulzcard.template if pulzcard.template in valid_templates else 'template1'}.html"

    contact_info = {
        "full_name": f"{pulzcard.first_name} {pulzcard.last_name}",
        "organization": pulzcard.organization,
        "position": pulzcard.position,
        "phone": pulzcard.phone,
        "email": pulzcard.email,
        "website": pulzcard.website,
        "address": pulzcard.address,
        "image_file": pulzcard.image_file
    }

    return render_template(template_name, contact=contact_info, card_id=card_id)


@app.route('/uploads/<filename>')
def uploaded_file(filename):
    return send_from_directory(app.config['UPLOAD_FOLDER'], filename)


@app.route('/pulzcard/vcards/<filename>')
def pulzcard_download_vcard(filename):
    # Opcional: Validar que el archivo existe y pertenece a una Pulzcard existente
    file_path = os.path.join(VCARD_FOLDER, filename)
    if not os.path.exists(file_path):
        flash('Archivo no encontrado.', 'danger')
        return redirect(url_for('main.home'))
    return send_from_directory(VCARD_FOLDER, filename, as_attachment=True)

# 1. Ruta para importar Pulzcards
@app.route('/import/pulzcards', methods=['POST'])
@login_required
def import_pulzcards():
    form = ImportPulzcardForm()
    if form.validate_on_submit():
        file = form.excelFile.data
        if file.filename == '':
            flash('No se ha seleccionado ningún archivo para Pulzcards.', 'danger')
            return redirect(url_for('profile') + '#pulzcardsSection')

        if allowed_file(file.filename, ALLOWED_EXCEL_EXTENSIONS):
            try:
                df = pd.read_excel(file)

                # Definir las columnas que esperas
                required_columns = [
                    'card_name', 'first_name', 'last_name', 
                    'organization', 'position', 'phone',
                    'email', 'website', 'address', 'template'
                ]
                # Verificar que existan
                if not all(col in df.columns for col in required_columns):
                    flash('El archivo Excel no contiene todas las columnas requeridas para Pulzcards.', 'danger')
                    return redirect(url_for('profile') + '#pulzcardsSection')

                # Insertar
                for _, row in df.iterrows():
                    new_pulz = Pulzcard(
                        card_name=row['card_name'],
                        first_name=row['first_name'],
                        last_name=row['last_name'],
                        organization=row['organization'],
                        position=row['position'],
                        phone=row['phone'],
                        email=row['email'],
                        website=row['website'],
                        address=row['address'],
                        template=row['template'] if 'template' in row and pd.notna(row['template']) else 'template1',
                        user_id=current_user.id
                    )
                    db.session.add(new_pulz)
                    db.session.flush()  # Para asignar card_id

                    # Crear la vCard en archivo .vcf (similar a como lo haces en /pulzcard)
                    vcard = f"""BEGIN:VCARD
VERSION:3.0
FN:{new_pulz.first_name} {new_pulz.last_name}
ORG:{new_pulz.organization}
TITLE:{new_pulz.position}
TEL;TYPE=WORK,VOICE:{new_pulz.phone}
EMAIL:{new_pulz.email}
URL:{new_pulz.website}
ADR;TYPE=WORK:;;{new_pulz.address}
END:VCARD"""
                    vcard_path = os.path.join(VCARD_FOLDER, f'{new_pulz.card_id}.vcf')
                    with open(vcard_path, 'w') as f:
                        f.write(vcard)

                db.session.commit()
                flash('Pulzcards importadas exitosamente.', 'success')
            except Exception as e:
                db.session.rollback()
                flash(f'Error al importar Pulzcards: {e}', 'danger')
        else:
            flash('Formato de archivo no permitido.', 'danger')
    else:
        # Errores del formulario
        for field, errors in form.errors.items():
            for error in errors:
                flash(f"Error en {field}: {error}", 'danger')

    return redirect(url_for('profile') + '#pulzcardsSection')


# 2. Ruta para exportar Pulzcards seleccionadas
@app.route('/export_pulzcards', methods=['POST'])
@login_required
def export_pulzcards():
    data = request.get_json()
    pulz_ids = data.get('pulz_ids', [])
    if not pulz_ids:
        return jsonify({'error': 'No se seleccionaron Pulzcards para exportar.'}), 400

    # Buscar las pulzcards del user actual
    pulzcards = Pulzcard.query.filter(Pulzcard.card_id.in_(pulz_ids), Pulzcard.user_id == current_user.id).all()
    if not pulzcards:
        return jsonify({'error': 'Pulzcards no encontradas o no pertenecen al usuario.'}), 404

    # Crear DataFrame
    df = pd.DataFrame([{
        'card_name': p.card_name,
        'first_name': p.first_name,
        'last_name': p.last_name,
        'organization': p.organization,
        'position': p.position,
        'phone': p.phone,
        'email': p.email,
        'website': p.website,
        'address': p.address,
        'template': p.template,
        'fecha_creacion': p.created_at
    } for p in pulzcards])

    output = BytesIO()
    writer = pd.ExcelWriter(output, engine='xlsxwriter')
    df.to_excel(writer, sheet_name='Pulzcards', index=False)
    writer.close()
    output.seek(0)

    response = make_response(output.getvalue())
    response.headers["Content-Disposition"] = "attachment; filename=pulzcards_export.xlsx"
    response.headers["Content-type"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
    return response


# 3. Borrado masivo de Pulzcards (opcional)
@app.route('/pulzcard/delete_bulk', methods=['POST'])
@login_required
def delete_bulk_pulzcards():
    form = BulkDeletePulzcardForm()
    if form.validate_on_submit():
        selected_pulzcards = request.form.getlist('selected_pulzcards')  # array con card_id
        if not selected_pulzcards:
            flash('No se seleccionaron Pulzcards para eliminar.', 'warning')
            return redirect(url_for('profile') + '#pulzcardsSection')

        try:
            pulzcards_to_delete = Pulzcard.query.filter(
                Pulzcard.card_id.in_(selected_pulzcards),
                Pulzcard.user_id == current_user.id
            ).all()

            for p in pulzcards_to_delete:
                # Eliminar vCard del sistema de archivos
                vcard_path = os.path.join(VCARD_FOLDER, f'{p.card_id}.vcf')
                if os.path.exists(vcard_path):
                    os.remove(vcard_path)
                db.session.delete(p)

            db.session.commit()
            flash(f'{len(pulzcards_to_delete)} Pulzcard(s) eliminada(s) exitosamente.', 'success')
        except Exception as e:
            db.session.rollback()
            flash(f'Error al eliminar Pulzcards: {e}', 'danger')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')

    return redirect(url_for('profile') + '#pulzcardsSection')

# Ruta: Perfil de Usuario
@app.route('/profile', methods=['GET', 'POST'])
@login_required
def profile():
    global tag_fields  # Declarar que tag_fields es una variable global
    pulzcards = Pulzcard.query.filter_by(user_id=current_user.id).order_by(Pulzcard.created_at.desc()).all()
    import_pulzcards_form = ImportPulzcardForm() # Instancia de Importar Pulzcards
    bulk_delete_pulzcard_form = BulkDeletePulzcardForm() # Instancia de Borrado Masivo Pulzcards (opcional)
    tags = Tag.query.filter_by(user_id=current_user.id).order_by(Tag.created_at.desc()).all()
    bodegas = Bodega.query.filter_by(user_id=current_user.id).order_by(Bodega.fecha_creacion.desc()).all()
    tag_form = TagForm()
    bodega_form = BodegaForm()
    import_tags_form = ImportTagsForm()  # Instanciar el nuevo formulario

    # Inicializar formularios de eliminación
    delete_forms = {card.id: DeletePulzcardForm(prefix=str(card.card_id)) for card in pulzcards}
    delete_tag_forms = {tag.id: DeleteTagForm(prefix=str(tag.tag_id)) for tag in tags}
    delete_bodega_forms = {bodega.uuid: DeleteBodegaForm(prefix=str(bodega.uuid)) for bodega in bodegas}
    dashboard_items = DashboardItem.query.filter_by(user_id=current_user.id).all()
    print(f"Dashboard Items para el usuario {current_user.id}: {dashboard_items}")

    if tag_form.validate_on_submit() and tag_form.submit.data:
        new_tag = Tag(
            tag_name=tag_form.tag_name.data,
            redirect_url=tag_form.redirect_url.data,
            user_id=current_user.id
        )
        db.session.add(new_tag)
        db.session.commit()
        flash('Tu etiqueta ha sido creada exitosamente.', 'success')
        return redirect(url_for('profile') + '#miPerfilSection')

    if bodega_form.validate_on_submit() and bodega_form.submit.data:
        new_bodega = Bodega(
            nombre=bodega_form.nombre.data,
            ubicacion=bodega_form.ubicacion.data,
            notas=bodega_form.notas.data,
            user_id=current_user.id
        )
        new_bodega.id_bodega = generar_id_bodega()
        db.session.add(new_bodega)
        db.session.commit()
        flash('Tu bodega ha sido creada exitosamente.', 'success')
        return redirect(url_for('profile') + '#miPerfilSection')

    if import_tags_form.validate_on_submit() and import_tags_form.submit.data:
        return redirect(url_for('import_tags'))

    # Obtener el parámetro de sección de la URL
    section = request.args.get('section', 'miPerfilSection')  # Por defecto, mostrar 'miPerfilSection'

    bulk_delete_tag_form = BulkDeleteTagForm()  # Instancia del nuevo formulario

    return render_template(
        'profile.html',
        title='Perfil de Usuario',
        pulzcards=pulzcards,
        import_pulzcards_form=import_pulzcards_form,
        bulk_delete_pulzcard_form=bulk_delete_pulzcard_form,
        tags=tags,
        bodegas=bodegas,
        tag_form=tag_form,
        bodega_form=bodega_form,
        import_tags_form=import_tags_form,
        delete_forms=delete_forms,
        delete_tag_forms=delete_tag_forms,
        delete_bodega_forms=delete_bodega_forms,
        tag_fields=tag_fields,
        bulk_delete_tag_form=bulk_delete_tag_form,
        section=section,
        dashboard_items=dashboard_items,  # Añade esta línea
    )

@app.context_processor
def inject_tag_fields():
    return dict(tag_fields=tag_fields)

@app.route('/r/<tag_id>')
def redirect_tag(tag_id):
    tag = Tag.query.filter_by(tag_id=tag_id).first()
    if tag:
        tag.vistas += 1  # Incrementa el contador de vistas
        try:
            db.session.commit()
        except Exception as e:
            db.session.rollback()
            print(f"Error al incrementar vistas para la etiqueta {tag_id}: {e}")
            flash('Hubo un error al procesar tu solicitud.', 'danger')
            return redirect(url_for('profile') + '#etiquetasSection')
        return redirect(tag.redirect_url)
    else:
        flash('La etiqueta no existe o fue eliminada.', 'danger')
        return redirect(url_for('profile') + '#etiquetasSection')


@app.route('/tag/delete/<tag_id>', methods=['POST'])
@login_required
def delete_tag(tag_id):
    tag = Tag.query.filter_by(tag_id=tag_id, user_id=current_user.id).first_or_404()

    form = DeleteTagForm()
    if form.validate_on_submit():
        try:
            db.session.delete(tag)
            db.session.commit()
            flash('Etiqueta eliminada exitosamente.', 'success')
        except Exception as e:
            db.session.rollback()
            print(f"Error al eliminar etiqueta: {e}")
            flash('Hubo un error al eliminar la etiqueta. Por favor, intenta de nuevo.', 'danger')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')

    return redirect(url_for('profile') + '#etiquetasSection')


@app.route('/tags/delete_bulk', methods=['POST'])
@login_required
def delete_bulk_tags():
    form = BulkDeleteTagForm()
    if form.validate_on_submit():
        selected_tags = request.form.getlist('selected_tags')  # Obtiene la lista de IDs seleccionados
        if not selected_tags:
            flash('No se seleccionaron etiquetas para eliminar.', 'warning')
            return redirect(url_for('profile') + '#etiquetasSection')
        try:
            # Filtra las etiquetas que pertenecen al usuario actual y están en la lista seleccionada
            tags_to_delete = Tag.query.filter(Tag.tag_id.in_(selected_tags), Tag.user_id == current_user.id).all()
            for tag in tags_to_delete:
                db.session.delete(tag)
            db.session.commit()
            flash(f'{len(tags_to_delete)} etiqueta(s) eliminada(s) exitosamente.', 'success')
        except Exception as e:
            db.session.rollback()
            print(f"Error al eliminar etiquetas: {e}")
            flash('Hubo un error al eliminar las etiquetas. Por favor, intenta de nuevo.', 'danger')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')
    return redirect(url_for('profile') + '#etiquetasSection')


@app.route('/import/tags', methods=['POST'])
@login_required
def import_tags():
    form = ImportTagsForm()
    if form.validate_on_submit():
        file = form.excelFile.data
        if file.filename == '':
            flash('No se ha seleccionado ningún archivo.', 'danger')
            return redirect(url_for('profile') + '#etiquetasSection')

        if allowed_file(file.filename, ALLOWED_EXCEL_EXTENSIONS):
            try:
                df = pd.read_excel(file)
                
                # Verificar columnas requeridas
                required_columns = ['tag_name', 'redirect_url']
                if not all(col in df.columns for col in required_columns):
                    flash('El archivo Excel no contiene todas las columnas requeridas.', 'danger')
                    return redirect(url_for('profile') + '#etiquetasSection')

                # Verificar número de columnas
                if len(df.columns) != len(required_columns):
                    flash('El número de columnas del archivo no coincide con las esperadas.', 'danger')
                    return redirect(url_for('profile') + '#etiquetasSection')

                # Crear etiquetas
                for _, row in df.iterrows():
                    new_tag = Tag(
                        tag_name=row['tag_name'],
                        redirect_url=row['redirect_url'],
                        user_id=current_user.id
                    )
                    db.session.add(new_tag)
                
                db.session.commit()
                flash(f'El archivo {file.filename} ha sido importado exitosamente.', 'success')
            except Exception as e:
                db.session.rollback()
                flash(f'Hubo un error al importar el archivo: {str(e)}', 'danger')
        else:
            flash('Formato de archivo no permitido.', 'danger')
    else:
        # Mostrar errores de CSRF u otros errores del formulario
        for field, errors in form.errors.items():
            for error in errors:
                flash(f"Error en {field}: {error}", 'danger')

    return redirect(url_for('profile') + '#etiquetasSection')


@app.route('/export_tags', methods=['POST'])
@login_required
def export_tags():
    data = request.get_json()
    tag_ids = data.get('tag_ids', [])
    
    if not tag_ids:
        return jsonify({'error': 'No se seleccionaron etiquetas para exportar.'}), 400

    tags = Tag.query.filter(Tag.tag_id.in_(tag_ids), Tag.user_id == current_user.id).all()
    if not tags:
        return jsonify({'error': 'Etiquetas no encontradas o no tienes permisos para exportarlas.'}), 404

    # Crear un DataFrame con los datos básicos y enlaces al código QR
    df = pd.DataFrame([{
        'tag_name': tag.tag_name,
        'redirect_url': tag.redirect_url,
        'url_destino': url_for('redirect_tag', tag_id=tag.tag_id, _external=True),
        'qr_link': url_for('tag_qrcode_image', tag_id=tag.tag_id, _external=True),  # Agregar enlace al código QR
        'vistas': tag.vistas,
        'created_at': tag.created_at
    } for tag in tags])

    # Crear el archivo Excel
    output = BytesIO()
    writer = pd.ExcelWriter(output, engine='xlsxwriter')
    df.to_excel(writer, sheet_name='Etiquetas', index=False)
    writer.close()
    output.seek(0)

    # Preparar la respuesta con el archivo Excel
    response = make_response(output.getvalue())
    response.headers["Content-Disposition"] = "attachment; filename=tags_export.xlsx"
    response.headers["Content-type"] = "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
    return response


# Ruta: Editar Pulzcard
@app.route('/pulzcard/edit/<card_id>', methods=['GET', 'POST'])
@login_required
def edit_pulzcard(card_id):
    pulzcard = Pulzcard.query.filter_by(card_id=card_id, user_id=current_user.id).first_or_404()
    form = EditPulzcardForm()

    if form.validate_on_submit():
        pulzcard.card_name = form.card_name.data
        pulzcard.first_name = form.first_name.data
        pulzcard.last_name = form.last_name.data
        pulzcard.organization = form.organization.data
        pulzcard.position = form.position.data
        pulzcard.phone = form.phone.data
        pulzcard.email = form.email.data
        pulzcard.website = form.website.data
        pulzcard.address = form.address.data
        pulzcard.template = form.template.data

        # Procesar la imagen de perfil si se ha subido una nueva
        if form.image_file.data:
            # Guardar la nueva imagen
            image_file = form.image_file.data
            filename = secure_filename(image_file.filename)
            unique_filename = f"{uuid.uuid4().hex}_{filename}"
            image_path = os.path.join(app.config['UPLOAD_FOLDER'], unique_filename)
            image_file.save(image_path)

            # Actualizar el campo image_file en la base de datos
            pulzcard.image_file = unique_filename

        db.session.commit()

        # Actualizar la vCard en el sistema de archivos
        vcard = f"""BEGIN:VCARD
VERSION:3.0
FN:{pulzcard.first_name} {pulzcard.last_name}
ORG:{pulzcard.organization}
TITLE:{pulzcard.position}
TEL;TYPE=WORK,VOICE:{pulzcard.phone}
EMAIL:{pulzcard.email}
URL:{pulzcard.website}
ADR;TYPE=WORK:;;{pulzcard.address}
END:VCARD"""
        vcard_path = os.path.join(VCARD_FOLDER, f'{pulzcard.card_id}.vcf')
        with open(vcard_path, 'w') as f:
            f.write(vcard)

        flash('Pulzcard actualizada exitosamente.', 'success')
        return redirect(url_for('profile') + '#pulzcardsSection')
    elif request.method == 'GET':
        form.card_name.data = pulzcard.card_name
        form.first_name.data = pulzcard.first_name
        form.last_name.data = pulzcard.last_name
        form.organization.data = pulzcard.organization
        form.position.data = pulzcard.position
        form.phone.data = pulzcard.phone
        form.email.data = pulzcard.email
        form.website.data = pulzcard.website
        form.address.data = pulzcard.address
        form.template.data = pulzcard.template

    return render_template('edit_pulzcard.html', title='Editar Pulzcard', form=form, pulzcard=pulzcard)


# Ruta: Eliminar Pulzcard
@app.route('/pulzcard/delete/<card_id>', methods=['POST'])
@login_required
def delete_pulzcard(card_id):
    pulzcard = Pulzcard.query.filter_by(card_id=card_id, user_id=current_user.id).first_or_404()

    form = DeletePulzcardForm()
    if form.validate_on_submit():
        try:
            # Eliminar la vCard del sistema de archivos
            vcard_path = os.path.join(VCARD_FOLDER, f'{pulzcard.card_id}.vcf')
            if os.path.exists(vcard_path):
                os.remove(vcard_path)

            # Eliminar la Pulzcard de la base de datos
            db.session.delete(pulzcard)
            db.session.commit()
            flash('Pulzcard eliminada exitosamente.', 'success')
        except Exception as e:
            print(f"Error al eliminar Pulzcard: {e}")
            flash('Hubo un error al eliminar la Pulzcard. Por favor, intenta de nuevo.', 'danger')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')

    return redirect(url_for('profile') + '#pulzcardsSection')


@app.route('/create_tag', methods=['GET', 'POST'])
@login_required
def create_tag():
    form = TagForm()
    if form.validate_on_submit():
        new_tag = Tag(
            tag_name=form.tag_name.data,
            redirect_url=form.redirect_url.data,
            user_id=current_user.id
        )
        db.session.add(new_tag)
        db.session.commit()
        flash('Tu etiqueta ha sido creada exitosamente.', 'success')
        return redirect(url_for('profile') + '#etiquetasSection')  # Redirección mejorada
    return render_template('create_tag.html', title='Crear Etiqueta', form=form)


@app.route('/tag/edit/<tag_id>', methods=['GET', 'POST'])
@login_required
def edit_tag(tag_id):
    tag = Tag.query.filter_by(tag_id=tag_id, user_id=current_user.id).first_or_404()
    form = EditTagForm()

    if form.validate_on_submit():
        tag.tag_name = form.tag_name.data
        tag.redirect_url = form.redirect_url.data
        db.session.commit()
        flash('Etiqueta actualizada exitosamente.', 'success')
        return redirect(url_for('profile') + '#etiquetasSection')  # Redirección mejorada
    elif request.method == 'GET':
        form.tag_name.data = tag.tag_name
        form.redirect_url.data = tag.redirect_url

    return render_template('edit_tag.html', title='Editar Etiqueta', form=form, tag=tag)


@app.route('/tag/qrcode_image/<tag_id>')
@login_required
def tag_qrcode_image(tag_id):
    tag = Tag.query.filter_by(tag_id=tag_id, user_id=current_user.id).first_or_404()
    url = url_for('redirect_tag', tag_id=tag.tag_id, _external=True)
    # Generar el código QR
    qr_img = qrcode.make(url)
    img_io = BytesIO()
    qr_img.save(img_io, 'PNG')
    img_io.seek(0)
    return send_file(img_io, mimetype='image/png')


@app.route('/tag/qrcode/<tag_id>')
@login_required
def tag_qrcode(tag_id):
    tag = Tag.query.filter_by(tag_id=tag_id, user_id=current_user.id).first_or_404()
    qr_image_url = url_for('tag_qrcode_image', tag_id=tag.tag_id)
    share_url = url_for('redirect_tag', tag_id=tag.tag_id, _external=True)
    return render_template('qrcode_card.html', qr_url=qr_image_url, entity_type='Etiqueta', tag_id=tag_id, share_url=share_url)


@app.route('/pulzcard/qrcode_image/<card_id>')
@login_required
def pulzcard_qrcode_image(card_id):
    pulzcard = Pulzcard.query.filter_by(card_id=card_id, user_id=current_user.id).first_or_404()
    url = url_for('pulzcard_card', card_id=pulzcard.card_id, _external=True)  # Confirmar uso de 'pulzcard_card'
    qr_img = qrcode.make(url)
    img_io = BytesIO()
    qr_img.save(img_io, 'PNG')
    img_io.seek(0)
    return send_file(img_io, mimetype='image/png')


@app.route('/pulzcard/qrcode/<card_id>')
@login_required
def pulzcard_qrcode(card_id):
    pulzcard = Pulzcard.query.filter_by(card_id=card_id, user_id=current_user.id).first_or_404()
    qr_image_url = url_for('pulzcard_qrcode_image', card_id=pulzcard.card_id)
    share_url = url_for('pulzcard_card', card_id=pulzcard.card_id, _external=True)
    return render_template(
        'qrcode_card.html',
        qr_url=qr_image_url,
        entity_type='Pulzcard',
        tag_id=card_id,
        share_url=share_url
    )


# Nuevas rutas para Bodega y Caja con UUID y códigos QR
@app.route('/bodega/new', methods=['GET', 'POST'])
@login_required
def create_bodega():
    form = BodegaForm()
    if form.validate_on_submit():
        new_bodega = Bodega(
            nombre=form.nombre.data,
            ubicacion=form.ubicacion.data,
            notas=form.notas.data,
            user_id=current_user.id
        )
        new_bodega.id_bodega = generar_id_bodega()
        db.session.add(new_bodega)
        db.session.commit()
        flash('Tu bodega ha sido creada exitosamente.', 'success')
        return redirect(url_for('profile', section='bodegasSection'))
    return render_template('create_bodega.html', title='Crear Bodega', form=form)


@app.route('/bodega/<uuid_bodega>', methods=['GET', 'POST'])
@login_required
def view_bodega(uuid_bodega):
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()
    form = CajaForm()
    delete_caja_forms = {caja.uuid: DeleteCajaForm(prefix=str(caja.uuid)) for caja in bodega.cajas}

    if form.validate_on_submit():
        nueva_caja = Caja(
            nombre=form.nombre.data,
            categoria=form.categoria.data,
            notas=form.notas.data,
            bodega_id=bodega.id
        )
        nueva_caja.id_caja = generar_id_caja()
        db.session.add(nueva_caja)
        db.session.commit()
        flash('Caja agregada exitosamente.', 'success')
        return redirect(url_for('view_bodega', uuid_bodega=uuid_bodega))

    return render_template(
        'bodega_detail.html',
        bodega=bodega,
        form=form,
        delete_caja_forms=delete_caja_forms
    )


@app.route('/bodega/<uuid_bodega>/caja/new', methods=['GET', 'POST'])
@login_required
def create_caja(uuid_bodega):
    # Verificar si la bodega existe
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()

    form = CajaForm()
    if form.validate_on_submit():
        nueva_caja = Caja(
            id_caja=generar_id_caja(),
            nombre=form.nombre.data,
            categoria=form.categoria.data,
            notas=form.notas.data,
            bodega_id=bodega.id  # Relaciona la caja con la bodega
        )
        try:
            db.session.add(nueva_caja)
            db.session.commit()
            flash('Caja creada exitosamente.', 'success')
        except Exception as e:
            db.session.rollback()
            flash(f'Error al crear la caja: {str(e)}', 'danger')
        return redirect(url_for('view_bodega', uuid_bodega=uuid_bodega))

    return render_template('create_caja.html', form=form, bodega=bodega)


@app.route('/bodega/edit/<uuid_bodega>', methods=['GET', 'POST'])
@login_required
def edit_bodega(uuid_bodega):
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()
    form = EditBodegaForm()
    if form.validate_on_submit():
        bodega.nombre = form.nombre.data
        bodega.ubicacion = form.ubicacion.data
        bodega.notas = form.notas.data
        db.session.commit()
        flash('Bodega actualizada exitosamente.', 'success')
        return redirect(url_for('profile') + '#bodegasSection')
    elif request.method == 'GET':
        form.nombre.data = bodega.nombre
        form.ubicacion.data = bodega.ubicacion
        form.notas.data = bodega.notas
    return render_template('edit_bodega.html', title='Editar Bodega', form=form, bodega=bodega)


@app.route('/bodega/delete/<uuid_bodega>', methods=['POST'])
@login_required
def delete_bodega(uuid_bodega):
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()
    form = DeleteBodegaForm()
    if form.validate_on_submit():
        db.session.delete(bodega)
        db.session.commit()
        flash('Bodega eliminada exitosamente.', 'success')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')
    return redirect(url_for('main.profile') + '#bodegasSection')


@app.route('/bodega/qrcode_image/<uuid_bodega>')
@login_required
def bodega_qrcode_image(uuid_bodega):
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()
    url = url_for('view_bodega', uuid_bodega=bodega.uuid, _external=True)
    # Generar el código QR
    qr_img = qrcode.make(url)
    img_io = BytesIO()
    qr_img.save(img_io, 'PNG')
    img_io.seek(0)
    return send_file(img_io, mimetype='image/png')


@app.route('/bodega/qrcode/<uuid_bodega>')
@login_required
def bodega_qrcode(uuid_bodega):
    bodega = Bodega.query.filter_by(uuid=uuid_bodega, user_id=current_user.id).first_or_404()
    qr_image_url = url_for('bodega_qrcode_image', uuid_bodega=bodega.uuid)
    share_url = url_for('view_bodega', uuid_bodega=bodega.uuid, _external=True)
    return render_template(
        'qrcode_card.html',
        qr_url=qr_image_url,
        entity_type='Bodega',
        tag_id=uuid_bodega,
        share_url=share_url
    )


@app.route('/caja/<uuid_caja>', methods=['GET'])
@login_required
def view_caja(uuid_caja):
    # Realizar un join entre Caja y Bodega para filtrar por user_id
    caja = Caja.query.join(Bodega).filter(
        Caja.uuid == uuid_caja,
        Bodega.user_id == current_user.id
    ).first_or_404(description='Caja no encontrada.')
    
    # Crear una instancia de DeleteProductoForm para manejar la eliminación de productos
    delete_producto_form = DeleteProductoForm()
    
    return render_template('caja_detail.html', caja=caja, delete_producto_form=delete_producto_form)


@app.route('/caja/edit/<uuid_caja>', methods=['GET', 'POST'])
@login_required
def edit_caja(uuid_caja):
    caja = Caja.query.join(Bodega).filter(
        Caja.uuid == uuid_caja,
        Bodega.user_id == current_user.id
    ).first_or_404(description='Caja no encontrada.')
    
    form = EditCajaForm()

    # Configurar dinámicamente las opciones para bodega_id
    form.bodega_id.choices = [(b.id, b.nombre) for b in Bodega.query.filter_by(user_id=current_user.id).all()]

    if form.validate_on_submit():
        caja.nombre = form.nombre.data
        caja.categoria = form.categoria.data
        caja.notas = form.notas.data
        nueva_bodega_id = form.bodega_id.data

        # Verificar si la bodega existe antes de asignar
        nueva_bodega = Bodega.query.filter_by(id=nueva_bodega_id).first()
        if not nueva_bodega:
            flash('La bodega seleccionada no existe.', 'danger')
            return redirect(url_for('edit_caja', uuid_caja=uuid_caja))

        caja.bodega_id = nueva_bodega.id
        db.session.commit()
        flash('Caja actualizada exitosamente.', 'success')
        return redirect(url_for('view_bodega', uuid_bodega=nueva_bodega.uuid))
    else:
        if request.method == 'GET':
            form.nombre.data = caja.nombre
            form.categoria.data = caja.categoria
            form.notas.data = caja.notas
            form.bodega_id.data = caja.bodega_id  # Preseleccionar la bodega actual
    
    return render_template('edit_caja.html', form=form, caja=caja)


@app.route('/caja/delete/<uuid_caja>', methods=['POST'])
@login_required
def delete_caja(uuid_caja):
    caja = Caja.query.filter_by(uuid=uuid_caja).join(Bodega).filter(Bodega.user_id == current_user.id).first_or_404()
    form = DeleteCajaForm()
    bodega_uuid = caja.bodega.uuid

    if form.validate_on_submit():
        db.session.delete(caja)
        db.session.commit()
        flash('Caja eliminada exitosamente.', 'success')
    else:
        flash('Error al eliminar la caja.', 'danger')
    return redirect(url_for('view_bodega', uuid_bodega=bodega_uuid))


@app.route('/caja/qrcode_image/<uuid_caja>')
@login_required
def caja_qrcode_image(uuid_caja):
    caja = Caja.query.filter_by(uuid=uuid_caja).join(Bodega).filter(Bodega.user_id == current_user.id).first_or_404()
    url = url_for('view_caja', uuid_caja=caja.uuid, _external=True)
    # Generar el código QR
    qr_img = qrcode.make(url)
    img_io = BytesIO()
    qr_img.save(img_io, 'PNG')
    img_io.seek(0)
    return send_file(img_io, mimetype='image/png')


@app.route('/caja/qrcode/<uuid_caja>')
@login_required
def caja_qrcode(uuid_caja):
    caja = Caja.query.filter_by(uuid=uuid_caja).join(Bodega).filter(Bodega.user_id == current_user.id).first_or_404()
    qr_image_url = url_for('caja_qrcode_image', uuid_caja=caja.uuid)
    share_url = url_for('view_caja', uuid_caja=caja.uuid, _external=True)
    return render_template('qrcode_card.html', qr_url=qr_image_url, entity_type='Caja', tag_id=uuid_caja, share_url=share_url)


@app.route('/productos/<uuid_producto>', endpoint='product_detail')
@login_required
def product_detail(uuid_producto):
    """
    Vista para mostrar los detalles de un producto específico.

    Args:
        uuid_producto (str): UUID del producto.

    Returns:
        Renderiza la plantilla 'product_detail.html' con los detalles del producto.
    """
    producto = Producto.query.join(Caja).join(Bodega).filter(
        Producto.uuid == uuid_producto,
        Bodega.user_id == current_user.id
    ).first_or_404(description='Producto no encontrado.')
    
    delete_producto_form = DeleteProductoForm()
    return render_template('product_detail.html', producto=producto, delete_producto_form=delete_producto_form)


@app.route('/cajas/<uuid_caja>/productos/nuevo', methods=['GET', 'POST'])
@login_required
def create_producto(uuid_caja):
    # Verificar que la caja exista usando el uuid proporcionado
    caja = Caja.query.filter_by(uuid=uuid_caja).first_or_404(description='Caja no encontrada.')

    form = ProductoForm()
    form.caja_id = caja.id  # Asigna el ID de la caja al formulario si es necesario

    if form.validate_on_submit():
        # Verificar si ya existe un producto con el mismo ID en esta caja usando exists
        producto_existente = db.session.query(exists().where(
            Producto.id_producto == form.id_producto.data,
            Producto.caja_id == caja.id
        )).scalar()

        if producto_existente:
            flash('Ya existe un producto con este ID en la caja.', 'danger')
            return redirect(url_for('create_producto', uuid_caja=uuid_caja))

        try:
            # Crear un nuevo producto
            nuevo_producto = Producto(
                id_producto=form.id_producto.data,
                nombre=form.nombre.data,
                descripcion=form.descripcion.data,
                cantidad=form.cantidad.data,
                categoria=form.categoria.data,
                subcategoria=form.subcategoria.data,
                caja_id=caja.id,
                notas=form.notas.data
            )
            db.session.add(nuevo_producto)
            db.session.commit()
            flash('Producto añadido correctamente.', 'success')
            return redirect(url_for('view_caja', uuid_caja=caja.uuid))
        except IntegrityError:
            db.session.rollback()
            flash('El ID del producto ya existe en esta caja.', 'danger')
            return redirect(url_for('create_producto', uuid_caja=uuid_caja))
        except Exception as e:
            db.session.rollback()
            print(f"Error al guardar producto: {e}")
            flash('Ocurrió un error inesperado. Por favor, inténtalo de nuevo.', 'danger')
            return redirect(url_for('create_producto', uuid_caja=uuid_caja))

    # Mostrar errores de validación si los hay
    if form.errors:
        for field, errors in form.errors.items():
            for error in errors:
                flash(f"Error en {field}: {error}", 'danger')

    return render_template('create_producto.html', form=form, caja=caja)


@app.route('/productos/<uuid_producto>/edit', methods=['GET', 'POST'], endpoint='edit_producto')
@login_required
def edit_producto(uuid_producto):
    """
    Vista para editar un producto específico.

    Args:
        uuid_producto (str): UUID del producto a editar.

    Returns:
        Renderiza la plantilla 'edit_producto.html' con el formulario de edición o redirige al detalle del producto.
    """
    producto = Producto.query.filter_by(uuid=uuid_producto).first_or_404()
    form = EditProductoForm(original_id_producto=producto.id_producto, obj=producto)  # Utiliza EditProductoForm

    if form.validate_on_submit():
        # Actualizar los campos del producto
        producto.id_producto = form.id_producto.data
        producto.nombre = form.nombre.data
        producto.descripcion = form.descripcion.data
        producto.cantidad = form.cantidad.data
        producto.categoria = form.categoria.data
        producto.subcategoria = form.subcategoria.data
        producto.notas = form.notas.data

        try:
            db.session.commit()
            flash('Producto actualizado exitosamente.', 'success')
            return redirect(url_for('product_detail', uuid_producto=producto.uuid))
        except Exception as e:
            db.session.rollback()
            print(f"Error al actualizar el producto: {e}")
            flash('Hubo un error al actualizar el producto. Por favor, intenta de nuevo.', 'danger')

    return render_template('edit_producto.html', form=form, producto=producto)


@app.route('/productos/<uuid_producto>/delete', methods=['POST'], endpoint='delete_producto')
@login_required
def delete_producto(uuid_producto):
    """
    Vista para eliminar un producto específico.

    Args:
        uuid_producto (str): UUID del producto a eliminar.

    Returns:
        Redirige a la vista de la caja correspondiente con un mensaje de éxito o error.
    """
    producto = Producto.query.filter_by(uuid=uuid_producto).first_or_404()

    form = DeleteProductoForm()  # Asegúrate de tener un formulario CSRF para la eliminación
    if form.validate_on_submit():
        try:
            db.session.delete(producto)
            db.session.commit()
            flash('Producto eliminado exitosamente.', 'success')
        except Exception as e:
            db.session.rollback()
            print(f"Error al eliminar el producto: {e}")
            flash('Hubo un error al eliminar el producto. Por favor, intenta de nuevo.', 'danger')
    else:
        flash('Formulario inválido o token CSRF no válido.', 'danger')

    return redirect(url_for('view_caja', uuid_caja=producto.caja.uuid))


@app.route('/productos/<uuid_producto>/qrcode_image', methods=['GET'])
@login_required
def producto_qrcode_image(uuid_producto):
    producto = Producto.query.filter_by(uuid=uuid_producto, caja_id=Producto.caja_id).first_or_404()
    url = url_for('product_detail', uuid_producto=producto.uuid, _external=True)
    # Generar el código QR
    qr_img = qrcode.make(url)
    img_io = BytesIO()
    qr_img.save(img_io, 'PNG')
    img_io.seek(0)
    return send_file(img_io, mimetype='image/png')


@app.route('/productos/qrcode/<uuid_producto>', methods=['GET'])
@login_required
def producto_qrcode(uuid_producto):
    # Asegurarse de que el producto pertenece a una caja del usuario actual
    producto = Producto.query.join(Caja).join(Bodega).filter(
        Producto.uuid == uuid_producto,
        Bodega.user_id == current_user.id
    ).first_or_404()
    
    qr_image_url = url_for('producto_qrcode_image', uuid_producto=producto.uuid)
    share_url = url_for('product_detail', uuid_producto=producto.uuid, _external=True)
    
    return render_template(
        'qrcode_card.html',
        qr_url=qr_image_url,
        entity_type='Producto',
        tag_id=uuid_producto,
        share_url=share_url
    )


# Rutas para DashboardItem (Definidas una sola vez)
@app.route('/create_dashboard_item', methods=['POST'])
@login_required
def create_dashboard_item():
    data = request.get_json()
    name = data.get('name')
    item_type = data.get('item_type')

    if not name or not item_type:
        return jsonify({'error': 'Datos incompletos'}), 400

    new_item = DashboardItem(
        name=name,
        item_type=item_type,
        user_id=current_user.id
    )
    db.session.add(new_item)
    db.session.commit()

    return jsonify({'uuid': new_item.uuid}), 200


@app.route('/delete_dashboard_item', methods=['POST'])
@login_required
def delete_dashboard_item():
    data = request.get_json()
    item_uuid = data.get('uuid')
    if not item_uuid:
        return jsonify({'error': 'UUID no proporcionado'}), 400

    item = DashboardItem.query.filter_by(uuid=item_uuid, user_id=current_user.id).first()
    if not item:
        return jsonify({'error': 'Ítem no encontrado o no autorizado'}), 404

    try:
        db.session.delete(item)
        db.session.commit()
        return jsonify({'success': True}), 200
    except Exception as e:
        db.session.rollback()
        return jsonify({'error': 'Error al eliminar el ítem.'}), 500


@app.route('/get_ratings_data', methods=['GET'])
@login_required
def get_ratings_data():
    """
    Devuelve un JSON con:
      {
        "ratings": { "1": [...], "2": [...], ..., "10": [...] },
        "dates": ["YYYY-MM-DD", ..., "YYYY-MM-DD"],
        "details": {
          "YYYY-MM-DD": [
            {"rating": 7, "comment": "Algún comentario"},
            ...
          ],
          ...
        }
      }
    """
    item_uuid = request.args.get('item_uuid')
    if not item_uuid:
        return jsonify({"error": "Falta item_uuid"}), 400

    # Verificar que el item exista y pertenezca al usuario actual
    item = DashboardItem.query.filter_by(uuid=item_uuid, user_id=current_user.id).first()
    if not item:
        return jsonify({"error": "Item no encontrado"}), 404

    # Últimos 10 días
    today = datetime.utcnow().date()
    dates = [(today - timedelta(days=i)) for i in range(10)]
    dates.sort()

    # Diccionario para totales de rating 1..10
    ratingsData = {str(r): [0]*10 for r in range(1, 11)}

    # Diccionario para detalles (día -> lista de {rating, comment})
    detailsByDay = {d.strftime('%Y-%m-%d'): [] for d in dates}

    # Rango de fechas
    start_datetime = datetime.combine(dates[0], datetime.min.time())
    end_datetime = datetime.combine(dates[-1] + timedelta(days=1), datetime.min.time())

    # Filtrar las respuestas en ese rango
    responses = SurveyResponse.query.filter(
        SurveyResponse.item_id == item.id,
        SurveyResponse.timestamp >= start_datetime,
        SurveyResponse.timestamp < end_datetime
    ).all()

    # Sumar totales y guardar detalles
    for resp in responses:
        resp_date = resp.timestamp.date()
        if resp_date in dates:
            day_index = dates.index(resp_date)
            rating_str = str(resp.rating)
            # Incrementar conteo
            if rating_str in ratingsData:
                ratingsData[rating_str][day_index] += 1

            # Guardar detalle (rating, comentario)
            date_key = resp_date.strftime('%Y-%m-%d')
            detailsByDay[date_key].append({
                "rating": resp.rating,
                "comment": resp.comment or "Sin Comentario"
            })

    # Convertir fechas a string p.e. YYYY-MM-DD
    sorted_dates_str = [d.strftime('%Y-%m-%d') for d in dates]

    return jsonify({
        "ratings": ratingsData,
        "dates": sorted_dates_str,
        "details": detailsByDay
    })


@app.route('/survey/<item_uuid>')
def survey(item_uuid):
    """
    Muestra la encuesta para un DashboardItem específico.
    - "Evaluación de Clientes" => encuesta NPS (1..10).
    - "Visualizaciones diarias" => una página placeholder.
    - "Evaluación de Semáforo" => otra encuesta, si lo deseas.
    """
    item = DashboardItem.query.filter_by(uuid=item_uuid).first()
    if not item:
        return "Este ítem no existe o ha sido eliminado.", 404

    if item.item_type == "Evaluación de Clientes":
        # Renderiza la encuesta NPS (1..10)
        return render_template('encuesta_evaluacion.html', item_uuid=item_uuid)
    elif item.item_type == "Visualizaciones diarias":
        return "Esta sección mostrará un resultado distinto para 'Visualizaciones diarias'."
    elif item.item_type == "Evaluación de Semáforo":
        return "Aquí podrías mostrar la encuesta de 1..3 (Semáforo)."
    else:
        return "Tipo de ítem desconocido."


@app.route('/survey/submit/<item_uuid>', methods=['POST'])
def submit_survey(item_uuid):
    """
    Procesa la respuesta de la encuesta. Almacena rating 1..10 y comentario.
    Muestra una pantalla de gracias (survey_thanks.html) o un template de error.
    """
    evaluation = request.form.get('evaluation')
    comment = request.form.get('comment', '')

    # Buscar el ítem
    item = DashboardItem.query.filter_by(uuid=item_uuid).first()
    if not item:
        return render_template('survey_error.html', message="Item no encontrado"), 404

    # Verificar que el item admita evaluaciones
    if item.item_type not in ["Evaluación de Clientes", "Evaluación de Semáforo"]:
        return render_template('survey_error.html', message="Este ítem no admite evaluaciones."), 400

    # Guardar la respuesta en SurveyResponse
    try:
        rating_value = int(evaluation)  # rating entre 1..10
        new_response = SurveyResponse(
            item_id=item.id,
            rating=rating_value,
            comment=comment,
            timestamp=datetime.utcnow()
        )
        db.session.add(new_response)
        db.session.commit()

        # Retornar survey_thanks.html con rating_value
        #             ↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓↓
        return render_template('survey_thanks.html', item=item, rating=rating_value), 200
        #                                    ↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑↑
        # Con "rating" pasamos el valor entero al template para mostrar 
        # un mensaje distinto según el puntaje.

    except Exception as e:
        db.session.rollback()
        return render_template('survey_error.html', message="Hubo un error al guardar tu evaluación."), 500

# --------------------------------------------------
# Rutas para generar y mostrar el Código QR de la encuesta
# --------------------------------------------------

@app.route('/survey_qrcode/<item_uuid>')
@login_required
def survey_qrcode(item_uuid):
    """
    Genera la página con el QR de la encuesta para un DashboardItem (item_uuid).
    Muestra el template qrcode_card.html.
    """
    # Verificar que el Item pertenezca al usuario logueado
    item = DashboardItem.query.filter_by(uuid=item_uuid, user_id=current_user.id).first()
    if not item:
        flash("Este ítem no existe o no te pertenece.", "danger")
        return redirect(url_for('profile'))

    # Construimos la URL de la encuesta, p. ej. /survey/<item_uuid> en forma absoluta (_external=True)
    survey_url = url_for('survey', item_uuid=item_uuid, _external=True)

    # Apuntamos a la ruta que devuelve la imagen en PNG
    # (survey_qrcode_image, que definimos abajo)
    qr_image_url = url_for('survey_qrcode_image', item_uuid=item_uuid, _external=True)

    # Reutilizamos el template qrcode_card.html
    # Parametrizamos para que se muestre "Encuesta" como entity_type
    # y la URL absoluta en "share_url" para que el usuario pueda copiarla.
    return render_template(
        'qrcode_card.html',
        qr_url=qr_image_url,
        entity_type='Encuesta',
        tag_id=item_uuid,      # Uso de "tag_id" para mantener tu estructura qrcode_card
        share_url=survey_url   # URL que el usuario puede copiar
    )


@app.route('/survey_qrcode_image/<item_uuid>')
@login_required
def survey_qrcode_image(item_uuid):
    """
    Devuelve la imagen PNG del QR, sin template intermedio.
    El QR apunta a la URL de la encuesta: /survey/<item_uuid>.
    """
    # Verificar que el Item pertenezca al usuario logueado
    item = DashboardItem.query.filter_by(uuid=item_uuid, user_id=current_user.id).first()
    if not item:
        abort(404, description="Ítem no encontrado.")

    # Construimos la URL final de la encuesta
    survey_url = url_for('survey', item_uuid=item_uuid, _external=True)

    # Generamos el QR
    img = qrcode.make(survey_url)
    buf = BytesIO()
    img.save(buf, format='PNG')
    buf.seek(0)

    # Devolvemos la imagen QR como 'image/png'
    return send_file(buf, mimetype='image/png')

@app.after_request
def add_header(response):
    """
    Deshabilita el cache del lado del navegador para evitar que
    se muestren datos antiguos.
    """
    response.headers['Cache-Control'] = 'no-store, no-cache, must-revalidate, post-check=0, pre-check=0, max-age=0'
    response.headers['Pragma'] = 'no-cache'
    response.headers['Expires'] = '-1'
    return response

# Si tu aplicación principal se ejecuta aquí:
if __name__ == '__main__':
    db.create_all(app=app)
    app.run(debug=True)

----- Fin de app.py -----

----- Inicio de extensions.py -----
# extensions.py

from flask_sqlalchemy import SQLAlchemy
from flask_migrate import Migrate
from flask_bcrypt import Bcrypt
from flask_login import LoginManager
from flask_mail import Mail
from authlib.integrations.flask_client import OAuth

db = SQLAlchemy()
migrate = Migrate()
bcrypt = Bcrypt()
login_manager = LoginManager()
mail = Mail()
oauth = OAuth()

----- Fin de extensions.py -----

----- Inicio de forms.py -----
# forms.py

from flask_wtf import FlaskForm
from wtforms import StringField, PasswordField, SubmitField, BooleanField, FileField, TextAreaField, SelectField, IntegerField, HiddenField
from wtforms.validators import DataRequired, Length, Email, EqualTo, ValidationError, Optional, Regexp
from flask_wtf.file import FileAllowed
from models import User

class VerificationForm(FlaskForm):
    verification_code = StringField('Código de Verificación', validators=[DataRequired(), Length(min=6, max=6)])
    submit = SubmitField('Verificar')

class RegistrationForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired(), Length(min=3, max=20)])
    email = StringField('Email', validators=[DataRequired(), Email()])
    submit = SubmitField('Register')

    def validate_username(self, username):
        user = User.query.filter_by(username=username.data).first()
        if user:
            raise ValidationError('Ese nombre de usuario ya está tomado. Por favor, elige otro.')

    def validate_email(self, email):
        user = User.query.filter_by(email=email.data).first()
        if user:
            raise ValidationError('Ese correo electrónico ya está en uso. Por favor, elige otro.')

class LoginForm(FlaskForm):
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    password = PasswordField('Contraseña', validators=[DataRequired()])
    remember = BooleanField('Recuérdame')
    submit = SubmitField('Iniciar Sesión')

class UpdateAccountForm(FlaskForm):
    username = StringField('Nombre de Usuario', validators=[DataRequired(), Length(min=2, max=20)])
    current_password = PasswordField('Contraseña Actual', validators=[DataRequired()])
    password = PasswordField('Nueva Contraseña', validators=[
        Optional(),
        Length(min=8, message='La nueva contraseña debe tener al menos 8 caracteres.'),
        Regexp(r'^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$', message='La nueva contraseña debe incluir al menos una letra mayúscula, una minúscula, un número y un carácter especial.')])
    confirm_password = PasswordField('Confirmar Nueva Contraseña', validators=[Optional(), EqualTo('password', message='Las contraseñas deben coincidir')])
    submit = SubmitField('Actualizar')

class RequestResetForm(FlaskForm):
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    submit = SubmitField('Solicitar Restablecimiento de Contraseña')

    def validate_email(self, email):
        user = User.query.filter_by(email=email.data).first()
        if user is None:
            raise ValidationError('No hay una cuenta con ese correo electrónico. Debes registrarte primero.')

class ResetPasswordForm(FlaskForm):
    password = PasswordField('Contraseña', validators=[
        DataRequired(),
        Length(min=8, message='La contraseña debe tener al menos 8 caracteres.'),
        Regexp(r'^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$', message='La contraseña debe incluir al menos una letra mayúscula, una minúscula, un número y un carácter especial (@$!%*?&).')])
    confirm_password = PasswordField('Confirmar Contraseña', validators=[DataRequired(), EqualTo('password')])
    submit = SubmitField('Restablecer Contraseña')

class PulzcardForm(FlaskForm):
    card_name = StringField('Nombre de la Tarjeta', validators=[DataRequired()])
    first_name = StringField('Nombre', validators=[DataRequired()])
    last_name = StringField('Apellido', validators=[DataRequired()])
    organization = StringField('Organización', validators=[DataRequired()])
    position = StringField('Cargo', validators=[DataRequired()])
    phone = StringField('Teléfono', validators=[DataRequired()])
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    website = StringField('Sitio Web', validators=[DataRequired()])
    address = StringField('Dirección', validators=[DataRequired()])
    image_file = FileField('Imagen de Perfil', validators=[FileAllowed(['jpg', 'png'])])
    template = SelectField('Plantilla', choices=[('template1', 'Plantilla 1'), ('template2', 'Plantilla 2'), ('template3', 'Plantilla 3')], validators=[DataRequired()])
    submit = SubmitField('Crear Tarjeta')

class EditPulzcardForm(FlaskForm):
    card_name = StringField('Nombre de la Tarjeta', validators=[DataRequired()])
    first_name = StringField('Nombre', validators=[DataRequired()])
    last_name = StringField('Apellido', validators=[DataRequired()])
    organization = StringField('Organización', validators=[DataRequired()])
    position = StringField('Cargo', validators=[DataRequired()])
    phone = StringField('Teléfono', validators=[DataRequired()])
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    website = StringField('Sitio Web', validators=[DataRequired()])
    address = StringField('Dirección', validators=[DataRequired()])
    image_file = FileField('Actualizar Imagen de Perfil', validators=[FileAllowed(['jpg', 'png'])])
    template = SelectField('Plantilla', choices=[('template1', 'Plantilla 1'), ('template2', 'Plantilla 2'), ('template3', 'Plantilla 3')], validators=[DataRequired()])
    submit = SubmitField('Actualizar Tarjeta')

class DeletePulzcardForm(FlaskForm):
    submit = SubmitField('Eliminar')

class ImportPulzcardForm(FlaskForm):
    excelFile = FileField('Archivo Excel', validators=[
        DataRequired(message='Por favor, selecciona un archivo Excel.'),
        FileAllowed(['xlsx', 'xls'], 'Solo se permiten archivos de Excel (.xlsx, .xls).')
    ])
    submit = SubmitField('Importar Pulzcards')

class BulkDeletePulzcardForm(FlaskForm):
    submit = SubmitField('Eliminar Selección')

class ContactForm(FlaskForm):
    nombre = StringField('Nombre', validators=[DataRequired()])
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    mensaje = TextAreaField('Mensaje', validators=[DataRequired()])
    submit = SubmitField('Enviar')


class OrderForm(FlaskForm):
    nombre = StringField('Nombre', validators=[DataRequired()])
    email = StringField('Correo Electrónico', validators=[DataRequired(), Email()])
    dispositivo = SelectField('Selecciona un Dispositivo', choices=[
        ('', 'Selecciona producto'),
        ('Etiqueta de Sticker de RR.SS. NFC Antimetal.', 'Etiqueta de Sticker de RR.SS. NFC Antimetal.'),
        ('Tarjetas PVC Inteligentes NFC.', 'Tarjetas PVC Inteligentes NFC.'),
        ('Soporte de Menú de Acrílico con Código QR y NFC.', 'Soporte de Menú de Acrílico con Código QR y NFC.'),
        ('Pulseras Tejidas NFC Personalizables.', 'Pulseras Tejidas NFC Personalizables.'),
        ('Pulsera NFC de silicona ecológica.', 'Pulsera NFC de silicona ecológica.'),
        ('Etiqueta NFC de Redes Sociales Epoxy.', 'Etiqueta NFC de Redes Sociales Epoxy.'),
        ('Tarjetas de Madera NFC Empresariales Personalizables', 'Tarjetas de Madera NFC Empresariales Personalizables'),
        ('Tarjeta PVC Reescribible Blanca o Negra Personalizable.', 'Tarjeta PVC Reescribible Blanca o Negra Personalizable.'),
        ('Tarjetas Redondas NFC de PVC Duro NTAG personalizables', 'Tarjetas Redondas NFC de PVC Duro NTAG personalizables')
    ], validators=[DataRequired(message="Por favor, selecciona un dispositivo.")])
    mensaje = TextAreaField('¿Qué necesitas?', validators=[DataRequired()])
    submit = SubmitField('Enviar solicitud')

class TagForm(FlaskForm):
    tag_name = StringField('Nombre de la Etiqueta', validators=[DataRequired()])
    redirect_url = StringField('URL de Redirección', validators=[DataRequired()])
    submit = SubmitField('Crear Etiqueta')

class EditTagForm(FlaskForm):
    tag_name = StringField('Nombre de la Etiqueta', validators=[DataRequired()])
    redirect_url = StringField('URL de Redirección', validators=[DataRequired()])
    submit = SubmitField('Actualizar Etiqueta')

class DeleteTagForm(FlaskForm):
    submit = SubmitField('Eliminar')

class ImportTagsForm(FlaskForm):
    excelFile = FileField('Archivo Excel', validators=[
        DataRequired(message='Por favor, selecciona un archivo Excel.'),
        FileAllowed(['xlsx', 'xls'], 'Solo se permiten archivos de Excel (.xlsx, .xls).')
    ])
    submit = SubmitField('Importar Etiquetas')

class BodegaForm(FlaskForm):
    nombre = StringField('Nombre de la Bodega', validators=[DataRequired()])
    ubicacion = StringField('Ubicación', validators=[Optional()])
    notas = TextAreaField('Notas', validators=[Optional()])
    submit = SubmitField('Crear Bodega')

class EditBodegaForm(FlaskForm):
    nombre = StringField('Nombre de la Bodega', validators=[DataRequired()])
    ubicacion = StringField('Ubicación', validators=[Optional()])
    notas = TextAreaField('Notas', validators=[Optional()])
    submit = SubmitField('Actualizar Bodega')

class DeleteBodegaForm(FlaskForm):
    submit = SubmitField('Eliminar')

class CajaForm(FlaskForm):
    nombre = StringField('Nombre de la Caja', validators=[DataRequired()])
    categoria = StringField('Categoría', validators=[Optional()])
    notas = TextAreaField('Notas', validators=[Optional()])
    submit = SubmitField('Guardar')

class EditCajaForm(FlaskForm):
    nombre = StringField('Nombre de la Caja', validators=[DataRequired()])
    categoria = StringField('Categoría', validators=[Optional()])
    notas = TextAreaField('Notas', validators=[Optional()])
    bodega_id = SelectField('Bodega', coerce=int, validators=[DataRequired()])  # Añadido para seleccionar la bodega
    submit = SubmitField('Actualizar')

class DeleteCajaForm(FlaskForm):
    submit = SubmitField('Eliminar')

class ProductoForm(FlaskForm):
    id_producto = StringField('ID Producto', validators=[DataRequired(), Length(max=10)])
    nombre = StringField('Nombre', validators=[DataRequired(), Length(max=255)])
    descripcion = TextAreaField('Descripción', validators=[Optional()])
    cantidad = IntegerField('Cantidad', validators=[DataRequired()])
    categoria = StringField('Categoría', validators=[Optional(), Length(max=100)])  # Nuevo campo
    subcategoria = StringField('Subcategoría', validators=[Optional(), Length(max=100)])  # Nuevo campo
    notas = TextAreaField('Notas', validators=[Optional()])
    submit = SubmitField('Guardar Producto')

class EditProductoForm(FlaskForm):
    id_producto = StringField('ID Producto', validators=[DataRequired(), Length(max=10)])
    nombre = StringField('Nombre', validators=[DataRequired(), Length(max=255)])
    descripcion = TextAreaField('Descripción', validators=[Optional()])
    cantidad = IntegerField('Cantidad', validators=[DataRequired()])
    categoria = StringField('Categoría', validators=[Optional(), Length(max=100)])
    subcategoria = StringField('Subcategoría', validators=[Optional(), Length(max=100)])
    notas = TextAreaField('Notas', validators=[Optional()])
    submit = SubmitField('Actualizar Producto')

class DeleteProductoForm(FlaskForm):
    submit = SubmitField('Eliminar')

class BulkDeleteTagForm(FlaskForm):
    submit = SubmitField('Eliminar Selección')

class DeleteDashboardItemForm(FlaskForm):
    submit = SubmitField('Eliminar')
    # Si necesitas, puedes añadir un campo oculto para el UUID
    item_uuid = HiddenField('UUID', validators=[DataRequired()])

----- Fin de forms.py -----

----- Inicio de minimal_app.py -----
# minimal_app.py

import os

from flask import Flask
from extensions import db, migrate

app = Flask(__name__, instance_relative_config=True)

# Crear el directorio 'instance' si no existe
instance_dir = os.path.join(app.instance_path)
os.makedirs(instance_dir, exist_ok=True)

app.config['SQLALCHEMY_DATABASE_URI'] = f'sqlite:///{os.path.join(instance_dir, "site_new.db")}'
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False
app.secret_key = os.getenv('SECRET_KEY', 'test_secret_key')

db.init_app(app)
migrate.init_app(app, db)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(20), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(60), nullable=False)

if __name__ == '__main__':
    with app.app_context():
        db.create_all()  # Asegura que la base de datos y las tablas se creen
    app.run(debug=os.getenv('FLASK_DEBUG', 'False') == 'True')

----- Fin de minimal_app.py -----

----- Inicio de models.py -----
# models.py

from extensions import db
from flask_admin.contrib.sqla import ModelView
from flask_login import UserMixin, current_user
from itsdangerous import URLSafeTimedSerializer, SignatureExpired
from flask import current_app, redirect, url_for, flash, request
from datetime import datetime
from sqlalchemy.dialects.postgresql import UUID
import uuid

class User(db.Model, UserMixin):
    __tablename__ = 'users'
    
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(150), unique=True, nullable=False)
    email = db.Column(db.String(120), unique=True, nullable=False)
    password = db.Column(db.String(60), nullable=True)  # Permitido nulo inicialmente
    is_admin = db.Column(db.Boolean, default=False)
    is_verified = db.Column(db.Boolean, default=False)
    must_change_password = db.Column(db.Boolean, default=True)

    # Relaciones con otros modelos
    pulzcards = db.relationship('Pulzcard', back_populates='user', lazy=True, cascade="all, delete-orphan")
    tags = db.relationship('Tag', back_populates='user', lazy=True, cascade="all, delete-orphan")
    bodegas = db.relationship('Bodega', back_populates='user', lazy=True, cascade="all, delete-orphan")
    dashboard_items = db.relationship('DashboardItem', back_populates='user', lazy=True, cascade="all, delete-orphan")

    def get_reset_token(self, expires_sec=3600):
        s = URLSafeTimedSerializer(current_app.config['SECRET_KEY'])
        return s.dumps(self.email, salt='password-reset-salt')

    @staticmethod
    def verify_reset_token(token, expires_sec=3600):
        s = URLSafeTimedSerializer(current_app.config['SECRET_KEY'])
        try:
            email = s.loads(token, salt='password-reset-salt', max_age=expires_sec)
        except SignatureExpired:
            return None
        except Exception:
            return None
        return User.query.filter_by(email=email).first()

    def __repr__(self):
        return f"User('{self.username}', '{self.email}')"

class Pulzcard(db.Model):
    __tablename__ = 'pulzcards'
    
    id = db.Column(db.Integer, primary_key=True)
    card_name = db.Column(db.String(100), nullable=False)
    first_name = db.Column(db.String(50), nullable=False)
    last_name = db.Column(db.String(50), nullable=False)
    organization = db.Column(db.String(100), nullable=False)
    position = db.Column(db.String(100), nullable=False)
    phone = db.Column(db.String(20), nullable=False)
    email = db.Column(db.String(120), nullable=False)
    website = db.Column(db.String(200), nullable=False)
    address = db.Column(db.String(200), nullable=False)
    card_id = db.Column(db.String(36), unique=True, nullable=False, default=lambda: str(uuid.uuid4()))
    created_at = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    image_file = db.Column(db.String(100), nullable=True, default='default.jpg')
    template = db.Column(db.String(20), nullable=False, default='template1')

    # Clave foránea hacia User
    user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)

    # Relación con User usando back_populates
    user = db.relationship('User', back_populates='pulzcards')

    def __repr__(self):
        return f"Pulzcard('{self.card_name}', '{self.email}')"

class Tag(db.Model):
    __tablename__ = 'tags'
    
    id = db.Column(db.Integer, primary_key=True)
    tag_name = db.Column(db.String(100), nullable=False)
    redirect_url = db.Column(db.String(200), nullable=False)
    created_at = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    tag_id = db.Column(db.String(36), unique=True, nullable=False, default=lambda: str(uuid.uuid4()))
    vistas = db.Column(db.Integer, default=0, nullable=False)

    # Clave foránea hacia User
    user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)

    # Relación con User usando back_populates
    user = db.relationship('User', back_populates='tags')

    def __repr__(self):
        return f"Tag('{self.tag_name}', '{self.redirect_url}', '{self.tag_id}', Vistas: {self.vistas})"

class Bodega(db.Model):
    __tablename__ = 'bodegas'
    
    id = db.Column(db.Integer, primary_key=True)
    id_bodega = db.Column(db.String(10), unique=True, nullable=False)
    nombre = db.Column(db.String(255), nullable=False)
    ubicacion = db.Column(db.String(255), nullable=True)
    notas = db.Column(db.Text, nullable=True)
    fecha_creacion = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)
    uuid = db.Column(db.String(36), unique=True, nullable=False, default=lambda: str(uuid.uuid4()))
    
    # Relación con User usando back_populates
    user = db.relationship('User', back_populates='bodegas')
    
    # Relación con Caja usando back_populates
    cajas = db.relationship('Caja', back_populates='bodega', lazy=True, cascade="all, delete-orphan")

    def __repr__(self):
        return f"<Bodega(id_bodega='{self.id_bodega}', nombre='{self.nombre}')>"

class Caja(db.Model):
    __tablename__ = 'cajas'
    
    id = db.Column(db.Integer, primary_key=True)
    id_caja = db.Column(db.String(10), unique=True, nullable=False)
    nombre = db.Column(db.String(255), nullable=False)
    categoria = db.Column(db.String(255), nullable=True)
    notas = db.Column(db.Text, nullable=True)
    fecha_creacion = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    bodega_id = db.Column(db.Integer, db.ForeignKey('bodegas.id', ondelete='CASCADE'), nullable=False)
    uuid = db.Column(db.String(36), unique=True, nullable=False, default=lambda: str(uuid.uuid4()))
    
    # Relación con Bodega usando back_populates
    bodega = db.relationship('Bodega', back_populates='cajas')
    
    # Relación con Producto usando back_populates
    productos = db.relationship('Producto', back_populates='caja', lazy=True, cascade="all, delete-orphan")

    def __repr__(self):
        return f"<Caja(id_caja='{self.id_caja}', nombre='{self.nombre}')>"

class Producto(db.Model):
    __tablename__ = 'productos'
    
    id = db.Column(db.Integer, primary_key=True)
    id_producto = db.Column(db.String(10), nullable=False)
    nombre = db.Column(db.String(255), nullable=False)
    descripcion = db.Column(db.Text, nullable=True)
    cantidad = db.Column(db.Integer, nullable=False, default=0)
    categoria = db.Column(db.String(100), nullable=True)
    subcategoria = db.Column(db.String(100), nullable=True)
    fecha_creacion = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    caja_id = db.Column(db.Integer, db.ForeignKey('cajas.id', ondelete='CASCADE'), nullable=False)
    uuid = db.Column(db.String(36), unique=True, nullable=False, default=lambda: str(uuid.uuid4()))
    
    # Agregar el campo 'notas'
    notas = db.Column(db.Text, nullable=True)

    # Relación con Caja usando back_populates
    caja = db.relationship('Caja', back_populates='productos')

    def __repr__(self):
        return f"<Producto(id_producto='{self.id_producto}', nombre='{self.nombre}', cantidad={self.cantidad})>"

class DashboardItem(db.Model):
    __tablename__ = 'dashboard_items'

    id = db.Column(db.Integer, primary_key=True)
    uuid = db.Column(UUID(as_uuid=True), default=uuid.uuid4, unique=True, nullable=False)
    name = db.Column(db.String(100), nullable=False)
    item_type = db.Column(db.String(50), nullable=False)
    user_id = db.Column(db.Integer, db.ForeignKey('users.id'), nullable=False)
    created_at = db.Column(db.DateTime, default=datetime.utcnow)

    # Relación con User usando back_populates
    user = db.relationship('User', back_populates='dashboard_items')

    # Relación con SurveyResponse usando back_populates
    responses = db.relationship('SurveyResponse', back_populates='item', lazy=True, cascade="all, delete-orphan")

    def __repr__(self):
        return f"<DashboardItem {self.name} for User {self.user_id}>"

class SurveyResponse(db.Model):
    __tablename__ = 'survey_responses'
    id = db.Column(db.Integer, primary_key=True, autoincrement=True)
    item_id = db.Column(db.Integer, db.ForeignKey('dashboard_items.id'), nullable=False)
    rating = db.Column(db.Integer, nullable=False)
    comment = db.Column(db.String(500), nullable=True)  # Comentario opcional
    timestamp = db.Column(db.DateTime, nullable=False, default=datetime.utcnow)
    
    # Relación con DashboardItem usando back_populates
    item = db.relationship('DashboardItem', back_populates='responses', lazy=True)

    def __repr__(self):
        return f"<SurveyResponse(item_id='{self.item_id}', rating={self.rating})>"

class SecureModelView(ModelView):
    def is_accessible(self):
        return current_user.is_authenticated and current_user.is_admin  # Verifica si el usuario es admin

    def inaccessible_callback(self, name, **kwargs):
        return redirect(url_for('login', next=request.url))

----- Fin de models.py -----

----- Inicio de requirements.txt -----
aiohappyeyeballs==2.4.4
aiohttp==3.11.10
aiosignal==1.3.1
alembic==1.13.3
attrs==24.2.0
Authlib==1.3.2
bcrypt==4.2.0
blinker==1.8.2
Bootstrap-Flask==2.4.1
certifi==2024.8.30
cffi==1.17.1
charset-normalizer==3.4.0
click==8.1.7
cryptography==43.0.3
dnspython==2.7.0
email_validator==2.2.0
et-xmlfile==1.1.0
Flask==3.0.3
Flask-Admin==1.6.1
Flask-Bcrypt==1.0.1
Flask-Login==0.6.3
Flask-Mail==0.10.0
Flask-Migrate==4.0.7
Flask-SQLAlchemy==3.1.1
Flask-WTF==1.2.1
frozenlist==1.5.0
geoip2==4.8.1
gunicorn==23.0.0
idna==3.10
itsdangerous==2.2.0
Jinja2==3.1.4
lxml==5.3.0
Mako==1.3.5
MarkupSafe==2.1.5
maxminddb==2.6.2
multidict==6.1.0
numpy==1.26.1
openpyxl==3.1.5
packaging==24.1
pandas==2.2.3
pillow==10.4.0
propcache==0.2.1
psycopg2-binary==2.9.10
pycparser==2.22
pypng==0.20220715.0
python-dateutil==2.9.0.post0
python-dotenv==1.0.1
python-pptx==1.0.2
pytz==2024.2
qrcode==7.4.2
requests==2.32.3
six==1.16.0
SQLAlchemy==2.0.36
typing_extensions==4.12.2
tzdata==2024.2
urllib3==2.2.3
Werkzeug==3.0.4
WTForms==3.1.2
XlsxWriter==3.2.0
yarl==1.18.3


----- Fin de requirements.txt -----

----- Inicio de site_backup.db -----


----- Fin de site_backup.db -----

----- Inicio de test_db.py -----
# test_db.py

from sqlalchemy import create_engine
import os

basedir = os.path.abspath(os.path.dirname(__file__))
db_path = os.path.join(basedir, 'instance', 'site_new.db')
db_uri = f'sqlite:///{db_path}'

engine = create_engine(db_uri)

try:
    connection = engine.connect()
    print("Conexión exitosa a la base de datos.")
    connection.close()
except Exception as e:
    print(f"Error al conectar a la base de datos: {e}")

----- Fin de test_db.py -----

----- instance/site_new.db no encontrado -----

----- migrations/__pycache__/__init__.cpython-311.pyc no encontrado -----

----- Inicio de templates/bodega_detail.html -----
<!-- templates/bodega_detail.html -->

{% extends "base.html" %}

{% block content %}
<h1>Detalles de la Bodega</h1>

<div class="card mb-3">
    <div class="card-header">
        <h2>{{ bodega.nombre }}</h2>
    </div>
    <div class="card-body">
        <p><strong>ID Bodega:</strong> {{ bodega.id_bodega }}</p>
        <p><strong>Fecha de Creación:</strong> {{ bodega.fecha_creacion.strftime('%d/%m/%Y') }}</p>
        <p><strong>Ubicación:</strong> {{ bodega.ubicacion }}</p>
        <p><strong>Notas:</strong> {{ bodega.notas }}</p>
    </div>
</div>

<!-- Modal para agregar Caja -->
<div class="modal fade" id="addCajaModal" tabindex="-1" aria-labelledby="addCajaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post">
        {{ form.hidden_tag() }}
        <div class="modal-header">
          <h5 class="modal-title">{{ bodega.nombre }} - Añadir Caja</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <!-- Campo Nombre -->
          <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="form-control") }}
            {% if form.nombre.errors %}
              <div class="text-danger">
                {% for error in form.nombre.errors %}
                  <span>{{ error }}</span>
                {% endfor %}
              </div>
            {% endif %}
          </div>
          <!-- Campo Categoría -->
          <div class="mb-3">
            {{ form.categoria.label(class="form-label") }}
            {{ form.categoria(class="form-control") }}
          </div>
          <!-- Campo Notas -->
          <div class="mb-3">
            {{ form.notas.label(class="form-label") }}
            {{ form.notas(class="form-control") }}
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
          {{ form.submit(class="btn btn-primary") }}
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Tabla de Cajas -->
<h2>Cajas</h2>
<table class="table table-striped">
    <thead>
        <tr>
            <th>ID Caja</th>
            <th>Nombre</th>
            <th>Categoría</th>
            <th>Fecha de Creación</th>
            <th>URL</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for caja in bodega.cajas %}
        <tr>
            <td><a href="{{ url_for('view_caja', uuid_caja=caja.uuid) }}">{{ caja.id_caja }}</a></td>
            <td>{{ caja.nombre }}</td>
            <td>{{ caja.categoria }}</td>
            <td>{{ caja.fecha_creacion.strftime('%d/%m/%Y') }}</td>
            <td>
              {% set caja_url = url_for('view_caja', uuid_caja=caja.uuid, _external=True) %}
              <a href="{{ caja_url }}" target="_blank">
                  {{ caja_url[:35] }}{% if caja_url|length > 35 %}...{% endif %}
              </a>
          </td>
            <td>
                <!-- Botón QR Code -->
                <a href="{{ url_for('caja_qrcode', uuid_caja=caja.uuid) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                    <i class="fas fa-qrcode"></i>
                </a>
                <!-- Botón Editar -->
                <a href="{{ url_for('edit_caja', uuid_caja=caja.uuid) }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                <form action="{{ url_for('delete_caja', uuid_caja=caja.uuid) }}" method="POST" style="display:inline;">
                    {{ delete_caja_forms[caja.uuid].hidden_tag() }}
                    <button type="submit" onclick="return confirm('¿Estás seguro de que deseas eliminar esta bodega? Esta acción no se puede deshacer.')" style="background:none; border:none; padding:0; cursor:pointer;">
                        <i class="fa-regular fa-eraser" style="color: rgb(252, 127, 156); font-size: 2.0em;"></i>
                    </button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="6">No hay cajas en esta bodega.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Botón para agregar nueva Caja -->
<button type="button" class="btn btn-primary mb-3" data-bs-toggle="modal" data-bs-target="#addCajaModal">
    Añadir Caja
</button>

{% endblock %}

----- Fin de templates/bodega_detail.html -----

----- Inicio de templates/caja_detail.html -----
<!-- templates/caja_detail.html -->

{% extends "base.html" %}

{% block content %}
<h1>Detalles de la Caja</h1>

<div class="card mb-3">
    <div class="card-header">
        <h2>{{ caja.nombre }}</h2>
    </div>
    <div class="card-body">
        <p><strong>ID Caja:</strong> {{ caja.id_caja }}</p>
        <p><strong>Categoría:</strong> {{ caja.categoria }}</p>
        <p><strong>Fecha de Creación:</strong> {{ caja.fecha_creacion.strftime('%d/%m/%Y') }}</p>
        <p><strong>Notas:</strong> {{ caja.notas }}</p>
        <p><strong>Bodega:</strong> <a href="{{ url_for('view_bodega', uuid_bodega=caja.bodega.uuid) }}">{{ caja.bodega.nombre }}</a></p>
    </div>
</div>

<!-- Tabla de Productos -->
<h2>Productos en esta Caja</h2>
<a href="{{ url_for('create_producto', uuid_caja=caja.uuid) }}" class="btn btn-primary mb-3">Añadir Producto</a>
<table class="table table-striped">
    <thead>
        <tr>
            <th>ID Producto</th>
            <th>Nombre</th>
            <th>Categoría</th>
            <th>Fecha de Creación</th>
            <th>URL</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for producto in caja.productos %}
        <tr>
            <td><a href="{{ url_for('product_detail', uuid_producto=producto.uuid) }}">{{ producto.id_producto }}</a></td>
            <td>{{ producto.nombre }}</td>
            <td>{{ producto.categoria }}</td>
            <td>{{ producto.fecha_creacion.strftime('%d/%m/%Y') }}</td>
            <td>
                {% set producto_url = url_for('product_detail', uuid_producto=producto.uuid, _external=True) %}
                <a href="{{ producto_url }}" target="_blank">{{ producto_url }}</a>
            </td>
            <td>
                <!-- Botón QR Code -->
                <a href="{{ url_for('producto_qrcode', uuid_producto=producto.uuid) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                    <i class="fas fa-qrcode"></i>
                </a>
                <!-- Botón Editar -->
                <a href="{{ url_for('edit_producto', uuid_producto=producto.uuid) }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                <!-- Botón Eliminar -->
                <form action="{{ url_for('delete_producto', uuid_producto=producto.uuid) }}" method="POST" style="display:inline;">
                    {{ delete_producto_form.hidden_tag() }}
                    <button type="submit" onclick="return confirm('¿Estás seguro de que deseas eliminar este producto? Esta acción no se puede deshacer.')" style="background:none; border:none; padding:0; cursor:pointer;">
                        <i class="fa-regular fa-eraser" style="color: rgb(252, 127, 156); font-size: 2.0em;"></i>
                    </button>
                </form>
            </td>
        </tr>
        {% else %}
        <tr>
            <td colspan="6">No hay productos en esta caja.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Botones adicionales -->
<a href="{{ url_for('edit_caja', uuid_caja=caja.uuid) }}" class="btn btn-sm btn-warning">Editar Caja</a>
<a href="{{ url_for('view_bodega', uuid_bodega=caja.bodega.uuid) }}" class="btn btn-secondary">Regresar a la Bodega</a>

{% endblock %}

----- Fin de templates/caja_detail.html -----

----- Inicio de templates/create_bodega.html -----
<!-- templates/create_bodega.html -->

{% extends 'base.html' %}

{% block title %}Crear Bodega - PulztagWeb{% endblock %}

{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Crear Nueva Bodega</h2>
    <form method="POST" action="{{ url_for('create_bodega') }}">
        {{ form.hidden_tag() }}
        <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="form-control", placeholder="Nombre de la Bodega") }}
            {% for error in form.nombre.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.ubicacion.label(class="form-label") }}
            {{ form.ubicacion(class="form-control", placeholder="Ubicación") }}
            {% for error in form.ubicacion.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.notas.label(class="form-label") }}
            {{ form.notas(class="form-control", placeholder="Notas") }}
            {% for error in form.notas.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <button type="submit" class="btn btn-success">{{ form.submit.label.text }}</button>
        <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}

----- Fin de templates/create_bodega.html -----

----- Inicio de templates/create_caja.html -----
<!-- templates/create_caja.html -->

{% extends 'base.html' %}

{% block title %}Crear Nueva Caja{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Crear Nueva Caja</h2>
    <form method="POST">
        {{ form.hidden_tag() }}
        <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="form-control", placeholder="Nombre de la Caja") }}
            {% for error in form.nombre.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.categoria.label(class="form-label") }}
            {{ form.categoria(class="form-control", placeholder="Categoría de la Caja") }}
            {% for error in form.categoria.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.notas.label(class="form-label") }}
            {{ form.notas(class="form-control", placeholder="Notas (opcional)") }}
            {% for error in form.notas.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <button type="submit" class="btn btn-success">Crear Caja</button>
        <a href="{{ url_for('view_bodega', uuid_bodega=bodega.uuid) }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}

----- Fin de templates/create_caja.html -----

----- Inicio de templates/create_item.html -----
<!-- templates/create_item.html -->

{% extends 'base.html' %}

{% block title %}Crear Item - PulztagWeb{% endblock %}

{% block content %}
<div class="container my-5">
    <!-- Sección de Encabezado -->
    <div class="text-center mb-5">
        <h2 class="titulo-seccion">Crea tu Nuevo Ítem NFC</h2>
        <p class="lead">Elige entre nuestras <strong>soluciones NFC personalizadas</strong> y comienza a compartir información de manera innovadora y eficiente.</p>
    </div>

    <!-- Opciones de Creación -->
    <section class="services-section">
        <div class="row justify-content-center">
            <!-- Opción Pulzcard -->
            <div class="col-md-5 col-lg-4 mb-4">
                <a href="{{ url_for('pulzcard') }}" class="text-decoration-none">
                    <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;" data-aos="fade-up">
                        <img src="{{ url_for('static', filename='images/pulzcard_form.png') }}" class="card-img-top rounded-top" alt="Pulzcard">
                        <div class="card-body text-center">
                            <h6 class="card-title fw-bold">Pulzcard (Tarjeta de Contacto Inteligente)</h6>
                            <p class="card-text mb-4">
                                Crea una <strong>Pulzcard</strong> con tu información de contacto, ideal para networking y marketing personal.
                            </p>
                            <a href="{{ url_for('pulzcard') }}" class="btn btn-outline-primary">Crea tu Pulzcard</a>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Opción Etiqueta -->
            <div class="col-md-5 col-lg-4 mb-4">
                <a href="{{ url_for('create_tag') }}" class="text-decoration-none">
                    <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;" data-aos="fade-up">
                        <img src="{{ url_for('static', filename='images/tags_form.png') }}" class="card-img-top rounded-top" alt="Etiqueta">
                        <div class="card-body text-center">
                            <h6 class="card-title fw-bold">Etiqueta NFC Interactiva</h6>
                            <p class="card-text mb-4">
                                Diseña una <strong>etiqueta NFC</strong> que redirija a URLs específicas y potencie tu contenido digital.
                            </p>
                            <a href="{{ url_for('create_tag') }}" class="btn btn-outline-primary">Crea tu Etiqueta</a>
                        </div>
                    </div>
                </a>
            </div>

            <!-- Opción Storetag -->
            <div class="col-md-5 col-lg-4 mb-4">
                <a href="{{ url_for('create_bodega') }}" class="text-decoration-none">
                    <div class="card mb-4 service-background" style="max-width: 100%; margin: auto;" data-aos="fade-up">
                        <img src="{{ url_for('static', filename='images/storetag_form.png') }}" class="card-img-top rounded-top" alt="Storetag">
                        <div class="card-body text-center">
                            <h6 class="card-title fw-bold">Storetag (Inventario NFC)</h6>
                            <p class="card-text mb-4">
                                Configura una <strong>Storetag</strong> para administrar y optimizar la gestión de tus bodegas y inventarios
                            </p>
                            <a href="{{ url_for('create_bodega') }}" class="btn btn-outline-primary">Crea tu Storetag</a>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </section>
</div>
{% endblock %}

{% block styles %}
<style>
    /* Título de la sección */
    .titulo-seccion {
        font-size: 2.2em;
        font-weight: bold;
        color: #013445;
        margin-bottom: 30px;
    }

    /* Ajuste del tamaño de las tarjetas */
    .service-card {
        max-width: 90%;
        margin: auto;
        border: 1px solid #e0f7ff;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .service-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
    }

    /* Imagen más pequeña */
    .card-img-top {
        height: 150px;
        object-fit: cover;
    }

    /* Padding reducido en el cuerpo de la tarjeta */
    .card-body {
        padding: 1rem;
    }

    .card-title {
        font-size: 1rem;
    }

    .card-text {
        font-size: 0.9rem;
    }

    .btn-outline-primary {
        font-size: 0.85rem;
        padding: 0.4rem 0.8rem;
    }
</style>
{% endblock %}

{% block scripts %}
<!-- Librería AOS para Animaciones -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
<script>
    AOS.init({
        duration: 800,
        easing: 'slide',
        once: true
    });
</script>
{% endblock %}

----- Fin de templates/create_item.html -----

----- Inicio de templates/create_producto.html -----
{% extends 'base.html' %}

{% block title %}Añadir Producto{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center">Añadir Producto a {{ caja.nombre }}</h2>
    <form method="POST">
        {{ form.hidden_tag() }}
        
        <div class="mb-3">
            {{ form.id_producto.label(class="form-label") }}
            {{ form.id_producto(class="form-control", placeholder="ID del Producto") }}
            {% for error in form.id_producto.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="form-control", placeholder="Nombre del Producto") }}
            {% for error in form.nombre.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            {{ form.categoria.label(class="form-label") }}
            {{ form.categoria(class="form-control", placeholder="Categoría del Producto") }}
            {% for error in form.categoria.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            {{ form.subcategoria.label(class="form-label") }}
            {{ form.subcategoria(class="form-control", placeholder="Subcategoría del Producto") }}
            {% for error in form.subcategoria.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            {{ form.cantidad.label(class="form-label") }}
            {{ form.cantidad(class="form-control", type="number", placeholder="Cantidad inicial del Producto") }}
            {% for error in form.cantidad.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        <div class="mb-3">
            {{ form.notas.label(class="form-label") }}
            {{ form.notas(class="form-control", placeholder="Notas del Producto (opcional)") }}
            {% for error in form.notas.errors %}
            <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        
        {{ form.submit(class="btn btn-success") }}
        <a href="{{ url_for('view_caja', uuid_caja=caja.uuid) }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}

----- Fin de templates/create_producto.html -----

----- Inicio de templates/create_tag.html -----
<!-- templates/create_tag.html -->

{% extends 'base.html' %}

{% block title %}Crear Etiqueta - PulztagWeb{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Crear Nueva Etiqueta</h2>
    <div class="row justify-content-center">
        <div class="col-md-6">
            <form method="POST" action="{{ url_for('create_tag') }}">
                {{ form.hidden_tag() }}
                <div class="mb-3">
                    {{ form.tag_name.label(class="form-label") }}
                    {{ form.tag_name(class="form-control", placeholder="Nombre de Tu Etiqueta") }}
                    {% for error in form.tag_name.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <div class="mb-3">
                    {{ form.redirect_url.label(class="form-label") }}
                    {{ form.redirect_url(class="form-control", placeholder="URL a redireccionar") }}
                    {% for error in form.redirect_url.errors %}
                        <div class="text-danger">{{ error }}</div>
                    {% endfor %}
                </div>
                <button type="submit" class="btn btn-success">Crear Etiqueta</button>
            </form>
        </div>
    </div>
</div>
{% endblock %}

----- Fin de templates/create_tag.html -----

----- Inicio de templates/edit_bodega.html -----
<!-- templates/edit_bodega.html -->

{% extends 'base.html' %}

{% block title %}Editar Bodega - PulztagWeb{% endblock %}

{% block content %}
<div class="container">
    <h2 class="text-center mb-4">Editar Bodega</h2>
    <form method="POST" action="{{ url_for('edit_bodega', uuid_bodega=bodega.uuid) }}">
        {{ form.hidden_tag() }}
        <div class="mb-3">
            {{ form.nombre.label(class="form-label") }}
            {{ form.nombre(class="form-control", placeholder="Nombre de la Bodega") }}
            {% for error in form.nombre.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.ubicacion.label(class="form-label") }}
            {{ form.ubicacion(class="form-control", placeholder="Ubicación") }}
            {% for error in form.ubicacion.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <div class="mb-3">
            {{ form.notas.label(class="form-label") }}
            {{ form.notas(class="form-control", placeholder="Notas") }}
            {% for error in form.notas.errors %}
                <div class="text-danger">{{ error }}</div>
            {% endfor %}
        </div>
        <button type="submit" class="btn btn-success">{{ form.submit.label.text }}</button>
        <a href="{{ url_for('profile') }}" class="btn btn-secondary">Cancelar</a>
    </form>
</div>
{% endblock %}

----- Fin de templates/edit_bodega.html -----

----- Inicio de templates/edit_caja.html -----
<!-- templates/edit_caja.html -->

{% extends "base.html" %}

{% block content %}
<h1>Editar Caja - {{ caja.nombre }}</h1>

<form method="post">
    {{ form.hidden_tag() }}
    <!-- Campo Nombre -->
    <div class="mb-3">
        {{ form.nombre.label(class="form-label") }}
        {{ form.nombre(class="form-control") }}
        {% if form.nombre.errors %}
          <div class="text-danger">
            {% for error in form.nombre.errors %}
              <span>{{ error }}</span>
            {% endfor %}
          </div>
        {% endif %}
    </div>
    <!-- Campo Categoría -->
    <div class="mb-3">
        {{ form.categoria.label(class="form-label") }}
        {{ form.categoria(class="form-control") }}
    </div>
    <!-- Campo Notas -->
    <div class="mb-3">
        {{ form.notas.label(class="form-label") }}
        {{ form.notas(class="form-control") }}
    </div>
    <!-- Botón de Envío -->
    {{ form.submit(class="btn btn-primary") }}
</form>

{% endblock %}

----- Fin de templates/edit_caja.html -----

----- Inicio de templates/edit_producto.html -----
<!-- templates/edit_producto.html -->

{% extends "base.html" %}

{% block content %}
<h1>Editar Producto - {{ producto.nombre }}</h1>

<form method="post">
    {{ form.hidden_tag() }}
    <div class="mb-3">
        {{ form.nombre.label(class="form-label") }}
        {{ form.nombre(class="form-control") }}
        {% if form.nombre.errors %}
          <div class="text-danger">
            {% for error in form.nombre.errors %}
              <span>{{ error }}</span>
            {% endfor %}
          </div>
        {% endif %}
    </div>
    <div class="mb-3">
        {{ form.descripcion.label(class="form-label") }}
        {{ form.descripcion(class="form-control") }}
    </div>
    <div class="mb-3">
        {{ form.cantidad.label(class="form-label") }}
        {{ form.cantidad(class="form-control") }}
    </div>
    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
    <a href="{{ url_for('product_detail', uuid_producto=producto.uuid) }}" class="btn btn-secondary">Cancelar</a>
</form>
{% endblock %}

----- Fin de templates/edit_producto.html -----

----- Inicio de templates/encuesta_evaluacion.html -----
{% extends "base.html" %}

{% block title %}
Encuesta NPS - Evaluación (Rectángulos)
{% endblock %}

{% block head %}
<style>
  /* Fondo y layout similar a qrcode_card.html */
  body {
      background-color: #f8f9fa;
      background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #333333;
      min-height: 100vh; 
      display: flex;
      flex-direction: column;
  }

  /* Contenedor principal (similar a la card) */
  .survey-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-width: 600px;
      width: 100%;
      margin: 40px auto; /* Centrar verticalmente con algo de margen */
      padding: 2rem;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .survey-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.3);
  }

  .survey-card h2 {
      font-size: 1.7rem;
      margin-bottom: 0.5rem;
      color: #333;
  }
  .survey-card p {
      color: #666;
      font-size: 1rem;
      margin-bottom: 2rem;
  }

  /* Barra de Rectángulos (1..10) */
  .rating-bar {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      flex-wrap: nowrap;
      margin-bottom: 1.5rem;
  }
  .rating-bar input[type="radio"] {
      display: none;
  }
  .rating-bar label {
      width: 35px;
      height: 50px;
      background: #f0f0f0;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.3s, transform 0.3s, box-shadow 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      color: #333;
  }

  /* Hover por rangos */
  .rating-bar label[data-rating="1"]:hover,
  .rating-bar label[data-rating="2"]:hover,
  .rating-bar label[data-rating="3"]:hover,
  .rating-bar label[data-rating="4"]:hover,
  .rating-bar label[data-rating="5"]:hover,
  .rating-bar label[data-rating="6"]:hover {
      background: #ff9999;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(255, 153, 153, 0.4);
  }
  .rating-bar label[data-rating="7"]:hover,
  .rating-bar label[data-rating="8"]:hover {
      background: #ffe167;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(255, 225, 103, 0.4);
  }
  .rating-bar label[data-rating="9"]:hover,
  .rating-bar label[data-rating="10"]:hover {
      background: #00b806;
      color: #fff;
      transform: translateY(-2px);
      box-shadow: 0 4px 10px rgba(0, 184, 6, 0.4);
  }

  /* Al seleccionar (checked) */
  /* 1..6 => rojo */
  .rating-bar input[value="1"]:checked + label,
  .rating-bar input[value="2"]:checked + label,
  .rating-bar input[value="3"]:checked + label,
  .rating-bar input[value="4"]:checked + label,
  .rating-bar input[value="5"]:checked + label,
  .rating-bar input[value="6"]:checked + label {
      background: #ff6666;
      color: #fff;
      box-shadow: 0 4px 14px rgba(255, 102, 102, 0.4);
  }
  /* 7..8 => amarillo */
  .rating-bar input[value="7"]:checked + label,
  .rating-bar input[value="8"]:checked + label {
      background: #ffc107;
      color: #fff;
      box-shadow: 0 4px 14px rgba(255, 193, 7, 0.4);
  }
  /* 9..10 => verde */
  .rating-bar input[value="9"]:checked + label,
  .rating-bar input[value="10"]:checked + label {
      background: #00b806;
      color: #fff;
      box-shadow: 0 4px 14px rgba(0, 184, 6, 0.4);
  }

  /* Sección de comentarios */
  .comment-container {
      text-align: left;
      margin-top: 1rem;
  }
  .comment-container label {
      display: block;
      margin-bottom: 0.5rem;
      color: #333;
      font-weight: 500;
  }
  .comment-textarea {
      width: 100%;
      min-height: 80px;
      border: 1px solid #ccc;
      border-radius: 4px;
      padding: 0.5rem;
      resize: vertical;
      font-family: inherit;
      font-size: 0.95rem;
  }

  .submit-button {
      margin-top: 1.5rem;
      width: 100%;
      background: #00b806;
      color: #fff;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      font-weight: 600;
      padding: 0.9rem;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
  }
  .submit-button:hover {
      background: #00a005;
      transform: scale(1.02);
  }
</style>
{% endblock %}

{% block content %}

<!-- Card principal -->
<div class="survey-card mt-4">
  <h2>¿Qué tan probable es que nos recomiendes?</h2>
  <p>Selecciona tu nivel de satisfacción en una escala de 1 a 10</p>

  <form action="{{ url_for('submit_survey', item_uuid=item_uuid) }}" method="post">
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

    <!-- Barra de Rectángulos 1..10 -->
    <div class="rating-bar">
      {% for num in range(1, 11) %}
        <input
          type="radio"
          id="rating-{{ num }}"
          name="evaluation"
          value="{{ num }}"
          required
        />
        <label data-rating="{{ num }}" for="rating-{{ num }}">{{ num }}</label>
      {% endfor %}
    </div>

    <div class="comment-container">
      <label for="comment"><i class="fas fa-comment-dots"></i> Comentarios (opcional):</label>
      <textarea name="comment" id="comment" class="comment-textarea" placeholder="Cuéntanos más sobre tu experiencia..."></textarea>
    </div>

    <button type="submit" class="submit-button">
      <i class="fas fa-paper-plane"></i> Enviar
    </button>
  </form>
</div>

{% endblock %}

----- Fin de templates/encuesta_evaluacion.html -----

----- Inicio de templates/encuesta_evaluacion_semaforo.html -----
<!-- templates/encuesta_evaluacion_moderno_fontawesome_con_logo.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Encuesta de Evaluación de Clientes</title>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* Reset de estilos por defecto */
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Roboto', sans-serif;
            background: linear-gradient(135deg, #e0eafc, #cfdef3);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        .survey-container {
            background: #ffffff;
            padding: 40px 30px;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 450px;
            animation: fadeIn 1s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Estilos del Logotipo */
        .logo-container {
            text-align: center;
            margin-bottom: 20px;
        }

        .logo-container img {
            max-width: 150px;
            width: 100%;
            height: auto;
        }

        .survey-container h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #333333;
            font-weight: 700;
            font-size: 24px;
        }

        .semaforo {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
        }

        .semaforo label {
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #f0f0f0;
            transition: transform 0.3s, box-shadow 0.3s, background 0.3s;
            position: relative;
        }

        .semaforo label:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .semaforo input[type="radio"] {
            display: none;
        }

        /* Estilos específicos para cada opción */
        .happy {
            /* Los colores se manejan a través de los estilos en línea del icono */
        }

        .neutral {
            /* Los colores se manejan a través de los estilos en línea del icono */
        }

        .sad {
            /* Los colores se manejan a través de los estilos en línea del icono */
        }

        .semaforo input[type="radio"]:checked + i {
            transform: scale(1.1);
            box-shadow: 0 0 0 4px rgba(0, 0, 0, 0.1);
        }

        .face {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            font-size: 32px;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .submit-button {
            width: 100%;
            padding: 14px;
            background: #4CAF50;
            border: none;
            border-radius: 30px;
            color: #ffffff;
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .submit-button:hover {
            background: #45a049;
            transform: translateY(-2px);
        }

        .submit-button:active {
            transform: translateY(0);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .comment-container {
            margin-top: 20px;
        }

        .comment-container label {
            display: block;
            margin-bottom: 8px;
            color: #333333;
            font-weight: 500;
        }

        .comment-textarea {
            width: 100%;
            height: 100px;
            padding: 12px;
            resize: vertical;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-family: inherit;
            font-size: 14px;
            transition: border 0.3s, box-shadow 0.3s;
        }

        .comment-textarea:focus {
            border: 1px solid #4CAF50;
            box-shadow: 0 0 5px rgba(76, 175, 80, 0.3);
            outline: none;
        }

        @media (max-width: 500px) {
            .semaforo label {
                width: 60px;
                height: 60px;
            }

            .face {
                font-size: 24px;
            }

            .submit-button {
                padding: 12px;
                font-size: 14px;
            }

            .survey-container {
                padding: 30px 20px;
            }

            .logo-container img {
                max-width: 120px;
                margin-bottom: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="survey-container">
        <!-- Contenedor del Logotipo -->
        <div class="logo-container">
            <img src="{{ url_for('static', filename='images/logochaintextblack.png') }}" alt="Logo de la Empresa">
        </div>

        <h2>Evaluación del Servicio</h2>
        <form action="{{ url_for('submit_survey', item_uuid=item_uuid) }}" method="post">
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

            <!-- Semáforo de caras con Font Awesome -->
            <div class="semaforo">
                <label>
                    <input type="radio" name="evaluation" value="happy" required>
                    <i class="fa-sharp-duotone fa-light fa-face-laugh-wink fa-beat-fade happy" style="--fa-primary-color: #00d700; --fa-secondary-color: #00f900; font-size: 40px;"></i>
                </label>
                <label>
                    <input type="radio" name="evaluation" value="neutral">
                    <i class="fa-sharp-duotone fa-regular fa-face-meh fa-beat-fade neutral" style="--fa-primary-color: #cec756; --fa-secondary-color: #fff800; font-size: 40px;"></i>
                </label>
                <label>
                    <input type="radio" name="evaluation" value="sad">
                    <i class="fa-sharp-duotone fa-regular fa-face-frown fa-beat-fade sad" style="--fa-primary-color: #e32400; --fa-secondary-color: #e32400; font-size: 40px;"></i>
                </label>
            </div>

            <!-- Campo de comentarios opcional -->
            <div class="comment-container">
                <label for="comment">Comentarios (opcional):</label>
                <textarea id="comment" name="comment" class="comment-textarea" placeholder="Comparte detalles de tu experiencia"></textarea>
            </div>

            <button type="submit" class="submit-button">Aceptar</button>
        </form>
    </div>

    <!-- Font Awesome JS (opcional, si necesitas funciones avanzadas de Font Awesome) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" integrity="sha512-pIv+e0xYz+3BPejG0FgGzP56m+YkTf3z9Z9P5cw0wRCiQw4Ek58YVGQl20C1N7GB1aLk9Z9/lpN3cYZQKbAsVA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
</body>
</html>


----- Fin de templates/encuesta_evaluacion_semaforo.html -----

----- Inicio de templates/footer.html -----
<!-- templates/footer.html -->

<!-- Footer -->
<footer class="bg-light text-center text-md-start py-4 mt-auto">
    <div class="container d-flex justify-content-between align-items-center">
        <div>&copy; 2024 Pulztag. Todos los derechos reservados.</div>
        <div>
            <a href="https://www.instagram.com/pulztag" target="_blank" class="text-dark me-3" aria-label="Instagram">
                <i class="fa-brands fa-instagram fa-fade fa-2x" style="color: #ed719e;"></i>
            </a>
            <a href="https://wa.me/56962411963" target="_blank" class="text-dark" aria-label="WhatsApp">
                <i class="fa-brands fa-whatsapp fa-shake fa-2x" style="color: #63E6BE"></i>
            </a>
        </div>
    </div>
</footer>

----- Fin de templates/footer.html -----

----- Inicio de templates/head.html -----
<!-- templates/head.html -->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}Pulztag{% endblock %}</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- CSS Personalizado con Parámetro de Versión para Evitar Caché -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=1.0">

{% block head %}{% endblock %}

----- Fin de templates/head.html -----

----- Inicio de templates/modal_agregar_item.html -----
<!-- modal_agregar_item.html -->
<div class="modal fade" id="agregarItemModal" tabindex="-1" aria-labelledby="agregarItemModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <form id="agregarItemForm">
                <div class="modal-header">
                    <h5 class="modal-title" id="agregarItemModalLabel">Agregar Nuevo Item</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="itemNameInput" class="form-label">Nombre de Item</label>
                        <input type="text" class="form-control" id="itemNameInput" placeholder="Ingrese el nombre del Item">
                    </div>
                    <div class="mb-3">
                        <label for="itemTypeSelect" class="form-label">Tipo de Item</label>
                        <select class="form-select" id="itemTypeSelect">
                            <option value="" disabled selected>Selecciona una opción</option>
                            <option value="Evaluación de Clientes">Evaluación de Clientes</option>
                            <option value="Visualizaciones diarias">Visualizaciones diarias</option>
                        </select>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="submit" class="btn btn-success">Aceptar</button>
                </div>
            </form>
        </div>
    </div>
</div>

----- Fin de templates/modal_agregar_item.html -----

----- Inicio de templates/navbar.html -----
<!-- templates/navbar.html -->

<!-- Logo de la Navbar alineado a la izquierda -->
<a class="navbar-brand text-primary fw-bold d-flex align-items-center" href="/">
    <img src="{{ url_for('static', filename='images/logochaintextblack.png') }}" alt="Pulztag Logo" height="40" class="me-2">
</a>

<!-- Botón de navegación móvil -->
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<!-- Enlaces de Navegación centrados -->
<div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav mx-auto">
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/' %} active{% endif %}" href="/">Inicio</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/products' %} active{% endif %}" href="{{ url_for('products') }}">Productos</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/services' %} active{% endif %}" href="{{ url_for('services') }}">Servicios</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path.startswith('/create_item') %} active{% endif %}" href="{{ url_for('create_item') }}">Crear Item</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/order' %} active{% endif %}" href="/order">Pedido</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/about' %} active{% endif %}" href="/about">Acerca de</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/contact' %} active{% endif %}" href="/contact">Contacto</a>
        </li>
    </ul>
    
    <!-- Menú desplegable alineado a la derecha -->
    <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
            {% if current_user.is_authenticated %}
            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                {{ current_user.username }}
                <i class="bi bi-person-circle ms-1"></i> <!-- Icono de usuario -->
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" href="{{ url_for('profile') }}">Perfil</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="{{ url_for('main.logout') }}">Cerrar Sesión</a></li>
            </ul>
            {% else %}
            <a class="nav-link dropdown-toggle" href="#" id="authDropdown" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Mi Cuenta
                <i class="bi bi-lock-fill ms-1"></i> <!-- Icono de cuenta -->
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="authDropdown">
                <li><a class="dropdown-item" href="{{ url_for('main.login') }}">Iniciar Sesión</a></li>
                <li><a class="dropdown-item" href="{{ url_for('main.register') }}">Crear Cuenta</a></li>
            </ul>
            {% endif %}
        </li>
    </ul>
</div>


----- Fin de templates/navbar.html -----

----- Inicio de templates/product_detail.html -----
<!-- templates/product_detail.html -->

{% extends "base.html" %}

{% block content %}
<h1>Detalles del Producto: {{ producto.nombre }}</h1>

<div class="card mb-3">
    <div class="card-header">
        <h2>{{ producto.nombre }}</h2>
    </div>
    <div class="card-body">
        <p><strong>ID Producto:</strong> {{ producto.id_producto }}</p>
        <p><strong>Categoría:</strong> {{ producto.categoria }}</p>
        <p><strong>Subcategoría:</strong> {{ producto.subcategoria }}</p>
        <p><strong>Descripción:</strong> {{ producto.descripcion }}</p>
        <p><strong>Cantidad:</strong> {{ producto.cantidad }}</p>
        <p><strong>Fecha de Creación:</strong> {{ producto.fecha_creacion.strftime('%d/%m/%Y') }}</p>
        <p><strong>Notas:</strong> {{ producto.notas }}</p>
        <p><strong>Caja:</strong> <a href="{{ url_for('view_caja', uuid_caja=producto.caja.uuid) }}">{{ producto.caja.nombre }}</a></p>
    </div>
</div>

<div class="mb-3">
    <!-- Botón Código QR -->
    <a href="{{ url_for('producto_qrcode', uuid_producto=producto.uuid) }}" class="btn btn-outline-secondary" title="Ver Código QR">
        <i class="fas fa-qrcode"></i> Código QR
    </a>
    <!-- Botón Editar -->
    <a href="{{ url_for('edit_producto', uuid_producto=producto.uuid) }}" class="btn btn-warning">Editar</a>
    <!-- Botón Eliminar -->
    <form method="POST" action="{{ url_for('delete_producto', uuid_producto=producto.uuid) }}" style="display: inline;">
        {{ delete_producto_form.hidden_tag() }}
        <button type="submit" class="btn btn-danger" onclick="return confirm('¿Seguro que deseas eliminar este producto?');">
            Eliminar
        </button>
    </form>
</div>

<a href="{{ url_for('view_caja', uuid_caja=producto.caja.uuid) }}" class="btn btn-secondary">Regresar a la Caja</a>
{% endblock %}

----- Fin de templates/product_detail.html -----

----- Inicio de templates/product_list.html -----
{% extends "base.html" %}

{% block content %}
<h1>Productos en la Caja: {{ caja.nombre }}</h1>

<a href="{{ url_for('create_producto', uuid_caja=caja.uuid) }}" class="btn btn-primary mb-3">Agregar Producto</a>

<table class="table table-striped">
    <thead>
        <tr>
            <th>ID Producto</th>
            <th>Nombre</th>
            <th>Descripción</th>
            <th>Cantidad</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for producto in productos %}
        <tr>
            <td>{{ producto.id_producto }}</td>
            <td>{{ producto.nombre }}</td>
            <td>{{ producto.descripcion }}</td>
            <td>{{ producto.cantidad }}</td>
            <td>
                <a href="{{ url_for('product_detail', uuid_producto=producto.uuid) }}" class="btn btn-sm btn-info">Detalles</a>
                <a href="{{ url_for('edit_producto', uuid_producto=producto.uuid) }}" class="btn btn-sm btn-warning">Editar</a>
                <form method="POST" action="{{ url_for('delete_producto', uuid_producto=producto.uuid) }}" style="display: inline;">
                    <button type="submit" class="btn btn-sm btn-danger" onclick="return confirm('¿Seguro que deseas eliminar este producto?');">Eliminar</button>
                </form>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{{ url_for('caja_detail', uuid_caja=caja.uuid) }}" class="btn btn-secondary

----- Fin de templates/product_list.html -----

----- Inicio de templates/productsnew.html -----
<!-- templates/products.html -->

{% extends 'base.html' %}

{% block title %}Nuestros Productos - PulztagWeb{% endblock %}

{% block content %}
    <div class="container my-5">
        <h2 class="text-center mb-4">Nuestros Productos</h2>
        <p class="text-center mb-5">Con nuestras Etiquetas NFC, actualiza la información de tus campañas sin necesidad de reimprimir materiales, ahorrando tiempo y recursos.</p>

        <!-- Grid de Productos -->
        <div class="row gy-5">
            <!-- Producto 1: Soporte de Menú con Código QR y NFC de Acrílico Plástico Personalizado 13.56MHz Resistente al Agua -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='soporte-menu-nfc') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/soporte_menu_nfc.png') }}" class="card-img-top" alt="Soporte de Menú con Código QR y NFC" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Soporte de Menú NFC</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 2: Etiqueta de Pegatina de Redes Sociales NFC Epoxy Antimetal Personalizada 13.56MHz -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='etiqueta-pegatina-nfc') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/etiqueta_pegatina_nfc.png') }}" class="card-img-top" alt="Etiqueta de Pegatina de Redes Sociales NFC" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Etiqueta Pegatina NFC</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 3: Tarjeta Redonda de PVC Duro Personalizada Impresa al por Mayor con Etiquetas NFC NTAG215 -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='tarjeta-redonda-pvc') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/tarjeta_redonda_pvc.png') }}" class="card-img-top" alt="Tarjeta Redonda de PVC Duro Personalizada" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Tarjeta Redonda PVC</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 4: Fabricante de Tarjetas PVC Inteligentes NFC Pasivas Personalizables Imprimibles 13.56MHz NTAG213 -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='tarjetas-pvc-inteligentes') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/tarjetas_pvc_inteligentes.png') }}" class="card-img-top" alt="Tarjetas PVC Inteligentes NFC" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Tarjetas PVC Inteligentes</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 5: Fábrica de Pulseras Tejidas RFID Descartables Personalizables Imprimibles 13.56MHz -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='pulseras-tejidas-rfid') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/pulseras_tejidas_rfid.png') }}" class="card-img-top" alt="Pulseras Tejidas RFID Descartables" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Pulseras Tejidas RFID</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 6: Etiqueta NFC de Redes Sociales NTAG213 Epoxy Resistente al Agua Antimetal Personalizable Imprimible 13.56MHz -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='etiqueta-nfc-redes-sociales') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/etiqueta_nfc_redes_sociales.png') }}" class="card-img-top" alt="Etiqueta NFC de Redes Sociales" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Etiqueta NFC Redes Sociales</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 7: Fabricante de Tarjetas de Madera NFC Empresariales Personalizadas Impresas 13.56MHz NTAG213 NTAG215 NTAG216 -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='tarjetas-madera-nfc') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/tarjetas_madera_nfc.png') }}" class="card-img-top" alt="Tarjetas de Madera NFC Empresariales" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Tarjetas de Madera NFC</h5>
                        </div>
                    </a>
                </div>
            </div>

            <!-- Producto 8: Tarjeta PVC NTAG216 Reescribible Blanca de Inyección Térmica Personalizable Imprimible NFC 13.56MHz -->
            <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
                <div class="card h-100 service-background" style="max-width: 100%; margin: auto;">
                    <a href="{{ url_for('product_template', product_slug='tarjeta-pvc-ntag216') }}" class="text-decoration-none text-dark">
                        <img src="{{ url_for('static', filename='images/tarjeta_pvc_ntag216.png') }}" class="card-img-top" alt="Tarjeta PVC NTAG216 Reescribible" style="object-fit: cover; height: 200px;">
                        <div class="card-body">
                            <h5 class="card-title text-primary">Tarjeta PVC NTAG216</h5>
                        </div>
                    </a>
                </div>
            </div>
        </div>
    </div>
{% endblock %}


----- Fin de templates/productsnew.html -----

----- Inicio de templates/pulzcard/template1.html -----
<!-- templates/pulzcard/template1.html -->

{% extends 'base.html' %}

{% block title %}Tu Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<style>
    /* Fondo personalizado solo para esta página */
    body {
        background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #333333;
    }

    /* Fondo y estilo para el encabezado "Tu Pulzcard" */
    .card-header {
        background: linear-gradient(135deg, #01b9f6 0%, #02a4da 100%);
    }

    .card-header h3 {
        color: #ffffff;
        font-family: 'Myriad Pro', sans-serif;
        font-size: 1.7rem;
        font-weight: 700;
    }

    /* Estilo de fuente independiente para el nombre completo */
    .card-title {
        font-family: 'Myriad Pro', sans-serif;
        font-size: 2.2rem;
        font-weight: 700;
        color: #03c0ff;
    }

    /* Estilo independiente para posición y organización */
    .card-subtitle {
        font-family: 'Myriad Pro', sans-serif;
        font-size: 1.2rem;
        font-weight: 500;
        color: #9f9f9f;
        margin-top: 0.5rem;
    }

    /* Imagen de perfil con sombra y ajuste de tamaño */
    .profile-image {
        width: 200px;
        height: 200px;
        border: 0px solid #ffffff;
        object-fit: cover;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .profile-image:hover {
        transform: scale(1.1);
        box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
    }

    /* Separador personalizado */
    hr {
        border-top: 2px solid #03c0ff;
        opacity: 0.8;
        width: 80%;
        margin: 1.5rem auto;
    }
</style>

<!-- Espaciado Superior -->
<div style="margin: 0px;"></div>

<div class="container mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <div class="card shadow-lg border-0 rounded-lg">
                <!-- Encabezado con logo y botones -->
                <div class="card-header text-white d-flex justify-content-between align-items-center p-3">
                    <!-- Logo a la izquierda -->
                    <div>
                        <img src="{{ url_for('static', filename='images/logochainwhite.png') }}" alt="Pulztag Logo" height="30">
                    </div>                    
                    <!-- Botones a la derecha -->
                    <div class="d-flex gap-2">
                        <a href="{{ url_for('pulzcard_download_vcard', filename=card_id + '.vcf') }}" download="Pulzcard_{{ contact.full_name.replace(' ', '_') }}.vcf" class="btn btn-custom-white btn-icon" title="Descargar vCard">
                            <i class="fa-solid fa-circle-down" style="font-size: 1.0em;"></i>
                        </a>
                        <!-- Botón para copiar URL -->
                        <button class="btn btn-custom-white btn-icon" onclick="copyURL()" title="Copiar URL">
                            <i class="fa-solid fa-clone" style="font-size: 1.0em;"></i>
                        </button>
                        {% if current_user.is_authenticated %}
                        <!-- Botón Volver -->
                        <a href="{{ url_for('profile') }}" class="btn btn-custom-white btn-icon" title="Volver al Perfil">
                            <i class="fa-solid fa-angles-left" style="font-size: 1.0em;"></i>
                        </a>
                        {% endif %}
                        <input type="hidden" id="cardURL" value="{{ request.url }}">
                    </div>
                </div>
                <div style="margin: 10px;"></div>
                <div class="card-body text-center p-2">
                    <!-- Imagen de Perfil -->
                    <div class="mb-4">
                        <img src="{{ url_for('uploaded_file', filename=contact['image_file']) }}" alt="Imagen de Perfil" class="rounded-circle profile-image shadow-lg">
                    </div>

                    <h1 class="card-title font-weight-bold mb-3">{{ contact.full_name }}</h1>
                    <p class="card-subtitle">{{ contact.position }}, {{ contact.organization }}</p>
                    
                    <!-- Separador -->
                    <hr class="my-3">
                    
                    <!-- Información de Contacto -->
                    <div class="mt-4">
                        <p class="card-text">
                            <strong>Teléfono:</strong>
                            <a href="tel:{{ contact.phone }}" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-mobile-screen-button"></i>{{ contact.phone }}
                            </a>
                        </p>
                        <p class="card-text">
                            <strong>Email:</strong>
                            <a href="mailto:{{ contact.email }}" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-envelope"></i>{{ contact.email }}
                            </a>
                        </p>
                        <p class="card-text">
                            <strong>Página Web:</strong>
                            <a href="{{ contact.website }}" target="_blank" class="text-primary text-decoration-none">
                                <i class="fa-solid fa-globe"></i>{{ contact.website }}
                            </a>
                        </p>
                        <p class="card-text">
                            <i class="fa-solid fa-map-location"></i>
                            <strong>Dirección:</strong> {{ contact.address }}
                        </p>
                    </div>
                    
                    <!-- Instrucciones para Agregar Contacto -->
                    <div class="mt-4">
                        <h5 class="form-subtitle mb-3">Instrucciones:</h5>
                        <ul class="list-unstyled text-muted">
                            <li><i class="fa-brands fa-android"></i><strong>Android:</strong> Descarga y abre con la app de contactos.</li>
                            <li><i class="fa-brands fa-apple"></i><strong>iOS:</strong> Descarga y selecciona "Agregar a contactos".</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para copiar URL al portapapeles -->
<script>
    function copyURL() {
        const url = document.getElementById('cardURL').value;
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }
</script>
{% endblock %}

----- Fin de templates/pulzcard/template1.html -----

----- Inicio de templates/pulzcard/template2.html -----
<!-- templates/pulzcard/template2.html -->

{% extends 'base.html' %}

{% block title %}Tu Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<style>
    /* Fondo personalizado solo para esta página */
    body {
        background-image: url('{{ url_for("static", filename="images/dark_fondo.jpg") }}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #e0e0e0; /* Texto claro para contraste */
        font-family: 'Roboto', sans-serif;
    }

    /* Estilo para la tarjeta */
    .pulzcard-template {
        background-color: #1a1a1a; /* Fondo negro para la tarjeta */
        border-radius: 15px;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.7);
        max-width: 900px;
        margin: 60px auto;
        overflow: hidden;
        display: flex;
        flex-direction: column; /* Cambiado a columna para mejor responsividad */
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .pulzcard-template:hover {
        transform: translateY(-10px);
        box-shadow: 0 16px 64px rgba(0, 0, 0, 0.9);
    }

    /* Encabezado de la tarjeta */
    .card-header {
        background: linear-gradient(135deg, #333333 0%, #555555 100%); /* Gradiente oscuro elegante */
        color: #ffffff;
        padding: 20px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #444444;
    }

    .card-header h3 {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
    }

    /* Estilos para los botones de acción */
    .action-buttons {
        display: flex; /* Alineación horizontal */
        gap: 12px; /* Espacio entre botones */
    }

    .action-buttons a,
    .action-buttons button {
        background-color: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease;
        color: #ffffff;
    }

    .action-buttons a:hover,
    .action-buttons button:hover {
        background-color: #ffffff;
        color: #ff416c; /* Color de acento */
    }

    /* Título y subtítulo */
    .card-title {
        font-family: 'Montserrat', sans-serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: #ffffff;
        margin: 20px 0 10px 0;
        text-align: center;
    }

    .card-subtitle {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.3rem;
        font-weight: 500;
        color: #b0b0b0;
        margin-bottom: 25px;
        text-align: center;
    }

    /* Imagen de perfil con borde circular y sombra */
    .profile-image {
        width: 220px;
        height: 220px;
        border: 5px solid #ffffff;
        border-radius: 50%;
        object-fit: cover;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        margin: 0 auto;
    }

    .profile-image:hover {
        transform: scale(1.05);
        box-shadow: 0 16px 32px rgba(0, 0, 0, 0.7);
    }

    /* Separador personalizado */
    hr {
        border-top: 2px solid #ffffff;
        opacity: 0.9;
        width: 85%;
        margin: 1.5rem auto;
    }

    /* Estilos para la información de contacto */
    .contact-info p {
        font-size: 1.1rem;
        margin: 12px 0;
        display: flex;
        align-items: center;
        color: #e0e0e0;
        justify-content: center;
    }

    .contact-info i {
        margin-right: 12px;
        color: #419dff;
        min-width: 25px;
        text-align: center;
    }

    .contact-info a {
        color: #419dff;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .contact-info a:hover {
        color: #ffffff;
        text-decoration: underline;
    }

    /* Instrucciones */
    .instructions {
        margin-top: 30px;
        text-align: center;
    }

    .instructions h5 {
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: #ffffff;
        font-weight: 600;
    }

    .instructions ul {
        list-style: none;
        padding: 0;
    }

    .instructions li {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 12px;
        font-size: 1.1rem;
        color: #b0b0b0;
    }

    .instructions li i {
        margin-right: 10px;
        color: #419dff;
        min-width: 30px;
        text-align: center;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .pulzcard-template {
            flex-direction: column;
        }

        .card-header {
            flex-direction: column;
            align-items: flex-start;
        }

        .action-buttons {
            margin-top: 10px;
        }

        .profile-image {
            width: 180px;
            height: 180px;
        }

        .card-title {
            font-size: 2.2rem;
        }

        .card-subtitle {
            font-size: 1.1rem;
        }

        .contact-info p {
            flex-direction: column;
            text-align: center;
        }

        .instructions li {
            flex-direction: column;
            text-align: center;
        }
    }
</style>

<!-- Espaciado Superior -->
<div style="margin: 60px;"></div>

<div class="container mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="pulzcard-template">
                <!-- Encabezado con logo y botones -->
                <div class="card-header">
                    <!-- Logo a la izquierda -->
                    <div>
                        <img src="{{ url_for('static', filename='images/logochainwhite.png') }}" alt="Pulztag Logo" height="45">
                    </div>
                    <!-- Botones a la derecha -->
                    <div class="action-buttons">
                        <a href="{{ url_for('pulzcard_download_vcard', filename=card_id + '.vcf') }}" download="Pulzcard_{{ contact.full_name.replace(' ', '_') }}.vcf" title="Descargar vCard">
                            <i class="fa-solid fa-circle-down" style="font-size: 1.0em;"></i>
                        </a>
                        <!-- Botón para copiar URL -->
                        <button onclick="copyURL()" title="Copiar URL">
                            <i class="fa-solid fa-clone" style="font-size: 1.0em;"></i>
                        </button>
                        {% if current_user.is_authenticated %}
                        <!-- Botón Volver -->
                        <a href="{{ url_for('profile') }}" class="btn btn-custom-white btn-icon" title="Volver al Perfil">
                            <i class="fa-solid fa-angles-left" style="font-size: 1.0em;"></i>
                        </a>
                        {% endif %}
                        <input type="hidden" id="cardURL" value="{{ request.url }}">
                    </div>
                </div>
                <div style="margin: 10px;"></div>
                <div class="card-body text-center p-4">
                    <!-- Imagen de Perfil -->
                    <div class="mb-4">
                        <img src="{{ url_for('uploaded_file', filename=contact.image_file) }}" alt="Imagen de Perfil" class="rounded-circle profile-image shadow-lg">
                    </div>

                    <h1 class="card-title font-weight-bold mb-3">{{ contact.full_name }}</h1>
                    <p class="card-subtitle">{{ contact.position }}, {{ contact.organization }}</p>
                    
                    <!-- Separador -->
                    <hr class="my-3">
                    
                    <!-- Información de Contacto -->
                    <div class="mt-4 contact-info">
                        <p>
                            <i class="fa-solid fa-mobile-screen-button"></i>
                            <strong>Teléfono:</strong>
                            <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-envelope"></i>
                            <strong>Email:</strong>
                            <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-globe"></i>
                            <strong>Página Web:</strong>
                            <a href="{{ contact.website }}" target="_blank">{{ contact.website }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-map-location"></i>
                            <strong>Dirección:</strong> {{ contact.address }}
                        </p>
                    </div>
                    
                    <!-- Instrucciones para Agregar Contacto -->
                    <div class="mt-4 instructions">
                        <h5>Instrucciones:</h5>
                        <ul>
                            <li><i class="fa-brands fa-android"></i><strong>Android:</strong> Descarga y abre con la app de contactos.</li>
                            <li><i class="fa-brands fa-apple"></i><strong>iOS:</strong> Descarga y selecciona "Agregar a contactos".</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para copiar URL al portapapeles -->
<script>
    function copyURL() {
        const url = document.getElementById('cardURL').value;
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }
</script>
{% endblock %}

----- Fin de templates/pulzcard/template2.html -----

----- Inicio de templates/pulzcard/template3.html -----
<!-- templates/pulzcard/template3.html -->

{% extends 'base.html' %}

{% block title %}Tu Pulzcard - PulztagWeb{% endblock %}

{% block content %}
<style>
    /* Fondo personalizado solo para esta página */
    body {
        background-image: url('{{ url_for("static", filename="images/green_fondo.jpg") }}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #00BCD4; /* Texto claro para contraste */
        font-family: 'Roboto', sans-serif;
    }

    /* Estilo para la tarjeta */
    .pulzcard-template {
        background-color: #424242; /* Fondo para la tarjeta */
        border-radius: 15px;
        box-shadow: 0 8px 32px rgba(2, 98, 157, 0.7);
        max-width: 900px;
        margin: 60px auto;
        overflow: hidden;
        display: flex;
        flex-direction: column; /* Cambiado a columna para mejor responsividad */
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .pulzcard-template:hover {
        transform: translateY(-10px);
        box-shadow: 0 16px 64px rgba(0, 0, 0, 0.9);
    }

    /* Encabezado de la tarjeta */
    .card-header {
        background: linear-gradient(135deg, #333333 0%, #555555 100%); /* Gradiente oscuro elegante */
        color: #00FF00;
        padding: 20px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 1px solid #444444;
    }

    .card-header h3 {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.8rem;
        font-weight: 700;
    }

    /* Estilos para los botones de acción */
    .action-buttons {
        display: flex; /* Alineación horizontal */
        gap: 12px; /* Espacio entre botones */
    }

    .action-buttons a,
    .action-buttons button {
        background-color: rgba(255, 255, 255, 0.2);
        border: none;
        border-radius: 50%;
        width: 45px;
        height: 45px;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        transition: background-color 0.3s ease, color 0.3s ease;
        color: #00FF00;
    }

    .action-buttons a:hover,
    .action-buttons button:hover {
        background-color: #00FF00;
        color: #00FF00; /* Color de acento */
    }

    /* Título y subtítulo */
    .card-title {
        font-family: 'Montserrat', sans-serif;
        font-size: 2.5rem;
        font-weight: 700;
        color: #00FF00;
        margin: 20px 0 10px 0;
        text-align: center;
    }

    .card-subtitle {
        font-family: 'Montserrat', sans-serif;
        font-size: 1.3rem;
        font-weight: 500;
        color: #b0b0b0;
        margin-bottom: 25px;
        text-align: center;
    }

    /* Imagen de perfil con borde circular y sombra */
    .profile-image {
        width: 220px;
        height: 220px;
        border: 5px solid #080808;
        border-radius: 50%;
        object-fit: cover;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
        margin: 0 auto;
    }

    .profile-image:hover {
        transform: scale(1.05);
        box-shadow: 0 16px 32px rgba(0, 0, 0, 0.7);
    }

    /* Separador personalizado */
    hr {
        border-top: 2px solid #ffffff;
        opacity: 0.9;
        width: 85%;
        margin: 1.5rem auto;
    }

    /* Estilos para la información de contacto */
    .contact-info p {
        font-size: 1.1rem;
        margin: 12px 0;
        display: flex;
        align-items: center;
        color: #00FF00;
        justify-content: center;
    }

    .contact-info i {
        margin-right: 12px;
        color: #b0b0b0;
        min-width: 25px;
        text-align: center;
    }

    .contact-info a {
        color: #b0b0b0;
        text-decoration: none;
        transition: color 0.3s ease;
    }

    .contact-info a:hover {
        color: #ffffff;
        text-decoration: underline;
    }

    /* Instrucciones */
    .instructions {
        margin-top: 30px;
        text-align: center;
    }

    .instructions h5 {
        font-size: 1.5rem;
        margin-bottom: 15px;
        color: #ffffff;
        font-weight: 600;
    }

    .instructions ul {
        list-style: none;
        padding: 0;
    }

    .instructions li {
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 12px;
        font-size: 1.1rem;
        color: #b0b0b0;
    }

    .instructions li i {
        margin-right: 10px;
        color: #b0b0b0;
        min-width: 30px;
        text-align: center;
    }

    /* Responsive Design */
    @media (max-width: 768px) {
        .pulzcard-template {
            flex-direction: column;
        }

        .card-header {
            flex-direction: column;
            align-items: flex-start;
        }

        .action-buttons {
            margin-top: 10px;
        }

        .profile-image {
            width: 180px;
            height: 180px;
        }

        .card-title {
            font-size: 2.2rem;
        }

        .card-subtitle {
            font-size: 1.1rem;
        }

        .contact-info p {
            flex-direction: column;
            text-align: center;
        }

        .instructions li {
            flex-direction: column;
            text-align: center;
        }
    }
</style>

<!-- Espaciado Superior -->
<div style="margin: 60px;"></div>

<div class="container mb-5">
    <div class="row justify-content-center">
        <div class="col-lg-8 col-md-10">
            <div class="pulzcard-template">
                <!-- Encabezado con logo y botones -->
                <div class="card-header">
                    <!-- Logo a la izquierda -->
                    <div>
                        <img src="{{ url_for('static', filename='images/logochainwhite.png') }}" alt="Pulztag Logo" height="45">
                    </div>
                    <!-- Botones a la derecha -->
                    <div class="action-buttons">
                        <a href="{{ url_for('pulzcard_download_vcard', filename=card_id + '.vcf') }}" download="Pulzcard_{{ contact.full_name.replace(' ', '_') }}.vcf" title="Descargar vCard">
                            <i class="fa-solid fa-circle-down" style="font-size: 1.0em;"></i>
                        </a>
                        <!-- Botón para copiar URL -->
                        <button onclick="copyURL()" title="Copiar URL">
                            <i class="fa-solid fa-clone style="font-size: 1.0em;"></i>
                        </button>
                        {% if current_user.is_authenticated %}
                        <!-- Botón Volver -->
                        <a href="{{ url_for('profile') }}" class="btn btn-custom-white btn-icon" title="Volver al Perfil">
                            <i class="fa-solid fa-angles-left" style="font-size: 1.0em;"></i>
                        </a>
                        {% endif %}
                        <input type="hidden" id="cardURL" value="{{ request.url }}">
                    </div>
                </div>
                <div style="margin: 10px;"></div>
                <div class="card-body text-center p-4">
                    <!-- Imagen de Perfil -->
                    <div class="mb-4">
                        <img src="{{ url_for('uploaded_file', filename=contact.image_file) }}" alt="Imagen de Perfil" class="rounded-circle profile-image shadow-lg">
                    </div>

                    <h1 class="card-title font-weight-bold mb-3">{{ contact.full_name }}</h1>
                    <p class="card-subtitle">{{ contact.position }}, {{ contact.organization }}</p>
                    
                    <!-- Separador -->
                    <hr class="my-3">
                    
                    <!-- Información de Contacto -->
                    <div class="mt-4 contact-info">
                        <p>
                            <i class="fa-solid fa-mobile-screen-button"></i
                            <strong>Teléfono:</strong>
                            <a href="tel:{{ contact.phone }}">{{ contact.phone }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-envelope"></i>
                            <strong>Email:</strong>
                            <a href="mailto:{{ contact.email }}">{{ contact.email }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-globe"></i>>
                            <strong>Página Web:</strong>
                            <a href="{{ contact.website }}" target="_blank">{{ contact.website }}</a>
                        </p>
                        <p>
                            <i class="fa-solid fa-map-location"></i>>
                            <strong>Dirección:</strong> {{ contact.address }}
                        </p>
                    </div>
                    
                    <!-- Instrucciones para Agregar Contacto -->
                    <div class="mt-4 instructions">
                        <h5>Instrucciones:</h5>
                        <ul>
                            <li><i class="fa-brands fa-android"></i><strong>Android:</strong> Descarga y abre con la app de contactos.</li>
                            <li><i class="fa-brands fa-apple"></i><strong>iOS:</strong> Descarga y selecciona "Agregar a contactos".</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para copiar URL al portapapeles -->
<script>
    function copyURL() {
        const url = document.getElementById('cardURL').value;
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }
</script>
{% endblock %}

----- Fin de templates/pulzcard/template3.html -----

----- Inicio de templates/qrcode_card.html -----
<!-- templates/qrcode_card.html -->

{% extends 'base.html' %}

{% block title %}Código QR - PulztagWeb{% endblock %}

{% block content %}
<style>
    /* Fondo personalizado igual al de la barra principal */
    body {
        background-color: #f8f9fa;
        background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
        color: #333333;
        min-height: 100vh;
        display: flex;
        flex-direction: column;
    }

    /* Estilos para la tarjeta del código QR */
    .qrcode-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 0;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        max-width: 450px;
        width: 100%;
        text-align: center;
        margin: auto;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .qrcode-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 16px 32px rgba(0, 0, 0, 0.3);
    }

    /* Estilo para el encabezado */
    .card-header {
        background: linear-gradient(135deg, #01b9f6 0%, #02a4da 100%);
        color: #ffffff;
    }

    .card-header h3 {
        margin: 0;
        font-weight: 700;
        font-size: 1.7rem;
    }

    /* Imagen del QR */
    .qrcode-image {
        margin: 20px 0;
    }

    /* Botones de acción */
    .action-buttons {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin-top: 20px;
    }

    .action-buttons a {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 50px;
        height: 50px;
        border: 2px solid #6a11cb;
        border-radius: 50%;
        color: #6a11cb;
        text-decoration: none;
        transition: background-color 0.3s ease, color 0.3s ease;
    }

    .action-buttons a:hover {
        background-color: #6a11cb;
        color: #ffffff;
    }

    /* Botón para regresar al perfil */
    .btn-back {
        margin-top: 30px;
    }

    /* Ajuste del footer */
    .footer {
        margin-top: auto;
    }

    /* Estilos para dispositivos móviles */
    @media (max-width: 576px) {
        .qrcode-card {
            padding: 0;
            max-width: 90%;
        }

        .action-buttons a {
            width: 40px;
            height: 40px;
        }
    }
</style>
    


<div class="container my-5">
    <div class="row justify-content-center">
        <div class="col-lg-6 col-md-8">
            <div class="card qrcode-card shadow-lg border-0 rounded-lg">
                <!-- Encabezado con logo y botones -->
                <div class="card-header text-white d-flex justify-content-between align-items-center p-3">
                    <!-- Logo a la izquierda -->
                    <div>
                        <img src="{{ url_for('static', filename='images/logocardv2.png') }}" alt="Pulztag Logo" height="30">
                    </div>
                <!-- Botones a la derecha -->
                <div class="d-flex gap-2">
                    <a href="{{ qr_url }}" download="{{ entity_type|lower }}_{{ tag_id }}.png" class="btn btn-custom-white btn-icon" title="Descargar QR">
                        <i class="fas fa-download" style="font-size: 1.0em;"></i>
                    </a>
                    <!-- Botón para copiar URL -->
                    <button class="btn btn-custom-white btn-icon" onclick="copyURL()" title="Copiar URL">
                        <i class="fas fa-copy" style="font-size: 1.0em;"></i>
                    </button>
                    {% if current_user.is_authenticated %}
                    <!-- Botón Volver -->
                    <a href="{{ url_for('profile') }}" class="btn btn-custom-white btn-icon" title="Volver al Perfil">
                        <i class="fas fa-chevron-right" style="font-size: 1.0em;"></i>
                    </a>
                    {% endif %}
                    <input type="hidden" id="pageURL" value="{{ share_url }}">
                </div>
                </div>
                <!-- Contenido del código QR -->
                <div class="card-body text-center">
                    <!-- Título -->
                    <h3 class="mt-3 mb-4">Código QR de {{ entity_type }}</h3>
                    <!-- Imagen del QR -->
                    <div class="qrcode-image">
                        <img id="qrImage" src="{{ qr_url }}" alt="Código QR" class="img-fluid rounded shadow-lg">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Script para manejar la carga del QR -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const qrImage = document.getElementById('qrImage');

        qrImage.onload = function () {
            qrImage.classList.add('loaded');
        };

        qrImage.onerror = function () {
            if (qrLoader) {
                qrLoader.style.display = 'none';
            }
            alert('Error al cargar el código QR. Por favor, intenta de nuevo.');
        };
    });
</script>
<!-- Script para copiar URL al portapapeles -->
<script>
    function copyURL() {
        const url = document.getElementById('pageURL').value;
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }
</script>
{% endblock %}

----- Fin de templates/qrcode_card.html -----

----- Inicio de templates/services.html -----
<!-- templates/services.html -->

{% extends 'base.html' %}

{% block title %}Nuestros Servicios - PulztagWeb{% endblock %}

{% block content %}
<div class="container my-5">

    <!-- Sección de Encabezado -->
    <div class="text-center mb-5">
        <h2 class="titulo-seccion">Nuestros Servicios</h2>
        <p class="lead">Descubre cómo nuestra Plataforma CEM puede transformar la experiencia de tus clientes a través de soluciones innovadoras y personalizadas.</p>
    </div>

    <!-- Sección de Introducción a CEM -->
    <section class="introduction-section mb-5" style="padding: 60px 20px; background-color: #ffffffbf; text-align: center;">
        <div class="row align-items-center">
            <!-- Texto a la Izquierda en Desktop -->
            <div class="col-md-6 order-md-1">
                <h3 class="titulo-seccion mt-0">Integración Total para una Experiencia Superior</h3>
                <p>
                    Nuestra Plataforma Integral de Gestión de la Experiencia del Cliente (CEM) centraliza todas las herramientas necesarias para gestionar, optimizar y personalizar cada interacción con tus clientes. Desde la administración de URLs y Pulzcards hasta el análisis de datos y la fidelización, nuestra solución está diseñada para cubrir todas tus necesidades.
                </p>
            </div>
            <!-- Imagen a la Derecha en Desktop -->
            <div class="col-md-6 order-md-2 mt-4 mt-md-0">
                <img src="{{ url_for('static', filename='images/cem_overview.jpg') }}" alt="Plataforma CEM" class="img-fluid rounded shadow-sm zoom-effect">
            </div>
        </div>
    </section>

    <!-- Sección de Servicios por Componentes de CEM -->
    <section class="services-section" style="padding: 20px; background-color: #ffffffbf; text-align: center;">
        <h2 class="titulo-seccion">Servicios Basados en Nuestra Plataforma CEM</h2>
        <div class="row">
            <!-- Servicio 1: Administración de URLs -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-link fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Administración de URLs</h5>
                        <p class="card-text">
                            Gestiona URLs dedicadas para atención al cliente, acceso a productos, carrito de compra, evaluación de servicios y más, todo desde una sola plataforma.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Estoy interesado en la Administración de URLs para mi negocio.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Administración de URLs" 
                               title="Contactar sobre Administración de URLs">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 2: Gestión de Pulzcards -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-id-badge fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Gestión de Pulzcards</h5>
                        <p class="card-text">
                            Crea y administra tarjetas virtuales con información de contacto, códigos QR personalizados y control de acceso a espacios físicos.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Quiero saber más sobre la Gestión de Pulzcards.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Gestión de Pulzcards" 
                               title="Contactar sobre Gestión de Pulzcards">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 3: Gestión de Etiquetas (Tags) -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-tags fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Gestión de Etiquetas (Tags)</h5>
                        <p class="card-text">
                            Administra etiquetas NFC y códigos QR personalizados con funcionalidades avanzadas de importación, exportación y eliminación masiva.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Estoy interesado en la Gestión de Etiquetas (Tags).') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Gestión de Etiquetas" 
                               title="Contactar sobre Gestión de Etiquetas">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 4: Gestión de Inventario -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-warehouse fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Gestión de Inventario</h5>
                        <p class="card-text">
                            Organiza y gestiona tus productos y recursos de manera intuitiva, con generación de códigos QR para facilitar el acceso y la administración de bodegas y cajas.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Quiero implementar la Gestión de Inventario en mi empresa.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Gestión de Inventario" 
                               title="Contactar sobre Gestión de Inventario">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 5: Administración de Productos -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-box-open fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Administración de Productos</h5>
                        <p class="card-text">
                            Gestiona detalladamente tus productos, incluyendo categorías, subcategorías, descripciones y stock, con generación de códigos QR para facilitar su seguimiento y gestión.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Estoy interesado en la Administración de Productos.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Administración de Productos" 
                               title="Contactar sobre Administración de Productos">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 6: Análisis de Datos -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-chart-pie fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Análisis de Datos</h5>
                        <p class="card-text">
                            Utiliza herramientas integradas para analizar el comportamiento y las preferencias de tus clientes, generando informes y estadísticas para tomar decisiones informadas.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Quiero conocer más sobre el Análisis de Datos en CEM.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Análisis de Datos" 
                               title="Contactar sobre Análisis de Datos">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 7: Fidelización de Clientes -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-heart fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Fidelización de Clientes</h5>
                        <p class="card-text">
                            Implementa programas de lealtad efectivos y sigue las interacciones para mantener y aumentar la fidelidad de tus clientes.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Estoy interesado en Programas de Fidelización de Clientes.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Fidelización de Clientes" 
                               title="Contactar sobre Fidelización de Clientes">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 8: Integración de Sistemas -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-cogs fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Integración de Sistemas</h5>
                        <p class="card-text">
                            Integramos nuestras soluciones NFC con tus sistemas existentes para optimizar procesos y mejorar la eficiencia operativa de tu negocio.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Estoy interesado en la Integración de Sistemas NFC con mis procesos actuales.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Integración de Sistemas" 
                               title="Contactar sobre Integración de Sistemas">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Servicio 9: Soporte y Mantenimiento -->
            <div class="col-md-4 mb-4">
                <div class="card service-card h-100 border-0" data-aos="fade-up">
                    <div class="card-body d-flex flex-column">
                        <i class="fas fa-life-ring fa-3x text-primary mb-3"></i>
                        <h5 class="card-title">Soporte y Mantenimiento</h5>
                        <p class="card-text">
                            Ofrecemos soporte técnico continuo y servicios de mantenimiento para asegurar que todas tus soluciones CEM funcionen de manera óptima.
                        </p>
                        <div class="mt-auto d-flex justify-content-end">
                            <a href="{{ url_for('contact', message='Necesito soporte y mantenimiento para mis soluciones CEM.') }}" 
                               class="btn btn-outline-primary btn-sm" 
                               aria-label="Contactar sobre Soporte y Mantenimiento" 
                               title="Contactar sobre Soporte y Mantenimiento">
                               <i class="fa-solid fa-paper-plane me-2"></i> Contactar
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Sección de Testimonios y Casos de Éxito
    <section class="testimonials-section py-5 bg-light">
        <div class="container">
            <h2 class="text-center mb-4">Lo que Dicen Nuestros Clientes</h2>
            <div class="row">
                !-- Testimonio 1 --
                <div class="col-md-4 mb-4">
                    <div class="testimonial-card p-4 shadow-sm rounded">
                        <p class="mb-3">"La Plataforma CEM de Pulztag ha revolucionado nuestra manera de interactuar con los clientes, mejorando significativamente su satisfacción y lealtad."</p>
                        <h5 class="text-primary">Ana Martínez</h5>
                        <small>Gerente de Ventas - Empresa DEF</small>
                    </div>
                </div>
                !-- Testimonio 2 --
                <div class="col-md-4 mb-4">
                    <div class="testimonial-card p-4 shadow-sm rounded">
                        <p class="mb-3">"Gracias a la gestión de Pulzcards y etiquetas, hemos optimizado nuestros procesos internos y ofrecemos una experiencia de cliente más personalizada."</p>
                        <h5 class="text-primary">Luis Rodríguez</h5>
                        <small>Director de Operaciones - Empresa GHI</small>
                    </div>
                </div>
                !-- Testimonio 3 --
                <div class="col-md-4 mb-4">
                    <div class="testimonial-card p-4 shadow-sm rounded">
                        <p class="mb-3">"El análisis de datos proporcionado por la Plataforma CEM nos ha permitido tomar decisiones estratégicas basadas en información real y actualizada."</p>
                        <h5 class="text-primary">Carla Fernández</h5>
                        <small>Analista de Datos - Empresa JKL</small>
                    </div>
                </div>
            </div>
        </div>
    </section> -->

    <!-- Sección de Llamado a la Acción Final -->
    <section class="cta-section bg-info text-white py-5 mt-4">
        <div class="container text-center">
            <h2 class="mb-4">¿Listo para Transformar la Experiencia de tus Clientes?</h2>
            <p class="lead mb-4">
                Únete a las empresas que ya están optimizando sus interacciones con clientes gracias a nuestra Plataforma CEM.
            </p>
            <a href="{{ url_for('contact') }}" class="btn btn-light btn-lg">Contáctanos</a>
        </div>
    </section>

</div>

{% block scripts %}
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Librería AOS para Animaciones -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script>
        AOS.init({
            duration: 800,
            easing: 'slide',
            once: true
        });
    </script>
<style>
    .titulo-seccion {
        margin-top: 50px; /* Añade espacio superior */
    }
</style>
<style>
/* Efecto hover en las tarjetas */
.service-card {
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.service-card:hover {
    transform: translateY(-5px); /* Efecto de elevación */
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); /* Sombra más pronunciada */
}

/* Personalización del ícono en hover */
.service-card a.btn-outline-primary i {
    color: #9b9b9c; /* Color inicial del ícono */
    transition: color 0.3s ease;
}

.service-card:hover a.btn-outline-primary i {
    color: #fe6565; /* Cambia el color del ícono en hover */
}

/* Personalización del botón en hover */
.service-card a.btn-outline-primary:hover {
    background-color: #f8f8f8; /* Cambia el color de fondo */
    border-color: #fe6565; /* Color del borde */
    color: #ff0000; /* Color del texto */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1); /* Sombra ligera */
    transform: scale(1.03); /* Efecto ligero de aumento */
}
</style>
{% endblock %}
{% endblock %}

----- Fin de templates/services.html -----

----- Inicio de templates/sidebar.html -----
<!-- templates/sidebar.html de ejemplo -->

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.84.0">
    <title>Sidebars · Bootstrap v5.0</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/sidebars/">

    

    <!-- Bootstrap core CSS -->
<link href="/docs/5.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Favicons -->
<link rel="apple-touch-icon" href="/docs/5.0/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/docs/5.0/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="/docs/5.0/assets/img/favicons/safari-pinned-tab.svg" color="#7952b3">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon.ico">
<meta name="theme-color" content="#7952b3">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="sidebars.css" rel="stylesheet">
  </head>
  <body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="bootstrap" viewBox="0 0 118 94">
    <title>Bootstrap</title>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z"></path>
  </symbol>
  <symbol id="home" viewBox="0 0 16 16">
    <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
  </symbol>
  <symbol id="speedometer2" viewBox="0 0 16 16">
    <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
    <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z"/>
  </symbol>
  <symbol id="table" viewBox="0 0 16 16">
    <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 2h-4v3h4V4zm0 4h-4v3h4V8zm0 4h-4v3h3a1 1 0 0 0 1-1v-2zm-5 3v-3H6v3h4zm-5 0v-3H1v2a1 1 0 0 0 1 1h3zm-4-4h4V8H1v3zm0-4h4V4H1v3zm5-3v3h4V4H6zm4 4H6v3h4V8z"/>
  </symbol>
  <symbol id="people-circle" viewBox="0 0 16 16">
    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
  </symbol>
  <symbol id="grid" viewBox="0 0 16 16">
    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
  </symbol>
  <symbol id="collection" viewBox="0 0 16 16">
    <path d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-13z"/>
  </symbol>
  <symbol id="calendar3" viewBox="0 0 16 16">
    <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
    <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
  </symbol>
  <symbol id="chat-quote-fill" viewBox="0 0 16 16">
    <path d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM7.194 6.766a1.688 1.688 0 0 0-.227-.272 1.467 1.467 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 5.734 6C4.776 6 4 6.746 4 7.667c0 .92.776 1.666 1.734 1.666.343 0 .662-.095.931-.26-.137.389-.39.804-.81 1.22a.405.405 0 0 0 .011.59c.173.16.447.155.614-.01 1.334-1.329 1.37-2.758.941-3.706a2.461 2.461 0 0 0-.227-.4zM11 9.073c-.136.389-.39.804-.81 1.22a.405.405 0 0 0 .012.59c.172.16.446.155.613-.01 1.334-1.329 1.37-2.758.942-3.706a2.466 2.466 0 0 0-.228-.4 1.686 1.686 0 0 0-.227-.273 1.466 1.466 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 10.07 6c-.957 0-1.734.746-1.734 1.667 0 .92.777 1.666 1.734 1.666.343 0 .662-.095.931-.26z"/>
  </symbol>
  <symbol id="cpu-fill" viewBox="0 0 16 16">
    <path d="M6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
    <path d="M5.5.5a.5.5 0 0 0-1 0V2A2.5 2.5 0 0 0 2 4.5H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2A2.5 2.5 0 0 0 4.5 14v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14a2.5 2.5 0 0 0 2.5-2.5h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14A2.5 2.5 0 0 0 11.5 2V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5zm1 4.5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3A1.5 1.5 0 0 1 6.5 5z"/>
  </symbol>
  <symbol id="gear-fill" viewBox="0 0 16 16">
    <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
  </symbol>
  <symbol id="speedometer" viewBox="0 0 16 16">
    <path d="M8 2a.5.5 0 0 1 .5.5V4a.5.5 0 0 1-1 0V2.5A.5.5 0 0 1 8 2zM3.732 3.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 8a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 8zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 7.31A.91.91 0 1 0 8.85 8.569l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
    <path fill-rule="evenodd" d="M6.664 15.889A8 8 0 1 1 9.336.11a8 8 0 0 1-2.672 15.78zm-4.665-4.283A11.945 11.945 0 0 1 8 10c2.186 0 4.236.585 6.001 1.606a7 7 0 1 0-12.002 0z"/>
  </symbol>
  <symbol id="toggles2" viewBox="0 0 16 16">
    <path d="M9.465 10H12a2 2 0 1 1 0 4H9.465c.34-.588.535-1.271.535-2 0-.729-.195-1.412-.535-2z"/>
    <path d="M6 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 1a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm.535-10a3.975 3.975 0 0 1-.409-1H4a1 1 0 0 1 0-2h2.126c.091-.355.23-.69.41-1H4a2 2 0 1 0 0 4h2.535z"/>
    <path d="M14 4a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/>
  </symbol>
  <symbol id="tools" viewBox="0 0 16 16">
    <path d="M1 0L0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z"/>
  </symbol>
  <symbol id="chevron-right" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
  </symbol>
  <symbol id="geo-fill" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z"/>
  </symbol>
</svg>

<main>
  <h1 class="visually-hidden">Sidebars examples</h1>

  <div class="flex-shrink-0 p-3 bg-white" style="width: 280px;">
    <a href="/" class="d-flex align-items-center pb-3 mb-3 link-dark text-decoration-none border-bottom">
      <svg class="bi me-2" width="30" height="24"><use xlink:href="#bootstrap"/></svg>
      <span class="fs-5 fw-semibold">Collapsible</span>
    </a>
    <ul class="list-unstyled ps-0">
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-expanded="false">
          Dashboard
        </button>
        <div class="collapse" id="dashboard-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Pulzcard</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
            <li><a href="#" class="link-dark rounded">Etiquetas y QR Code</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
            <li><a href="#" class="link-dark rounded">Bodegas</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
          </ul>
        </div>
      </li>
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#orders-collapse" aria-expanded="false">
          Orders
        </button>
        <div class="collapse" id="orders-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Crear</a></li>
            <li><a href="#" class="link-dark rounded">Pedidos</a></li>
          </ul>
        </div>
      </li>
      <li class="border-top my-3"></li>
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#account-collapse" aria-expanded="false">
          Account
        </button>
        <div class="collapse" id="account-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Mi Perfil</a></li>
            <li><a href="#" class="link-dark rounded">Editar Datos</a></li>
            <li><a href="#" class="link-dark rounded">Cerrar Sesión</a></li>
          </ul>
        </div>
      </li>
    </ul>
  </div>
</main>


    <script src="/docs/5.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

      <script src="sidebars.js"></script>
  </body>
</html>




Comparto Contigo los principales codigos de un proyecto para administrar y configurar dispositivos direcciones URL de Etiquetas, vCard y bodegas. Quiero hacer un cambio para ordenar la visualización del Perfil. Poner en Perfil todas las secciones no se ve muy profesional, y creo que se vería mejor ordenado todo en un Sidebar colapsable moderno (por ejemplo con bootstrap 5 que comparto abajo (este es un ejemplo que si quieres puede mejorar). Me gustaría que al abrir mi perfil aparezca "Mi Perfil" solo con lo de la sección Mi perfil, y lo que se muestre al lado derecho del sidebar sea lo que se selecciona del sidebar.

Ejemplo de sidebar con bootsrap 5

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.84.0">
    <title>Sidebars · Bootstrap v5.0</title>

    <link rel="canonical" href="https://getbootstrap.com/docs/5.0/examples/sidebars/">

    

    <!-- Bootstrap core CSS -->
<link href="/docs/5.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Favicons -->
<link rel="apple-touch-icon" href="/docs/5.0/assets/img/favicons/apple-touch-icon.png" sizes="180x180">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-32x32.png" sizes="32x32" type="image/png">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon-16x16.png" sizes="16x16" type="image/png">
<link rel="manifest" href="/docs/5.0/assets/img/favicons/manifest.json">
<link rel="mask-icon" href="/docs/5.0/assets/img/favicons/safari-pinned-tab.svg" color="#7952b3">
<link rel="icon" href="/docs/5.0/assets/img/favicons/favicon.ico">
<meta name="theme-color" content="#7952b3">


    <style>
      .bd-placeholder-img {
        font-size: 1.125rem;
        text-anchor: middle;
        -webkit-user-select: none;
        -moz-user-select: none;
        user-select: none;
      }

      @media (min-width: 768px) {
        .bd-placeholder-img-lg {
          font-size: 3.5rem;
        }
      }
    </style>

    
    <!-- Custom styles for this template -->
    <link href="sidebars.css" rel="stylesheet">
  </head>
  <body>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="bootstrap" viewBox="0 0 118 94">
    <title>Bootstrap</title>
    <path fill-rule="evenodd" clip-rule="evenodd" d="M24.509 0c-6.733 0-11.715 5.893-11.492 12.284.214 6.14-.064 14.092-2.066 20.577C8.943 39.365 5.547 43.485 0 44.014v5.972c5.547.529 8.943 4.649 10.951 11.153 2.002 6.485 2.28 14.437 2.066 20.577C12.794 88.106 17.776 94 24.51 94H93.5c6.733 0 11.714-5.893 11.491-12.284-.214-6.14.064-14.092 2.066-20.577 2.009-6.504 5.396-10.624 10.943-11.153v-5.972c-5.547-.529-8.934-4.649-10.943-11.153-2.002-6.484-2.28-14.437-2.066-20.577C105.214 5.894 100.233 0 93.5 0H24.508zM80 57.863C80 66.663 73.436 72 62.543 72H44a2 2 0 01-2-2V24a2 2 0 012-2h18.437c9.083 0 15.044 4.92 15.044 12.474 0 5.302-4.01 10.049-9.119 10.88v.277C75.317 46.394 80 51.21 80 57.863zM60.521 28.34H49.948v14.934h8.905c6.884 0 10.68-2.772 10.68-7.727 0-4.643-3.264-7.207-9.012-7.207zM49.948 49.2v16.458H60.91c7.167 0 10.964-2.876 10.964-8.281 0-5.406-3.903-8.178-11.425-8.178H49.948z"></path>
  </symbol>
  <symbol id="home" viewBox="0 0 16 16">
    <path d="M8.354 1.146a.5.5 0 0 0-.708 0l-6 6A.5.5 0 0 0 1.5 7.5v7a.5.5 0 0 0 .5.5h4.5a.5.5 0 0 0 .5-.5v-4h2v4a.5.5 0 0 0 .5.5H14a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.146-.354L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293L8.354 1.146zM2.5 14V7.707l5.5-5.5 5.5 5.5V14H10v-4a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v4H2.5z"/>
  </symbol>
  <symbol id="speedometer2" viewBox="0 0 16 16">
    <path d="M8 4a.5.5 0 0 1 .5.5V6a.5.5 0 0 1-1 0V4.5A.5.5 0 0 1 8 4zM3.732 5.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 10a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 10zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 9.31a.91.91 0 1 0 1.302 1.258l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
    <path fill-rule="evenodd" d="M0 10a8 8 0 1 1 15.547 2.661c-.442 1.253-1.845 1.602-2.932 1.25C11.309 13.488 9.475 13 8 13c-1.474 0-3.31.488-4.615.911-1.087.352-2.49.003-2.932-1.25A7.988 7.988 0 0 1 0 10zm8-7a7 7 0 0 0-6.603 9.329c.203.575.923.876 1.68.63C4.397 12.533 6.358 12 8 12s3.604.532 4.923.96c.757.245 1.477-.056 1.68-.631A7 7 0 0 0 8 3z"/>
  </symbol>
  <symbol id="table" viewBox="0 0 16 16">
    <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm15 2h-4v3h4V4zm0 4h-4v3h4V8zm0 4h-4v3h3a1 1 0 0 0 1-1v-2zm-5 3v-3H6v3h4zm-5 0v-3H1v2a1 1 0 0 0 1 1h3zm-4-4h4V8H1v3zm0-4h4V4H1v3zm5-3v3h4V4H6zm4 4H6v3h4V8z"/>
  </symbol>
  <symbol id="people-circle" viewBox="0 0 16 16">
    <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
    <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
  </symbol>
  <symbol id="grid" viewBox="0 0 16 16">
    <path d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
  </symbol>
  <symbol id="collection" viewBox="0 0 16 16">
    <path d="M2.5 3.5a.5.5 0 0 1 0-1h11a.5.5 0 0 1 0 1h-11zm2-2a.5.5 0 0 1 0-1h7a.5.5 0 0 1 0 1h-7zM0 13a1.5 1.5 0 0 0 1.5 1.5h13A1.5 1.5 0 0 0 16 13V6a1.5 1.5 0 0 0-1.5-1.5h-13A1.5 1.5 0 0 0 0 6v7zm1.5.5A.5.5 0 0 1 1 13V6a.5.5 0 0 1 .5-.5h13a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-13z"/>
  </symbol>
  <symbol id="calendar3" viewBox="0 0 16 16">
    <path d="M14 0H2a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2zM1 3.857C1 3.384 1.448 3 2 3h12c.552 0 1 .384 1 .857v10.286c0 .473-.448.857-1 .857H2c-.552 0-1-.384-1-.857V3.857z"/>
    <path d="M6.5 7a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm-9 3a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm3 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/>
  </symbol>
  <symbol id="chat-quote-fill" viewBox="0 0 16 16">
    <path d="M16 8c0 3.866-3.582 7-8 7a9.06 9.06 0 0 1-2.347-.306c-.584.296-1.925.864-4.181 1.234-.2.032-.352-.176-.273-.362.354-.836.674-1.95.77-2.966C.744 11.37 0 9.76 0 8c0-3.866 3.582-7 8-7s8 3.134 8 7zM7.194 6.766a1.688 1.688 0 0 0-.227-.272 1.467 1.467 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 5.734 6C4.776 6 4 6.746 4 7.667c0 .92.776 1.666 1.734 1.666.343 0 .662-.095.931-.26-.137.389-.39.804-.81 1.22a.405.405 0 0 0 .011.59c.173.16.447.155.614-.01 1.334-1.329 1.37-2.758.941-3.706a2.461 2.461 0 0 0-.227-.4zM11 9.073c-.136.389-.39.804-.81 1.22a.405.405 0 0 0 .012.59c.172.16.446.155.613-.01 1.334-1.329 1.37-2.758.942-3.706a2.466 2.466 0 0 0-.228-.4 1.686 1.686 0 0 0-.227-.273 1.466 1.466 0 0 0-.469-.324l-.008-.004A1.785 1.785 0 0 0 10.07 6c-.957 0-1.734.746-1.734 1.667 0 .92.777 1.666 1.734 1.666.343 0 .662-.095.931-.26z"/>
  </symbol>
  <symbol id="cpu-fill" viewBox="0 0 16 16">
    <path d="M6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>
    <path d="M5.5.5a.5.5 0 0 0-1 0V2A2.5 2.5 0 0 0 2 4.5H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2v1H.5a.5.5 0 0 0 0 1H2A2.5 2.5 0 0 0 4.5 14v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14h1v1.5a.5.5 0 0 0 1 0V14a2.5 2.5 0 0 0 2.5-2.5h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14v-1h1.5a.5.5 0 0 0 0-1H14A2.5 2.5 0 0 0 11.5 2V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5a.5.5 0 0 0-1 0V2h-1V.5zm1 4.5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3A1.5 1.5 0 0 1 6.5 5z"/>
  </symbol>
  <symbol id="gear-fill" viewBox="0 0 16 16">
    <path d="M9.405 1.05c-.413-1.4-2.397-1.4-2.81 0l-.1.34a1.464 1.464 0 0 1-2.105.872l-.31-.17c-1.283-.698-2.686.705-1.987 1.987l.169.311c.446.82.023 1.841-.872 2.105l-.34.1c-1.4.413-1.4 2.397 0 2.81l.34.1a1.464 1.464 0 0 1 .872 2.105l-.17.31c-.698 1.283.705 2.686 1.987 1.987l.311-.169a1.464 1.464 0 0 1 2.105.872l.1.34c.413 1.4 2.397 1.4 2.81 0l.1-.34a1.464 1.464 0 0 1 2.105-.872l.31.17c1.283.698 2.686-.705 1.987-1.987l-.169-.311a1.464 1.464 0 0 1 .872-2.105l.34-.1c1.4-.413 1.4-2.397 0-2.81l-.34-.1a1.464 1.464 0 0 1-.872-2.105l.17-.31c.698-1.283-.705-2.686-1.987-1.987l-.311.169a1.464 1.464 0 0 1-2.105-.872l-.1-.34zM8 10.93a2.929 2.929 0 1 1 0-5.86 2.929 2.929 0 0 1 0 5.858z"/>
  </symbol>
  <symbol id="speedometer" viewBox="0 0 16 16">
    <path d="M8 2a.5.5 0 0 1 .5.5V4a.5.5 0 0 1-1 0V2.5A.5.5 0 0 1 8 2zM3.732 3.732a.5.5 0 0 1 .707 0l.915.914a.5.5 0 1 1-.708.708l-.914-.915a.5.5 0 0 1 0-.707zM2 8a.5.5 0 0 1 .5-.5h1.586a.5.5 0 0 1 0 1H2.5A.5.5 0 0 1 2 8zm9.5 0a.5.5 0 0 1 .5-.5h1.5a.5.5 0 0 1 0 1H12a.5.5 0 0 1-.5-.5zm.754-4.246a.389.389 0 0 0-.527-.02L7.547 7.31A.91.91 0 1 0 8.85 8.569l3.434-4.297a.389.389 0 0 0-.029-.518z"/>
    <path fill-rule="evenodd" d="M6.664 15.889A8 8 0 1 1 9.336.11a8 8 0 0 1-2.672 15.78zm-4.665-4.283A11.945 11.945 0 0 1 8 10c2.186 0 4.236.585 6.001 1.606a7 7 0 1 0-12.002 0z"/>
  </symbol>
  <symbol id="toggles2" viewBox="0 0 16 16">
    <path d="M9.465 10H12a2 2 0 1 1 0 4H9.465c.34-.588.535-1.271.535-2 0-.729-.195-1.412-.535-2z"/>
    <path d="M6 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm0 1a4 4 0 1 1 0-8 4 4 0 0 1 0 8zm.535-10a3.975 3.975 0 0 1-.409-1H4a1 1 0 0 1 0-2h2.126c.091-.355.23-.69.41-1H4a2 2 0 1 0 0 4h2.535z"/>
    <path d="M14 4a4 4 0 1 1-8 0 4 4 0 0 1 8 0z"/>
  </symbol>
  <symbol id="tools" viewBox="0 0 16 16">
    <path d="M1 0L0 1l2.2 3.081a1 1 0 0 0 .815.419h.07a1 1 0 0 1 .708.293l2.675 2.675-2.617 2.654A3.003 3.003 0 0 0 0 13a3 3 0 1 0 5.878-.851l2.654-2.617.968.968-.305.914a1 1 0 0 0 .242 1.023l3.356 3.356a1 1 0 0 0 1.414 0l1.586-1.586a1 1 0 0 0 0-1.414l-3.356-3.356a1 1 0 0 0-1.023-.242L10.5 9.5l-.96-.96 2.68-2.643A3.005 3.005 0 0 0 16 3c0-.269-.035-.53-.102-.777l-2.14 2.141L12 4l-.364-1.757L13.777.102a3 3 0 0 0-3.675 3.68L7.462 6.46 4.793 3.793a1 1 0 0 1-.293-.707v-.071a1 1 0 0 0-.419-.814L1 0zm9.646 10.646a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708l-3-3a.5.5 0 0 1 0-.708zM3 11l.471.242.529.026.287.445.445.287.026.529L5 13l-.242.471-.026.529-.445.287-.287.445-.529.026L3 15l-.471-.242L2 14.732l-.287-.445L1.268 14l-.026-.529L1 13l.242-.471.026-.529.445-.287.287-.445.529-.026L3 11z"/>
  </symbol>
  <symbol id="chevron-right" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4.646 1.646a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 0 .708l-6 6a.5.5 0 0 1-.708-.708L10.293 8 4.646 2.354a.5.5 0 0 1 0-.708z"/>
  </symbol>
  <symbol id="geo-fill" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 4a4 4 0 1 1 4.5 3.969V13.5a.5.5 0 0 1-1 0V7.97A4 4 0 0 1 4 3.999zm2.493 8.574a.5.5 0 0 1-.411.575c-.712.118-1.28.295-1.655.493a1.319 1.319 0 0 0-.37.265.301.301 0 0 0-.057.09V14l.002.008a.147.147 0 0 0 .016.033.617.617 0 0 0 .145.15c.165.13.435.27.813.395.751.25 1.82.414 3.024.414s2.273-.163 3.024-.414c.378-.126.648-.265.813-.395a.619.619 0 0 0 .146-.15.148.148 0 0 0 .015-.033L12 14v-.004a.301.301 0 0 0-.057-.09 1.318 1.318 0 0 0-.37-.264c-.376-.198-.943-.375-1.655-.493a.5.5 0 1 1 .164-.986c.77.127 1.452.328 1.957.594C12.5 13 13 13.4 13 14c0 .426-.26.752-.544.977-.29.228-.68.413-1.116.558-.878.293-2.059.465-3.34.465-1.281 0-2.462-.172-3.34-.465-.436-.145-.826-.33-1.116-.558C3.26 14.752 3 14.426 3 14c0-.599.5-1 .961-1.243.505-.266 1.187-.467 1.957-.594a.5.5 0 0 1 .575.411z"/>
  </symbol>
</svg>

<main>
  <h1 class="visually-hidden">Sidebars examples</h1>

  <div class="flex-shrink-0 p-3 bg-white" style="width: 280px;">
    <a href="/" class="d-flex align-items-center pb-3 mb-3 link-dark text-decoration-none border-bottom">
      <svg class="bi me-2" width="30" height="24"><use xlink:href="#bootstrap"/></svg>
      <span class="fs-5 fw-semibold">Collapsible</span>
    </a>
    <ul class="list-unstyled ps-0">
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-expanded="false">
          Dashboard
        </button>
        <div class="collapse" id="dashboard-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Pulzcard</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
            <li><a href="#" class="link-dark rounded">Etiquetas y QR Code</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
            <li><a href="#" class="link-dark rounded">Bodegas</a></li> <!-- aquí sería bueno que sea colapsable con botones de "crear nuevo" y "ver todos" -->
          </ul>
        </div>
      </li>
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#orders-collapse" aria-expanded="false">
          Orders
        </button>
        <div class="collapse" id="orders-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Crear</a></li>
            <li><a href="#" class="link-dark rounded">Pedidos</a></li>
          </ul>
        </div>
      </li>
      <li class="border-top my-3"></li>
      <li class="mb-1">
        <button class="btn btn-toggle align-items-center rounded collapsed" data-bs-toggle="collapse" data-bs-target="#account-collapse" aria-expanded="false">
          Account
        </button>
        <div class="collapse" id="account-collapse">
          <ul class="btn-toggle-nav list-unstyled fw-normal pb-1 small">
            <li><a href="#" class="link-dark rounded">Mi Perfil</a></li>
            <li><a href="#" class="link-dark rounded">Editar Datos</a></li>
            <li><a href="#" class="link-dark rounded">Cerrar Sesión</a></li>
          </ul>
        </div>
      </li>
    </ul>
  </div>
</main>


    <script src="/docs/5.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

      <script src="sidebars.js"></script>
  </body>
</html>

Codigos de mi proyecto:

/* static/css/style.css */

/* Tipografía Global */
body {
    background-image: url("/static/images/background.jpg"), url("/static/images/backup.jpg");
    background-size: cover;
    background-attachment: fixed;
    background-position: center;
}
/* Encabezados */
h1,
h2,
h3,
h4,
h5,
h6 {
    font-family: 'Montserrat', sans-serif;
    color: #03c0ff;
}

/* Navbar */
.navbar {
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); /* Sombra para destacar la navbar */
}

.navbar-brand {
    font-family: 'Montserrat', sans-serif;
    font-size: 1.8rem; /* Aumentado de 1.5rem a 1.8rem */
    display: flex;
    align-items: center;
}

.navbar-brand img {
    margin-right: 10px; /* Espacio entre logo y texto */
}

.nav-link {
    color: #555555 !important;
    transition: color 0.3s, transform 0.3s, background-color 0.3s;
    font-size: 1.0rem; /* Aumentado de 1.07rem a 1.2rem */
    padding: 0.5rem 1rem; /* Mayor área clicable */
    border-radius: 5px; /* Bordes redondeados */
    position: relative;
}

.nav-link::after {
    content: '';
    position: absolute;
    width: 0%;
    height: 1px;
    background-color: #03c0ff;
    left: 0;
    bottom: 0;
    transition: width 0.3s;
}

.nav-link:hover::after {
    width: 100%; /* Subrayado animado al hacer hover */
}

.nav-link:hover {
    color: #03c0ff !important;
    transform: translateY(-2px); /* Subir ligeramente al pasar el cursor */
    background-color: rgba(3, 192, 255, 0.1); /* Fondo sutil al pasar el cursor */
}

.nav-link.active {
    color: #03c0ff !important;
    font-weight: 600; /* Aumentado de 500 a 600 para mayor énfasis */
    background-color: rgba(3, 192, 255, 0.2); /* Fondo para el enlace activo */
    border-bottom: 3px solid #03c0ff;
}

/* Dropdown Menus */
.dropdown-menu {
    border-radius: 10px;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.dropdown-item {
    transition: background-color 0.3s, color 0.3s;
}

.dropdown-item:hover {
    background-color: #03c0ff;
    color: #ffffff;
}

/* Botones de la Cuenta */
.navbar-nav .dropdown-toggle::after {
    margin-left: 0.3em;
    vertical-align: 0.3em;
}

/* Responsividad para la Navbar */
@media (max-width: 992px) {
    .nav-link {
        font-size: 1rem; /* Reducido para pantallas pequeñas */
        padding: 0.5rem; /* Ajuste de padding */
    }
}

/* Ajustes Adicionales para Mejorar la Apariencia */
.navbar-light .navbar-nav .nav-link {
    color: #555555;
}

.navbar-light .navbar-nav .nav-link.active {
    color: #03c0ff;
}

.navbar-light .navbar-nav .nav-link:hover {
    color: #03c0ff;
}

/* Iconos en los Enlaces de Navegación */
.nav-link i {
    font-size: 1.1rem;
    vertical-align: middle;
}

/* Footer */
footer {
    background-color: #f1f1f1;
    color: #555555;
}

footer a {
    color: #03c0ff;
    text-decoration: none;
}

footer a:hover {
    text-decoration: underline;
}

footer .container {
    max-width: 1200px;
}

footer div {
    display: flex;
    align-items: center;
}

/* Botones Personalizados */
.btn-primary {
    background-color: #03c0ff;
    border-color: #03c0ff;
}

.btn-primary:hover {
    background-color: #02a8d1;
    border-color: #0290b8;
}

/* Jumbotron / Hero Section */
.jumbotron {
    background: linear-gradient(135deg, #ffffff 0%, #e6f7ff 100%);
    padding: 4rem 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.jumbotron h1 {
    color: #03c0ff;
}

.jumbotron p {
    color: #555555;
}

/* Clase para el fondo de las secciones de servicios */
.service-background {
    background: linear-gradient(135deg, #ffffff 0%, #e6f7ff 100%);
    padding: 2rem;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    transition: background 0.3s ease;
}

.service-background:hover {
    background: linear-gradient(135deg, #f0f8ff 0%, #d0e8ff 100%);
}

/* Estilo personalizado para el texto de precio */
.price {
    font-size: 1.5rem;
    font-weight: bold;
    color: #333333;
    transition: color 0.3s ease;
    text-align: center;
}

.price:hover {
    color: #555555; /* Color más claro al pasar el cursor */
}

/* Cards */
.card {
    border: none;
    border-radius: 0.5rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s, box-shadow 0.3s;
}

.card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}

.card-title {
    color: #03c0ff;
}

/* Links */
a {
    color: #03c0ff;
    transition: color 0.3s;
}

a:hover {
    color: #0290b8;
    text-decoration: none;
}

/* Formularios */
.form-control {
    border-radius: 0.3rem;
    border: 1px solid #ced4da;
}

.form-control:focus {
    border-color: #03c0ff;
    box-shadow: none;
}

/* Estilo para el botón de eliminación con ícono */
form button {
    display: inline-block;
    margin: 0;
    padding: 0.25rem 0.75rem;
    background-color: #dc3545;
    color: white;
    border: none;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    cursor: pointer;
    transition: background-color 0.3s ease;
}

form button i {
    margin: 0;
    font-size: 1rem;
    color: white;
}

form button:hover {
    background-color: #c82333;
}

/* Responsividad en dispositivos móviles */
@media (max-width: 768px) {
    form button {
        font-size: 0.8rem;
        padding: 0.2rem 0.6rem;
    }

    form button i {
        font-size: 0.9rem;
    }
}

/* Color de los títulos y subtítulos en los formularios */
.form-title,
.form-subtitle {
    color: #03c0ff;
}

.card-header-custom {
    background: linear-gradient(135deg, #ffffff 0%, #ccefff 100%);
    color: #333333;
}

/* Estilo para la imagen de perfil en Pulzcard */
.profile-image {
    width: 150px;
    height: 150px;
    box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.profile-image:hover {
    transform: scale(1.05);
    box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
}

/* Estilo para enlaces, botones y textos en Pulzcard */
.text-primary,
.btn-outline-primary,
.btn-outline-secondary,
.text-primary.text-decoration-none {
    color: #03c0ff !important;
}

.text-primary:hover,
.btn-outline-primary:hover,
.btn-outline-secondary:hover {
    color: #0290b8 !important;
}

/* Estilos para el botón "Agregar Contacto" */
.btn-outline-primary {
    border-color: #03c0ff;
    color: #03c0ff;
}

.btn-outline-primary:hover {
    background-color: #e0f7ff;
    color: #0290b8;
    border-color: #0290b8;
}

/* Estilos para el botón "Compartir URL" */
.btn-outline-secondary {
    border-color: #03c0ff;
    color: #03c0ff;
}

.btn-outline-secondary:hover {
    background-color: #e0f7ff;
    color: #0290b8;
    border-color: #0290b8;
}

form .form-control {
    margin-bottom: 1.5rem;
}

form .form-check {
    margin-bottom: 1rem;
}

form .btn {
    padding: 0.5rem 1.5rem;
}

/* Estilos para las etapas del formulario de pedido */
form h4 {
    color: #03c0ff;
    margin-bottom: 1rem;
}

.form-check-label {
    margin-left: 0.5rem;
}

/* Estilos para el campo de cantidad */
#cantidad {
    max-width: 200px;
}

/* Botón de Envío personalizado */
#submitBtn {
    padding: 0.75rem 2rem;
    font-size: 1rem;
}

/* Responsividad para dispositivos móviles */
@media (max-width: 768px) {
    .row.justify-content-center {
        flex-direction: column;
    }

    #cantidad {
        max-width: 100%;
    }

    form h4 {
        font-size: 1.25rem;
    }

    img.rounded.shadow {
        width: 100%;
    }
}

/* Estilos para carga de archivos */
.list-group-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.list-group-item button {
    margin-left: 10px;
    background: none;
    border: none;
    color: #ff4d4d;
    cursor: pointer;
    text-decoration: underline;
    padding: 0;
    font-size: 0.9rem;
}

.list-group-item button:hover {
    color: #cc0000;
}

/* Estilos para mensajes de error */
.text-danger {
    font-size: 0.9rem;
}

/* Estilos para alertas */
.alert-success {
    background-color: #d4edda;
    color: #155724;
    border-color: #c3e6cb;
}

.alert-danger {
    background-color: #f8d7da;
    color: #721c24;
    border-color: #f5c6cb;
}

.alert {
    margin-top: 20px;
}

.text-muted {
    color: #a7a7a7 !important;
}

/* Estilos para la sección de Soluciones Personalizadas */
.custom-solutions-section {
    background: linear-gradient(135deg, #03c0ff 0%, #02a8d1 100%);
    color: #fff;
    padding: 40px;
    border-radius: 10px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.custom-solutions-section h4 {
    font-size: 2.5rem;
    margin-bottom: 20px;
}

.solutions-list {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
}

.solution-item {
    flex: 1 1 220px;
    margin: 10px;
    background-color: rgba(255, 255, 255, 0.1);
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    transition: transform 0.3s ease;
}

/* Botones personalizados */
.btn-custom-white {
    /* Degradado de transparente a blanco */
    background: linear-gradient(to bottom, #9cd6fd, transparent);
    
    color: #ffffff; /* Color de ícono en blanco */
    border: 2px solid #ffffff; /* Borde en blanco */
    transition: background 0.3s, color 0.3s;
    padding: 0.5rem;
    display: flex;
    align-items: center;
    justify-content: center;
    
    /* Opcional: añadir un poco de radio a las esquinas */
    border-radius: 4px;
}

.btn-custom-white:hover {
    background-color: #fede9d;
    color: #ffffff;
    border-color: #93f66f;
}

.btn-icon {
    padding: 0.5rem;
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

/* Estilos para la sección Hero en login y register */
.hero-section {
    position: relative;
    overflow: hidden;
    height: 85vh; /* Ajustar según necesidad */
}

.hero-video-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    z-index: 1;
}

.overlay {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 187, 255, 0.356);
    z-index: 2;
}

.hero-section .container-fluid {
    position: relative;
    z-index: 3;
}

.login-card, .register-card {
    background-color: rgba(255, 255, 255, 0.85); /* Semi-transparente */
    backdrop-filter: blur(5px); /* Efecto de desenfoque */
}

/* Responsividad para pantallas pequeñas */
@media (max-width: 576px) {
    .login-card, .register-card {
        width: 90%;
        padding: 1.5rem;
    }
}

.content-wrapper {
    padding-top: 100px;
    padding-bottom: 100px;
}

@media (max-width: 576px) {
    h1.display-2 {
        font-size: 2rem;
    }
    p.lead {
        font-size: 1rem;
    }
    .btn {
        font-size: 0.9rem;
        padding: 0.5rem 1rem;
    }
    .content-wrapper {
        padding-top: 30px;
        padding-bottom: 30px;
    }
    /* Ajustar márgenes y padding en secciones */
    section {
        margin: 20px 0;
    }
}

/* Ajustar imágenes */
img.img-fluid {
    max-width: 100%;
    height: auto;
}

.text-highlight {
    color: #ffd700;
}

@media (max-width: 768px) {
    .hero-section .btn-stack {
        display: flex;
        flex-direction: column;
        gap: 15px; /* Espacio entre los botones en móvil */
        align-items: center;
    }
}

/* Estilos para la sección informativa */
.about-section {
    background-color: #f9f9f9;
}

.about-section .card {
    transition: transform 0.3s, box-shadow 0.3s;
}

.about-section .card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
}

/* Estilos para la sección de llamada a la acción */
.cta-section {
    background-image: linear-gradient(135deg, #03c0ff 0%, #02a8d1 100%);
    color: #ffffff;
}

.cta-section h2 {
    font-size: 2.5rem;
    color: #ffffff;
}

.cta-section p {
    font-size: 1.25rem;
}

.cta-section .btn-light {
    color: #03c0ff;
    background-color: #ffffff;
    border-color: #ffffff;
}

.cta-section .btn-light:hover {
    color: #ffffff;
    background-color: transparent;
    border-color: #ffffff;
}

.custom-table {
    width: 100%; /* Ocupa el 100% del ancho del contenedor */
    border-collapse: separate;
    border-spacing: 0;
    border: 1px solid #dddddd;
    font-family: 'Roboto', sans-serif;
    font-size: 1rem;
    color: #333333;
    background-color: #ffffff;
    text-align: center; /* Centra el contenido de las celdas */
}

.custom-table th,
.custom-table td {
    text-align: center; /* Centra el texto y los botones */
    vertical-align: middle; /* Asegura que el contenido esté alineado verticalmente */
    padding: 10px;
    border-bottom: 1px solid #dddddd;
}

.custom-table th {
    background-color: #03c0ff;
    color: white;
    font-weight: 600;
    border-bottom: 2px solid #dddddd;
}

.custom-table tbody tr:hover {
    background-color: rgb(104, 245, 167); /* Efecto hover */
    color: white; /* Cambia el color del texto para mayor contraste */
}

.custom-table tbody tr:last-child td {
    border-bottom: none; /* Elimina la línea del último registro */
}

.custom-table td:last-child {
    width: 20%; /* Ajusta el ancho de la última columna */
}

.custom-table button {
    font-size: 0.9rem;
    margin: 0 5px;
    transition: transform 0.2s ease-in-out;
}

.custom-table button:hover {
    transform: scale(1.1); /* Efecto de agrandamiento para botones */
}

/* Estilos para las tarjetas de servicio */
.service-card {
    transition: transform 0.3s, box-shadow 0.3s;
    border: none;
    border-radius: 10px;
    background-color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.service-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.service-card .card-title {
    color: #03c0ff;
    font-weight: 600;
}

.service-card .card-text {
    color: #555555;
}

/* Estilos para las tarjetas de aplicación */
.application-card {
    transition: transform 0.3s, box-shadow 0.3s;
    border: none;
    border-radius: 10px;
    background-color: #ffffff;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
}

.application-card:hover {
    transform: translateY(-10px);
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
}

.application-card .card-title {
    color: #03c0ff;
    font-weight: 600;
}

.application-card .card-text {
    color: #555555;
}

/* Íconos de Font Awesome */
.service-card i {
    color: #03c0ff;
    transition: color 0.3s;
}

.service-card:hover i {
    color: #0290b8;
}

/* Fondo y color de la sección personalizada */
.custom-solutions-section {
    background: linear-gradient(135deg, #03c0ff 0%, #02a8d1 100%);
    color: #fff;
    border-radius: 15px;
}

.custom-solutions-section h3 {
    color: #ffffff;
}

/* Ajustes para las imágenes de las aplicaciones */
.application-card img {
    border-top-left-radius: 10px;
    border-top-right-radius: 10px;
    height: 200px;
    object-fit: cover;
}

/* Tipografía Mejorada */
h2.display-4 {
    font-weight: 700;
}

h3 {
    font-family: 'Montserrat', sans-serif;
}

.card-title {
    font-family: 'Montserrat', sans-serif;
}

/* Animaciones sutiles */
@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translate3d(0, 40px, 0);
    }
    to {
        opacity: 1;
        transform: translate3d(0, 0, 0);
    }
}

.card {
    animation: fadeInUp 0.5s ease forwards;
}

/* Estilos para los íconos de contacto */
.contact-icon {
    color: #3498db; /* Color inicial del ícono */
    font-size: 1.5rem; /* Tamaño del ícono */
    transition: color 0.3s, transform 0.3s;
    display: inline-block;
    text-decoration: none; /* Eliminar subrayado */
}

.contact-icon:hover {
    color: #2980b9; /* Color al pasar el cursor */
    transform: scale(1.2); /* Aumentar ligeramente el tamaño */
}


/* static/js/script.js */

document.addEventListener('DOMContentLoaded', function () {
    // Logo Upload Elements
    const logoUpload = document.getElementById('logoUpload');
    const logoList = document.getElementById('logoList');
    const logoError = document.getElementById('logoError');
    let selectedLogos = [];

    // Excel Upload Elements
    const excelUpload = document.getElementById('excelUpload');
    const excelList = document.getElementById('excelList');
    const excelError = document.getElementById('excelError');
    let selectedExcel = null;

    // Manejar la selección de logos
    logoUpload.addEventListener('change', function (e) {
        const files = Array.from(e.target.files);
        for (let file of files) {
            if (selectedLogos.length >= 10) {
                logoError.style.display = 'block';
                break;
            }
            if (['image/png', 'image/jpeg', 'image/jpg'].includes(file.type)) {
                selectedLogos.push(file);
                displayLogo(file);
            }
        }
        // No restablezcas el valor del input
        // logoUpload.value = ''; // Comentado para permitir que los archivos se envíen
    });

    // Mostrar un logo en la lista
    function displayLogo(file) {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.textContent = file.name;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'btn btn-danger btn-sm';
        removeBtn.textContent = 'Eliminar';
        removeBtn.addEventListener('click', function () {
            // Eliminar el archivo de selectedLogos
            selectedLogos = selectedLogos.filter((f) => f !== file);
            logoList.removeChild(li);
            logoError.style.display = 'none';

            // Actualizar el input de archivos
            updateLogoInput();
        });

        li.appendChild(removeBtn);
        logoList.appendChild(li);
    }

    // Actualizar el input de archivos para reflejar los archivos seleccionados
    function updateLogoInput() {
        const dataTransfer = new DataTransfer();
        selectedLogos.forEach((file) => {
            dataTransfer.items.add(file);
        });
        logoUpload.files = dataTransfer.files;
    }

    // Manejar la selección de Excel
    excelUpload.addEventListener('change', function (e) {
        const file = e.target.files[0];
        if (selectedExcel) {
            excelError.style.display = 'block';
            // Restablece el input para evitar múltiples archivos
            excelUpload.value = '';
            return;
        }
        if (file && ['application/vnd.openxmlformats-officedocument.spreadsheetml.sheet', 'application/vnd.ms-excel'].includes(file.type)) {
            selectedExcel = file;
            displayExcel(file);
        }
    });

    // Mostrar el archivo Excel en la lista
    function displayExcel(file) {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.textContent = file.name;

        const removeBtn = document.createElement('button');
        removeBtn.type = 'button';
        removeBtn.className = 'btn btn-danger btn-sm';
        removeBtn.textContent = 'Eliminar';
        removeBtn.addEventListener('click', function () {
            selectedExcel = null;
            excelList.removeChild(li);
            excelError.style.display = 'none';
            excelUpload.value = ''; // Restablecer el input
        });

        li.appendChild(removeBtn);
        excelList.appendChild(li);
    }
});

    <!-- templates/base.html -->

    <!DOCTYPE html>
    <html lang="es">
    <head>
        <script>
            document.addEventListener('scroll', () => {
                const scrollPosition = window.scrollY; // Obtiene la posición del scroll
                document.body.style.backgroundPosition = `center ${50 + scrollPosition * 0.05}%`; // Ajusta posición vertical con un desplazamiento sutil
            });
        </script>
        <!-- Google Tag Manager -->
        <script>
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});
            var f=d.getElementsByTagName(s)[0], j=d.createElement(s), dl=l!='dataLayer'?'&l='+l:'';j.async=true;
            j.src='https://www.googletagmanager.com/gtm.js?id=GTM-NC88XS28'+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-NC88XS28');
        </script>
        <!-- End Google Tag Manager -->

        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}Pulztag{% endblock %}</title>

        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

        <!-- Bootstrap CSS -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

        <!-- Bootstrap Icons -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

        <!-- CSS Personalizado con Parámetro de Versión para Evitar Caché -->
        <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=1.0">
        
        {% block head %}{% endblock %}
    </head>

    <body>
        <!-- Google Tag Manager (noscript) -->
        <noscript>
            <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NC88XS28"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
        </noscript>
        <!-- End Google Tag Manager (noscript) -->
        
        <!-- Barra Superior -->
        <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
            <div class="container-fluid">
                <a class="navbar-brand text-primary fw-bold d-flex align-items-center" href="/">
                    <img src="{{ url_for('static', filename='images/logochain1.png') }}" alt="Pulztag Logo" height="40" class="me-2">
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNav">
                    <ul class="navbar-nav mx-auto">
                        <li class="nav-item"><a class="nav-link{% if request.path == '/' %} active{% endif %}" href="/">Inicio</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path == '/products' %} active{% endif %}" href="{{ url_for('products') }}">Productos</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path == '/services' %} active{% endif %}" href="{{ url_for('services') }}">Servicios</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path.startswith('/create_item') %} active{% endif %}" href="{{ url_for('create_item') }}">Crear Item</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path == '/order' %} active{% endif %}" href="/order">Pedido</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path == '/about' %} active{% endif %}" href="/about">Acerca de</a></li>
                        <li class="nav-item"><a class="nav-link{% if request.path == '/contact' %} active{% endif %}" href="/contact">Contacto</a></li>
                    </ul>
                    <ul class="navbar-nav ms-auto">
                        {% if current_user.is_authenticated %}
                        <!-- Menú Desplegable para Usuarios Autenticados -->
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" 
                                data-bs-toggle="dropdown" aria-expanded="false">
                                {{ current_user.username }}
                                <i class="bi bi-person-circle ms-1"></i>
                            </a>
                            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                                <li><a class="dropdown-item" href="{{ url_for('profile') }}">Perfil</a></li>
                                <li><hr class="dropdown-divider"></li>
                                <li><a class="dropdown-item" href="{{ url_for('main.logout') }}">Cerrar Sesión</a></li>
                            </ul>
                        </li>
                        {% else %}
                        <!-- Botón "Iniciar Sesión" para Usuarios No Autenticados -->
                        <li class="nav-item">
                            <a href="{{ url_for('main.login') }}" class="btn btn-primary">
                                <i class="fa-solid fa-right-to-bracket me-2"></i> Iniciar Sesión
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </nav>

        <!-- Espacio para evitar que el contenido quede oculto bajo la barra de navegación -->
        <div style="margin-top: 90px;"></div>

        <!-- Contenido Principal -->
        <div class="container mt-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="row justify-content-center">
                <div class="col-md-8">
                    {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            {% endwith %}

            {% block content %}{% endblock %}
        </div>

        <!-- Footer -->
        {% include 'footer.html' %}

        <!-- Bootstrap JS y dependencias -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        <!-- JS Personalizado -->
        <script src="{{ url_for('static', filename='js/script.js') }}"></script>

        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const videos = [
                    "{{ url_for('static', filename='videos/longvideo.mp4') }}"
                ];
                let videoIndex = 0;
                const videoElement = document.getElementById('hero-video');
                const sourceElement = videoElement ? videoElement.getElementsByTagName('source')[0] : null;

                function playNextVideo() {
                    if (sourceElement) {
                        sourceElement.src = videos[videoIndex];
                        videoElement.load(); // Recargar el video con la nueva fuente
                        videoElement.play(); // Intentar reproducir el video
                        videoIndex = (videoIndex + 1) % videos.length;
                    }
                }

                if (videoElement && sourceElement) { // Verifica si el elemento existe
                    videoElement.addEventListener('ended', function () {
                        playNextVideo();
                    });
                }
            });
        </script>
        
        {% block scripts %}{% endblock %}
    </body>
    </html>

<!-- templates/footer.html -->

<!-- Footer -->
<footer class="bg-light text-center text-md-start py-4 mt-5">
    <div class="container d-flex justify-content-between align-items-center">
        <div>&copy; 2024 Pulztag. Todos los derechos reservados.</div>
        <div>
            <a href="https://www.instagram.com/pulztag" target="_blank" class="text-dark me-3" aria-label="Instagram">
                <i class="fa-brands fa-instagram fa-fade fa-2x" style="color: #ed719e;"></i>
            </a>
            <a href="https://wa.me/56962411963" target="_blank" class="text-dark" aria-label="WhatsApp">
                <i class="fa-brands fa-whatsapp fa-shake fa-2x" style="color: #63E6BE"></i>
            </a>
        </div>
    </div>
</footer>

<!-- templates/head.html -->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}Pulztag{% endblock %}</title>

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;700&family=Roboto:wght@400;500&display=swap" rel="stylesheet">

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Icons -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<!-- CSS Personalizado con Parámetro de Versión para Evitar Caché -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}?v=1.0">

{% block head %}{% endblock %}

<!-- templates/navbar.html -->

<!-- Logo de la Navbar alineado a la izquierda -->
<a class="navbar-brand text-primary fw-bold d-flex align-items-center" href="/">
    <img src="{{ url_for('static', filename='images/logov3.png') }}" alt="Pulztag Logo" height="40" class="me-2">
</a>

<!-- Botón de navegación móvil -->
<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
    aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
</button>

<!-- Enlaces de Navegación centrados -->
<div class="collapse navbar-collapse" id="navbarNav">
    <ul class="navbar-nav mx-auto">
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/' %} active{% endif %}" href="/">Inicio</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/products' %} active{% endif %}" href="{{ url_for('products') }}">Productos</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/services' %} active{% endif %}" href="{{ url_for('services') }}">Servicios</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path.startswith('/create_item') %} active{% endif %}" href="{{ url_for('create_item') }}">Crear Item</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/order' %} active{% endif %}" href="/order">Pedido</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/about' %} active{% endif %}" href="/about">Acerca de</a>
        </li>
        <li class="nav-item">
            <a class="nav-link{% if request.path == '/contact' %} active{% endif %}" href="/contact">Contacto</a>
        </li>
    </ul>
    
    <!-- Menú desplegable alineado a la derecha -->
    <ul class="navbar-nav ms-auto">
        <li class="nav-item dropdown">
            {% if current_user.is_authenticated %}
            <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                {{ current_user.username }}
                <i class="bi bi-person-circle ms-1"></i> <!-- Icono de usuario -->
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDropdown">
                <li><a class="dropdown-item" href="{{ url_for('profile') }}">Perfil</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="{{ url_for('main.logout') }}">Cerrar Sesión</a></li>
            </ul>
            {% else %}
            <a class="nav-link dropdown-toggle" href="#" id="authDropdown" role="button" data-bs-toggle="dropdown"
                aria-expanded="false">
                Mi Cuenta
                <i class="bi bi-lock-fill ms-1"></i> <!-- Icono de cuenta -->
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="authDropdown">
                <li><a class="dropdown-item" href="{{ url_for('main.login') }}">Iniciar Sesión</a></li>
                <li><a class="dropdown-item" href="{{ url_for('register') }}">Crear Cuenta</a></li>
            </ul>
            {% endif %}
        </li>
    </ul>
</div>



<!-- templates/profile.html -->

{% extends 'base.html' %}

{% block title %}Perfil de Usuario - PulztagWeb{% endblock %}

{% block content %}
<h2 class="text-center mb-4">Mi Perfil</h2>

<!-- Información del Usuario -->
<div class="container-fluid mb-5">
    <div class="row">
        <div class="col-md-6">
            <h4>Información Personal</h4>
            <p><strong>Nombre de Usuario:</strong> {{ current_user.username }}</p>
            <p><strong>Correo Electrónico:</strong> {{ current_user.email }}</p>
        </div>
        <div class="col-md-6 text-end">
            <a href="{{ url_for('main.account') }}" class="btn btn-primary">Editar Perfil</a>
        </div>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<!-- Lista de Pulzcards -->
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <h4>Tus Pulzcards</h4>
            {% if pulzcards %}
                <div class="table-responsive">
                    <table class="table table-hover custom-table">
                        <thead>
                            <tr>
                                <th>Nombre Tarjeta</th>
                                <th>Nombre Completo</th>
                                <th>Organización</th>
                                <th>Email</th>
                                <th>Fecha de Creación</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for card in pulzcards %}
                            <tr>
                                <td>{{ card.card_name }}</td>
                                <td>{{ card.first_name }} {{ card.last_name }}</td>
                                <td>{{ card.organization }}</td>
                                <td>{{ card.email }}</td>
                                <td>{{ card.created_at.strftime('%d/%m/%Y %H:%M') }}</td>
                                <td>
                                    <!-- Botones de acción para pantallas medianas y grandes -->
                                    <div class="d-none d-md-flex gap-2">
                                        <a href="{{ url_for('pulzcard_card', card_id=card.card_id) }}" class="btn btn-outline-secondary btn-sm" target="_blank">Ver</a>
                                        <a href="{{ url_for('edit_pulzcard', card_id=card.card_id) }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                                        <a href="{{ url_for('pulzcard_qrcode', card_id=card.card_id) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                                            <i class="fa-solid fa-qrcode"></i>
                                        </a>
                                        <form action="{{ url_for('delete_pulzcard', card_id=card.card_id) }}" method="POST" style="display:inline;">
                                            {{ delete_forms[card.id].hidden_tag() }}
                                            <button type="submit" onclick="return confirm('¿Estás seguro de que deseas eliminar esta Pulzcard? Esta acción no se puede deshacer.')" style="background:none; border:none; padding:0; cursor:pointer;">
                                                <i class="fa-regular fa-eraser" style="color: rgb(252, 127, 156); font-size: 2.0em;"></i>
                                            </button>
                                        </form>
                                    </div>
                                    
                                    <!-- Dropdown para pantallas pequeñas -->
                                    <div class="d-md-none">
                                        <div class="dropdown">
                                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButton{{ card.card_id }}" data-bs-toggle="dropdown" aria-expanded="false">
                                                Acciones
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton{{ card.card_id }}">
                                                <li><a class="dropdown-item" href="{{ url_for('pulzcard_card', card_id=card.card_id) }}" target="_blank"><i class="fas fa-eye me-2"></i>Ver
                                                <li><a class="dropdown-item" href="{{ url_for('edit_pulzcard', card_id=card.card_id) }}"><i class="fas fa-edit me-2"></i>Editar
                                                <li><a class="dropdown-item" href="{{ url_for('pulzcard_qrcode', card_id=card.card_id) }}" title="Ver Código QR"><i class="fas fa-qrcode me-2"></i>Ver QR</a></li>
                                                <li>
                                                    <form action="{{ url_for('delete_pulzcard', card_id=card.card_id) }}" method="POST" style="display:inline;">
                                                        {{ delete_forms[card.id].hidden_tag() }}
                                                        <button type="submit" 
                                                                onclick="return confirm('¿Estás seguro de que deseas eliminar esta Pulzcard? Esta acción no se puede deshacer.')"
                                                                class="dropdown-item bg-danger text-white">
                                                            <i class="fa-regular fa-eraser me-2"></i>Eliminar
                                                        </button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>No has creado ninguna Pulzcard aún. <a href="{{ url_for('pulzcard') }}">Crear una Pulzcard</a>.</p>
            {% endif %}
            
            <!-- Hipervínculo para Crear una Nueva Pulzcard -->
            <div class="mt-3">
                <a href="{{ url_for('pulzcard') }}" class="btn btn-secondary">
                    <i class="fas fa-user-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i>Añadir
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<!-- Lista de Etiquetas -->
<div class="container-fluid">
    <div class="row">
        <div class="col-12 mt-5">
            <h4>Tus Etiquetas y QR Code</h4>
            {% if tags %}
                <div class="table-responsive">
                    <table class="table table-hover custom-table">
                        <thead>
                            <tr>
                                <th>Nombre Etiqueta</th>
                                <th>URL destino</th>
                                <th>URL enlace</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for tag in tags %}
                            <tr>
                                <td>{{ tag.tag_name }}</td>
                                <td>
                                    {% set redirect_url_display = tag.redirect_url[:30] + '...' if tag.redirect_url|length > 30 else tag.redirect_url %}
                                    <a href="{{ tag.redirect_url }}" target="_blank">{{ redirect_url_display }}</a>
                                </td>
                                <td>
                                    {% set generated_url = url_for('redirect_tag', tag_id=tag.tag_id, _external=True) %}
                                    {% set shortened_url = generated_url[:30] + '...' if generated_url|length > 30 else generated_url %}
                                    <a href="{{ generated_url }}" target="_blank">{{ shortened_url }}</a>
                                </td>
                                <td>
                                    <!-- Botones de acción para pantallas medianas y grandes -->
                                    <div class="d-none d-md-flex gap-2">
                                        <button class="btn btn-outline-secondary btn-sm" onclick="copyURL('{{ generated_url }}')">Copiar</button>
                                        <a href="{{ url_for('edit_tag', tag_id=tag.tag_id) }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                                        <a href="{{ url_for('tag_qrcode', tag_id=tag.tag_id) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                                            <i class="fas fa-qrcode"></i>
                                        </a>
                                        <form action="{{ url_for('delete_tag', tag_id=tag.tag_id) }}" method="POST" style="display:inline;">
                                            {{ delete_tag_forms[tag.id].hidden_tag() }}
                                            <button type="submit" onclick="return confirm('¿Estás seguro de que deseas eliminar esta etiqueta? Esta acción no se puede deshacer.')" style="background:none; border:none; padding:0; cursor:pointer;">
                                                <i class="fa-regular fa-eraser" style="color: rgb(252, 127, 156); font-size: 2.0em;"></i>
                                            </button>
                                        </form>
                                    </div>
                                    
                                    <!-- Dropdown para pantallas pequeñas -->
                                    <div class="d-md-none">
                                        <div class="dropdown">
                                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButtonTag{{ tag.tag_id }}" data-bs-toggle="dropdown" aria-expanded="false">
                                                Acciones
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonTag{{ tag.tag_id }}">
                                                <li>
                                                    <a href="#" class="dropdown-item" onclick="copyURL('{{ generated_url }}'); return false;">
                                                        <i class="fas fa-copy me-2"></i>Copiar URL
                                                    </a>
                                                </li>
                                                <li>
                                                    <a class="dropdown-item" href="{{ url_for('edit_tag', tag_id=tag.tag_id) }}">
                                                        <i class="fas fa-edit me-2"></i>Editar
                                                    </a>
                                                </li>
                                                <li>
                                                    <a class="dropdown-item" href="{{ url_for('tag_qrcode', tag_id=tag.tag_id) }}" title="Ver Código QR">
                                                        <i class="fas fa-qrcode me-2"></i>Ver QR
                                                    </a>
                                                </li>
                                                <li>
                                                    <form action="{{ url_for('delete_tag', tag_id=tag.tag_id) }}" method="POST" style="display:inline;">
                                                        {{ delete_tag_forms[tag.id].hidden_tag() }}
                                                        <button type="submit" 
                                                                onclick="return confirm('¿Estás seguro de que deseas eliminar esta etiqueta? Esta acción no se puede deshacer.')"
                                                                class="dropdown-item bg-danger text-white">
                                                            <i class="fa-regular fa-eraser me-2"></i>Eliminar
                                                        </button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>No has creado ninguna etiqueta aún. <a href="#" class="text-decoration-underline" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal">Crear una Etiqueta</a>.</p>        
            {% endif %}
            
            <!-- Botón para Agregar una Nueva Etiqueta -->
            <div class="mt-3">
                <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#agregarEtiquetaModal">
                    <i class="fa-regular fa-square-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i> Añadir
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Línea de Separación -->
<hr class="my-5">

<!-- Formulario para agregar una nueva Etiqueta dentro de una Modal -->
<!-- Modal -->
<div class="modal fade" id="agregarEtiquetaModal" tabindex="-1" aria-labelledby="agregarEtiquetaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('profile') }}">
          {{ tag_form.hidden_tag() }}
          <div class="modal-header">
            <h5 class="modal-title" id="agregarEtiquetaModalLabel">Agregar Nueva Etiqueta</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
              <div class="mb-3">
                  {{ tag_form.tag_name.label(class="form-label") }}
                  {{ tag_form.tag_name(class="form-control", placeholder="Nombre de Tu Etiqueta") }}
                  {% for error in tag_form.tag_name.errors %}
                      <div class="text-danger">{{ error }}</div>
                  {% endfor %}
              </div>
              <div class="mb-3">
                  {{ tag_form.redirect_url.label(class="form-label") }}
                  {{ tag_form.redirect_url(class="form-control", placeholder="URL a redireccionar") }}
                  {% for error in tag_form.redirect_url.errors %}
                      <div class="text-danger">{{ error }}</div>
                  {% endfor %}
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            {{ tag_form.submit(class="btn btn-success") }}
          </div>
      </form>
    </div>
  </div>
</div>

<!-- Lista de Bodegas -->
<div class="container-fluid">
    <div class="row">
        <div class="col-12 mt-5">
            <h4>Bodegas</h4>
            {% if bodegas %}
                <div class="table-responsive">
                    <table class="table table-hover custom-table">
                        <thead>
                            <tr>
                                <th>ID Bodega</th>
                                <th>Nombre</th>
                                <th>Fecha de Creación</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for bodega in bodegas %}
                            <tr>
                                <td><a href="{{ url_for('view_bodega', uuid_bodega=bodega.uuid) }}">{{ bodega.id_bodega }}</a></td>
                                <td>{{ bodega.nombre }}</td>
                                <td>{{ bodega.fecha_creacion.strftime('%d/%m/%Y %H:%M') }}</td>
                                <td>
                                    <!-- Botones de acción para pantallas medianas y grandes -->
                                    <div class="d-none d-md-flex gap-2">
                                        <!-- Botón QR Code -->
                                        <a href="{{ url_for('bodega_qrcode', uuid_bodega=bodega.uuid) }}" class="btn btn-outline-secondary btn-sm" title="Ver Código QR">
                                            <i class="fas fa-qrcode"></i>
                                        </a>
                                        <a href="{{ url_for('edit_bodega', uuid_bodega=bodega.uuid) }}" class="btn btn-outline-secondary btn-sm">Editar</a>
                                        <form action="{{ url_for('delete_bodega', uuid_bodega=bodega.uuid) }}" method="POST" style="display:inline;">
                                            {{ delete_bodega_forms[bodega.uuid].hidden_tag() }}
                                            <button type="submit" onclick="return confirm('¿Estás seguro de que deseas eliminar esta bodega? Esta acción no se puede deshacer.')" style="background:none; border:none; padding:0; cursor:pointer;">
                                                <i class="fa-regular fa-eraser" style="color: rgb(252, 127, 156); font-size: 2.0em;"></i>
                                            </button>
                                        </form>
                                    </div>
                                    <!-- Dropdown para pantallas pequeñas -->
                                    <div class="d-md-none">
                                        <div class="dropdown">
                                            <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" id="dropdownMenuButtonBodega{{ bodega.uuid }}" data-bs-toggle="dropdown" aria-expanded="false">
                                                Acciones
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="dropdownMenuButtonBodega{{ bodega.uuid }}">
                                                <li>
                                                    <a class="dropdown-item" href="{{ url_for('bodega_qrcode', uuid_bodega=bodega.uuid) }}" title="Ver Código QR">
                                                        <i class="fas fa-qrcode me-2"></i>Ver QR
                                                    </a>
                                                </li>
                                                <li>
                                                    <a class="dropdown-item" href="{{ url_for('edit_bodega', uuid_bodega=bodega.uuid) }}">
                                                        <i class="fas fa-edit me-2"></i>Editar
                                                    </a>
                                                </li>
                                                <li>
                                                    <form action="{{ url_for('delete_bodega', uuid_bodega=bodega.uuid) }}" method="POST" style="display:inline;">
                                                        {{ delete_bodega_forms[bodega.uuid].hidden_tag() }}
                                                        <button type="submit" 
                                                                onclick="return confirm('¿Estás seguro de que deseas eliminar esta bodega? Esta acción no se puede deshacer.')"
                                                                class="dropdown-item bg-danger text-white">
                                                            <i class="fa-regular fa-eraser me-2"></i>Eliminar
                                                        </button>
                                                    </form>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            {% else %}
                <p>No has creado ninguna bodega aún. <a href="#" class="text-decoration-underline" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal">Crear una Bodega</a>.</p>        
            {% endif %}
            
            <!-- Botón para Agregar una Nueva Bodega -->
            <div class="mt-3">
                <button type="button" class="btn btn-secondary" data-bs-toggle="modal" data-bs-target="#agregarBodegaModal">
                    <i class="fa-regular fa-square-plus" style="color: rgb(104, 245, 167); font-size: 1.0em;"></i> Añadir
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para agregar una nueva Bodega -->
<div class="modal fade" id="agregarBodegaModal" tabindex="-1" aria-labelledby="agregarBodegaModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="POST" action="{{ url_for('create_bodega') }}">
          {{ bodega_form.hidden_tag() }}
          <div class="modal-header">
            <h5 class="modal-title" id="agregarBodegaModalLabel">Agregar Nueva Bodega</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
          </div>
          <div class="modal-body">
              <div class="mb-3">
                  {{ bodega_form.nombre.label(class="form-label") }}
                  {{ bodega_form.nombre(class="form-control", placeholder="Nombre de la Bodega") }}
                  {% for error in bodega_form.nombre.errors %}
                      <div class="text-danger">{{ error }}</div>
                  {% endfor %}
              </div>
              <div class="mb-3">
                  {{ bodega_form.ubicacion.label(class="form-label") }}
                  {{ bodega_form.ubicacion(class="form-control", placeholder="Ubicación") }}
                  {% for error in bodega_form.ubicacion.errors %}
                      <div class="text-danger">{{ error }}</div>
                  {% endfor %}
              </div>
              <div class="mb-3">
                  {{ bodega_form.notas.label(class="form-label") }}
                  {{ bodega_form.notas(class="form-control", placeholder="Notas") }}
                  {% for error in bodega_form.notas.errors %}
                      <div class="text-danger">{{ error }}</div>
                  {% endfor %}
              </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
            {{ bodega_form.submit(class="btn btn-success") }}
          </div>
      </form>
    </div>
  </div>
</div>


<!-- Abrir la modal automáticamente si hay errores en el formulario -->
{% if bodega_form.errors %}
    <script>
        var agregarBodegaModal = new bootstrap.Modal(document.getElementById('agregarBodegaModal'));
        agregarBodegaModal.show();
    </script>
{% endif %}

<!-- Script for copying URL to clipboard -->
<script>
    function copyURL(url) {
        navigator.clipboard.writeText(url).then(() => {
            showAlert('URL generada copiada al portapapeles!', 'success');
        }).catch(err => {
            showAlert('Error al copiar la URL: ' + err, 'danger');
        });
    }

    function showAlert(message, type) {
        const alertPlaceholder = document.createElement('div');
        alertPlaceholder.innerHTML = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        document.body.appendChild(alertPlaceholder);
        setTimeout(() => {
            alertPlaceholder.remove();
        }, 3000);
    }

    // Opcional: Abrir la modal automáticamente si hay errores en el formulario
    {% if tag_form.errors %}
        var agregarEtiquetaModal = new bootstrap.Modal(document.getElementById('agregarEtiquetaModal'));
        agregarEtiquetaModal.show();
    {% endif %}
</script>
{% endblock %}


----- Fin de templates/sidebar.html -----

----- Inicio de templates/smartcontent_options.html -----
<!-- templates/smartcontent_options.html -->

{% extends 'base.html' %}

{% block title %}Opciones de Contenido{% endblock %}

{% block content %}
<div class="container mt-5">
    <h2 class="text-center mb-4">Selecciona una Opción</h2>
    <form method="GET" action="{{ url_for('smartcontent_redirect') }}">
        <div class="mb-3">
            <select class="form-select" name="option_id" required>
                {% for option in options %}
                    <option value="{{ option.option_id }}">{{ option.option_title }}</option>
                {% endfor %}
            </select>
        </div>
        <button type="submit" class="btn btn-primary">Aceptar</button>
    </form>
</div>
{% endblock %}

----- Fin de templates/smartcontent_options.html -----

----- Inicio de templates/survey_comment.html -----
{% extends "base.html" %}

{% block title %}Comentarios de la Encuesta{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>Comentarios para el ítem: {{ item.name }}</h2>
    <hr>
    {% if responses %}
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Fecha</th>
                    <th>Valoración</th>
                    <th>Comentario</th>
                </tr>
            </thead>
            <tbody>
                {% for resp in responses %}
                <tr>
                    <td>{{ resp.timestamp.strftime('%Y-%m-%d %H:%M') }}</td>
                    <td>{{ resp.rating }}</td>
                    <td>{{ resp.comment or '' }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    {% else %}
        <p>No se han registrado comentarios para este ítem.</p>
    {% endif %}
</div>
{% endblock %}

----- Fin de templates/survey_comment.html -----

----- Inicio de templates/survey_error.html -----
{% extends "base.html" %}

{% block title %}
Error en la Encuesta
{% endblock %}

{% block head %}
<style>
  body {
      background-color: #f8f9fa;
      background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #333333;
      min-height: 100vh; 
      display: flex;
      flex-direction: column;
  }

  .error-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-width: 600px;
      width: 100%;
      margin: 40px auto;
      padding: 2rem;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .error-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.3);
  }

  .error-card h1 {
      font-size: 1.8rem;
      color: #c0392b;
      margin-bottom: 1rem;
  }
  .error-card p {
      font-size: 1.1rem;
      color: #555;
  }
</style>
{% endblock %}

{% block content %}

<div class="error-card mt-4">
  <h1>Encuesta no disponible</h1>
  <p>{{ message }}</p>
</div>
{% endblock %}

----- Fin de templates/survey_error.html -----

----- Inicio de templates/survey_thanks.html -----
{% extends "base.html" %}

{% block title %}
¡Gracias por tu evaluación!
{% endblock %}

{% block head %}
<style>
  /* Mismo fondo que en qrcode_card */
  body {
      background-color: #f8f9fa;
      background-image: url('{{ url_for("static", filename="images/fondo_card3.jpg") }}');
      background-size: cover;
      background-position: center;
      background-repeat: no-repeat;
      color: #333333;
      min-height: 100vh; 
      display: flex;
      flex-direction: column;
  }

  .thanks-card {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 10px;
      box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
      max-width: 600px;
      width: 100%;
      margin: 40px auto; /* Espacio arriba/abajo */
      padding: 2rem;
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .thanks-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 16px 32px rgba(0, 0, 0, 0.3);
  }

  .thanks-card h1 {
      font-size: 2rem;
      color: #333;
      margin-bottom: 1rem;
  }
  .thanks-card p {
      font-size: 1.1rem;
      color: #555;
      line-height: 1.4;
  }
</style>
{% endblock %}

{% block content %}
<!-- Logo o cabecera -->

<div class="thanks-card mt-4">
  {% if rating <= 6 %}
    <h1>¡Lo sentimos mucho!</h1>
    <p>
      Lamentamos no haber cumplido tus expectativas.  
      Agradecemos enormemente tu opinión y haremos lo posible por mejorar.  
      Si deseas darnos más detalles, contáctanos directamente.
    </p>
  {% elif rating <= 8 %}
    <h1>¡Gracias por tu opinión!</h1>
    <p>
      Sabemos que aún podemos mejorar, y tu feedback nos ayudará a hacerlo.  
      Gracias por confiar en nosotros y esperamos llegar a sorprenderte
      en el futuro.
    </p>
  {% else %}
    <h1>¡Excelente!</h1>
    <p>
      ¡Nos alegra mucho saber que has tenido una gran experiencia!  
      Tu evaluación positiva nos motiva a seguir mejorando cada día.  
      Muchas gracias por recomendarnos.
    </p>
  {% endif %}
</div>
{% endblock %}

----- Fin de templates/survey_thanks.html -----

----- Inicio de templates/users.html -----
<ul>
    {% for user in users %}
        <li>{{ user.username }} - {{ user.email }}</li>
    {% endfor %}
</ul>

----- Fin de templates/users.html -----

----- Inicio de templates/video_base.html -----
<!-- templates/video_base.html -->

<!DOCTYPE html>
<html lang="es">

<head>
    {% include 'head.html' %}
    {% block head %}{% endblock %}
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.1/css/all.min.css" integrity="sha512-5Hs3dF2AEPkpNAR7UiOHba+lRSJNeM2ECkwxUIxC1Q/FLycGTbNapWXB4tP889k5T5Ju8fs4b1P5z/iB4nMfSQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NC88XS28"
            height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->

    <!-- Barra Superior -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm fixed-top">
        <div class="container-fluid">
            {% include 'navbar.html' %}
        </div>
    </nav>

    <!-- Mensajes Flash con posicionamiento fijo -->
    <div id="flash-messages" style="position: fixed; top: 70px; left: 0; right: 0; z-index: 1000;">
        <div class="container mt-4">
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="row justify-content-center">
                <div class="col-md-8">
                    {% for category, message in messages %}
                    <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
            {% endwith %}
        </div>
    </div>

    <!-- Video Background Section -->
    <section class="hero-section position-relative overflow-hidden" style="margin-top: 50px;">
        <!-- Contenedor para el video -->
        <div class="video-container">
            <video id="hero-video" autoplay muted playsinline preload="auto" class="hero-video-bg">
                <source src="{{ url_for('static', filename='videos/longvideo.mp4') }}" type="video/mp4">
                Tu navegador no soporta videos HTML5. Por favor, actualiza a un navegador moderno.
            </video>
        </div>
        <!-- Overlay para mejorar la legibilidad del texto -->
        <div class="overlay"></div>
        <!-- Contenido Principal -->
        <div class="container-fluid position-relative z-index-2 px-0">
            <div class="row align-items-center min-vh-100 mx-0">
                {% block content %}{% endblock %}
            </div>
        </div>
    </section>

    <!-- Footer -->
    {% include 'footer.html' %}

    <!-- Bootstrap JS y dependencias -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JS Personalizado -->
    <script src="{{ url_for('static', filename='js/script.js') }}"></script>

    {% block scripts %}{% endblock %}
</body>
<style>
    @media (max-width: 768px) {
        /* Oculta el contenedor del video */
        .video-container {
        display: none;
        }
        
        /* Muestra la imagen como fondo en la sección hero */
        .hero-section {
        background: url("{{ url_for('static', filename='images/bg_image1.jpg') }}") center center no-repeat;
        background-size: cover;
        }
    }
</style>


</html>

----- Fin de templates/video_base.html -----

----- Inicio de routes/__init__.py -----
# routes/__init__.py
# Indica que 'routes' es un paquete Python.

----- Fin de routes/__init__.py -----

----- Inicio de routes/auth_routes.py -----
# routes/auth_routes.py

from flask import (
    Blueprint, render_template, request, flash, redirect, url_for
)
from flask_login import login_required, current_user, login_user, logout_user
from werkzeug.utils import secure_filename
from flask_mail import Message

# Importa extensiones y modelos que necesites 
# (puedes importarlos de 'extensions.py' y 'models.py')
from extensions import db, bcrypt, mail
from models import User

# Importa los formularios de autenticación 
# (RegistrationForm, LoginForm, etc.) desde tu forms.py
from forms import (
    RegistrationForm, LoginForm, ResetPasswordForm, 
    RequestResetForm, UpdateAccountForm
    # y los que ocupes para la cuenta
)

# Creamos el Blueprint. Aquí lo llamamos 'main_bp',
# tal como tú indicas que lo vas a importar en app.py
main_bp = Blueprint('main', __name__)

# ============== Rutas de Autenticación ============= #

@main_bp.route('/register', methods=['GET', 'POST'])
def register():
    if current_user.is_authenticated:
        flash('Ya estás logueado.', 'info')
        return redirect(url_for('home'))  # Ajustar destino si tu home está en otro blueprint
    form = RegistrationForm()
    if form.validate_on_submit():
        # Crear el usuario sin contraseña
        user = User(username=form.username.data, email=form.email.data,
                    is_admin=False, must_change_password=True)
        db.session.add(user)
        db.session.commit()

        # Generar token de reseteo
        token = user.get_reset_token()

        # Enviar correo con enlace
        try:
            msg = Message(
                'Configura tu Contraseña en PulztagWeb',
                recipients=[user.email]
            )
            reset_url = url_for('main.reset_token', token=token, _external=True)
            msg.body = f'''Hola {user.username},

Gracias por registrarte en PulztagWeb. Por favor, haz clic en el siguiente enlace para establecer tu contraseña:

{reset_url}

Si no solicitaste este registro, por favor ignora este correo.

Saludos,
Equipo de PulztagWeb
'''
            mail.send(msg)
            flash('Cuenta creada. Revisa tu correo para establecer tu contraseña.', 'success')
        except Exception as e:
            print(f"Error al enviar el correo: {e}")
            flash('Hubo un error al enviar el correo. Por favor, contacta al soporte.', 'danger')

        return redirect(url_for('main.login'))
    return render_template('register.html', title='Registrar', form=form)


@main_bp.route('/login', methods=['GET', 'POST'])
def login():
    if current_user.is_authenticated:
        flash('Ya estás logueado.', 'info')
        return redirect(url_for('profile') + '#miPerfilSection')
    form = LoginForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()
        if user and user.password and bcrypt.check_password_hash(user.password, form.password.data):
            login_user(user, remember=form.remember.data)
            if user.must_change_password:
                flash('Por favor, establece una nueva contraseña.', 'warning')
                return redirect(url_for('main.change_password'))
            flash('Has iniciado sesión correctamente.', 'success')
            return redirect(url_for('profile') + '#miPerfilSection')
        else:
            flash('Inicio de sesión fallido. Revisa el correo y la contraseña.', 'danger')
    return render_template('login.html', title='Iniciar Sesión', form=form)


@main_bp.route('/logout')
def logout():
    logout_user()
    flash('Has cerrado sesión.', 'info')
    return redirect(url_for('home'))  # Ajustar según dónde esté tu ruta home


@main_bp.route('/change_password', methods=['GET', 'POST'])
@login_required
def change_password():
    form = ResetPasswordForm()
    if form.validate_on_submit():
        hashed_password = bcrypt.generate_password_hash(form.password.data).decode('utf-8')
        current_user.password = hashed_password
        current_user.must_change_password = False
        db.session.commit()
        flash('Tu contraseña ha sido actualizada.', 'success')
        return redirect(url_for('home'))
    return render_template('change_password.html', title='Cambiar Contraseña', form=form)


@main_bp.route('/account', methods=['GET', 'POST'])
@login_required
def account():
    form = UpdateAccountForm()
    if form.validate_on_submit():
        if not bcrypt.check_password_hash(current_user.password, form.current_password.data):
            flash('La contraseña actual es incorrecta.', 'danger')
            form.username.data = current_user.username
            return render_template('account.html', title='Perfil de Usuario', form=form)
        
        current_user.username = form.username.data
        if form.password.data:
            hashed_password = bcrypt.generate_password_hash(form.password.data).decode('utf-8')
            current_user.password = hashed_password

        db.session.commit()
        flash('Tu cuenta ha sido actualizada.', 'success')
        return redirect(url_for('profile') + '#miPerfilSection')
    else:
        form.username.data = current_user.username

    return render_template('account.html', title='Perfil de Usuario', form=form, email=current_user.email)


@main_bp.route('/reset_password', methods=['GET', 'POST'])
def reset_request():
    if current_user.is_authenticated:
        flash('Ya estás logueado.', 'info')
        return redirect(url_for('home'))
    form = RequestResetForm()
    if form.validate_on_submit():
        user = User.query.filter_by(email=form.email.data).first()
        if user:
            token = user.get_reset_token()
            msg = Message('Recupera tu Contraseña', recipients=[user.email])
            reset_url = url_for('main.reset_token', token=token, _external=True)
            msg.body = f'''Para restablecer tu contraseña, visita el siguiente enlace:
{reset_url}

Si no solicitaste un restablecimiento de contraseña, ignora este mensaje.
'''
            mail.send(msg)
            flash('Se ha enviado un correo para restablecer tu contraseña.', 'info')
            return redirect(url_for('main.login'))
    return render_template('reset_request.html', title='Recuperar Contraseña', form=form)


@main_bp.route('/reset_password/<token>', methods=['GET', 'POST'])
def reset_token(token):
    if current_user.is_authenticated:
        flash('Ya estás logueado.', 'info')
        return redirect(url_for('home'))
    user = User.verify_reset_token(token)
    if not user:
        flash('El token es inválido o ha expirado.', 'warning')
        return redirect(url_for('main.reset_request'))
    form = ResetPasswordForm()
    if form.validate_on_submit():
        hashed_password = bcrypt.generate_password_hash(form.password.data).decode('utf-8')
        user.password = hashed_password
        user.must_change_password = False
        db.session.commit()
        flash('Tu contraseña ha sido actualizada. Ahora puedes iniciar sesión.', 'success')
        return redirect(url_for('main.login'))
    return render_template('reset_token.html', title='Establecer Contraseña', form=form, token=token)

----- Fin de routes/auth_routes.py -----

----- Inicio de test_mail.py -----


----- Fin de test_mail.py -----

----- Inicio de migrations/versions/d06faea1c24e_initial_migration.py -----
"""Initial migration.

Revision ID: d06faea1c24e
Revises: 
Create Date: 2025-01-20 17:57:23.289866

"""
from alembic import op
import sqlalchemy as sa


# revision identifiers, used by Alembic.
revision = 'd06faea1c24e'
down_revision = None
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('users',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('username', sa.String(length=150), nullable=False),
    sa.Column('email', sa.String(length=120), nullable=False),
    sa.Column('password', sa.String(length=60), nullable=True),
    sa.Column('is_admin', sa.Boolean(), nullable=True),
    sa.Column('is_verified', sa.Boolean(), nullable=True),
    sa.Column('must_change_password', sa.Boolean(), nullable=True),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('email'),
    sa.UniqueConstraint('username')
    )
    op.create_table('bodegas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('id_bodega', sa.String(length=10), nullable=False),
    sa.Column('nombre', sa.String(length=255), nullable=False),
    sa.Column('ubicacion', sa.String(length=255), nullable=True),
    sa.Column('notas', sa.Text(), nullable=True),
    sa.Column('fecha_creacion', sa.DateTime(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('uuid', sa.String(length=36), nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id_bodega'),
    sa.UniqueConstraint('uuid')
    )
    op.create_table('dashboard_items',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('uuid', sa.UUID(), nullable=False),
    sa.Column('name', sa.String(length=100), nullable=False),
    sa.Column('item_type', sa.String(length=50), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('uuid')
    )
    op.create_table('pulzcards',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('card_name', sa.String(length=100), nullable=False),
    sa.Column('first_name', sa.String(length=50), nullable=False),
    sa.Column('last_name', sa.String(length=50), nullable=False),
    sa.Column('organization', sa.String(length=100), nullable=False),
    sa.Column('position', sa.String(length=100), nullable=False),
    sa.Column('phone', sa.String(length=20), nullable=False),
    sa.Column('email', sa.String(length=120), nullable=False),
    sa.Column('website', sa.String(length=200), nullable=False),
    sa.Column('address', sa.String(length=200), nullable=False),
    sa.Column('card_id', sa.String(length=36), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('image_file', sa.String(length=100), nullable=True),
    sa.Column('template', sa.String(length=20), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('card_id')
    )
    op.create_table('tags',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('tag_name', sa.String(length=100), nullable=False),
    sa.Column('redirect_url', sa.String(length=200), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=False),
    sa.Column('tag_id', sa.String(length=36), nullable=False),
    sa.Column('vistas', sa.Integer(), nullable=False),
    sa.Column('user_id', sa.Integer(), nullable=False),
    sa.ForeignKeyConstraint(['user_id'], ['users.id'], ),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('tag_id')
    )
    op.create_table('cajas',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('id_caja', sa.String(length=10), nullable=False),
    sa.Column('nombre', sa.String(length=255), nullable=False),
    sa.Column('categoria', sa.String(length=255), nullable=True),
    sa.Column('notas', sa.Text(), nullable=True),
    sa.Column('fecha_creacion', sa.DateTime(), nullable=False),
    sa.Column('bodega_id', sa.Integer(), nullable=False),
    sa.Column('uuid', sa.String(length=36), nullable=False),
    sa.ForeignKeyConstraint(['bodega_id'], ['bodegas.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('id_caja'),
    sa.UniqueConstraint('uuid')
    )
    op.create_table('survey_responses',
    sa.Column('id', sa.Integer(), autoincrement=True, nullable=False),
    sa.Column('item_id', sa.Integer(), nullable=False),
    sa.Column('rating', sa.Integer(), nullable=False),
    sa.Column('comment', sa.String(length=500), nullable=True),
    sa.Column('timestamp', sa.DateTime(), nullable=False),
    sa.ForeignKeyConstraint(['item_id'], ['dashboard_items.id'], ),
    sa.PrimaryKeyConstraint('id')
    )
    op.create_table('productos',
    sa.Column('id', sa.Integer(), nullable=False),
    sa.Column('id_producto', sa.String(length=10), nullable=False),
    sa.Column('nombre', sa.String(length=255), nullable=False),
    sa.Column('descripcion', sa.Text(), nullable=True),
    sa.Column('cantidad', sa.Integer(), nullable=False),
    sa.Column('categoria', sa.String(length=100), nullable=True),
    sa.Column('subcategoria', sa.String(length=100), nullable=True),
    sa.Column('fecha_creacion', sa.DateTime(), nullable=False),
    sa.Column('caja_id', sa.Integer(), nullable=False),
    sa.Column('uuid', sa.String(length=36), nullable=False),
    sa.Column('notas', sa.Text(), nullable=True),
    sa.ForeignKeyConstraint(['caja_id'], ['cajas.id'], ondelete='CASCADE'),
    sa.PrimaryKeyConstraint('id'),
    sa.UniqueConstraint('uuid')
    )
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_table('productos')
    op.drop_table('survey_responses')
    op.drop_table('cajas')
    op.drop_table('tags')
    op.drop_table('pulzcards')
    op.drop_table('dashboard_items')
    op.drop_table('bodegas')
    op.drop_table('users')
    # ### end Alembic commands ###


----- Fin de migrations/versions/d06faea1c24e_initial_migration.py -----

